<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.4.226">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Freddie Heather">
<meta name="dcterms.date" content="2024-05-14">

<title>Consistency in species body size distributions across marine fishes</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="analysis_files/libs/clipboard/clipboard.min.js"></script>
<script src="analysis_files/libs/quarto-html/quarto.js"></script>
<script src="analysis_files/libs/quarto-html/popper.min.js"></script>
<script src="analysis_files/libs/quarto-html/tippy.umd.min.js"></script>
<script src="analysis_files/libs/quarto-html/anchor.min.js"></script>
<link href="analysis_files/libs/quarto-html/tippy.css" rel="stylesheet">
<link href="analysis_files/libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="analysis_files/libs/bootstrap/bootstrap.min.js"></script>
<link href="analysis_files/libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="analysis_files/libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">


</head>

<body class="fullcontent">

<div id="quarto-content" class="page-columns page-rows-contents page-layout-article">

<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<div class="quarto-title-block"><div><h1 class="title">Consistency in species body size distributions across marine fishes</h1><button type="button" class="btn code-tools-button dropdown-toggle" id="quarto-code-tools-menu" data-bs-toggle="dropdown" aria-expanded="false"><i class="bi"></i> Code</button><ul class="dropdown-menu dropdown-menu-end" aria-labelelledby="quarto-code-tools-menu"><li><a id="quarto-show-all-code" class="dropdown-item" href="javascript:void(0)" role="button">Show All Code</a></li><li><a id="quarto-hide-all-code" class="dropdown-item" href="javascript:void(0)" role="button">Hide All Code</a></li><li><hr class="dropdown-divider"></li><li><a id="quarto-view-source" class="dropdown-item" href="javascript:void(0)" role="button">View Source</a></li></ul></div></div>
<p class="subtitle lead">R script to reconstruct figures</p>
</div>



<div class="quarto-title-meta">

    <div>
    <div class="quarto-title-meta-heading">Author</div>
    <div class="quarto-title-meta-contents">
             <p>Freddie Heather </p>
          </div>
  </div>
    
    <div>
    <div class="quarto-title-meta-heading">Published</div>
    <div class="quarto-title-meta-contents">
      <p class="date">May 14, 2024</p>
    </div>
  </div>
  
    
  </div>
  

</header>

<section id="about" class="level2">
<h2 class="anchored" data-anchor-id="about">About</h2>
<p>The following code will reconstruct the figures from the manuscript: Heather <em>et al.</em> (Submitted) “Consistency in species body size distributions across marine fishes”.</p>
</section>
<section id="setup" class="level2">
<h2 class="anchored" data-anchor-id="setup">Setup</h2>
<p>Loading the required packages.</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(scales)</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(cowplot)</span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(patchwork)</span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggpubr)</span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(modelr)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>Loading the required data.</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a>read_data <span class="ot">&lt;-</span> <span class="cf">function</span>(str) <span class="fu">read_csv</span>(<span class="fu">paste0</span>(<span class="st">"fig_data/"</span>, str), <span class="at">show_col_types =</span> <span class="cn">FALSE</span>)</span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Data for main figures</span></span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a>fig1_data_fits   <span class="ot">&lt;-</span> <span class="fu">read_data</span>(<span class="st">"fig1_data_fits.csv"</span>)</span>
<span id="cb2-5"><a href="#cb2-5" aria-hidden="true" tabindex="-1"></a>fig1_data_main   <span class="ot">&lt;-</span> <span class="fu">read_data</span>(<span class="st">"fig1_data_main.csv"</span>)</span>
<span id="cb2-6"><a href="#cb2-6" aria-hidden="true" tabindex="-1"></a>fig2_data_pop    <span class="ot">&lt;-</span> <span class="fu">read_data</span>(<span class="st">"fig2_data_pop.csv"</span>)</span>
<span id="cb2-7"><a href="#cb2-7" aria-hidden="true" tabindex="-1"></a>fig2_data_spp    <span class="ot">&lt;-</span> <span class="fu">read_data</span>(<span class="st">"fig2_data_spp.csv"</span>)</span>
<span id="cb2-8"><a href="#cb2-8" aria-hidden="true" tabindex="-1"></a>fig3_data        <span class="ot">&lt;-</span> <span class="fu">read_data</span>(<span class="st">"fig3_data.csv"</span>)</span>
<span id="cb2-9"><a href="#cb2-9" aria-hidden="true" tabindex="-1"></a>fig3_data_ks     <span class="ot">&lt;-</span> <span class="fu">read_data</span>(<span class="st">"fig3_data_ks.csv"</span>)</span>
<span id="cb2-10"><a href="#cb2-10" aria-hidden="true" tabindex="-1"></a>fig4_data        <span class="ot">&lt;-</span> <span class="fu">read_data</span>(<span class="st">"fig4_data.csv"</span>)</span>
<span id="cb2-11"><a href="#cb2-11" aria-hidden="true" tabindex="-1"></a>fig4_data_sample <span class="ot">&lt;-</span> <span class="fu">read_data</span>(<span class="st">"fig4_data_sample.csv"</span>)</span>
<span id="cb2-12"><a href="#cb2-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-13"><a href="#cb2-13" aria-hidden="true" tabindex="-1"></a><span class="co"># Data for supplementary figures</span></span>
<span id="cb2-14"><a href="#cb2-14" aria-hidden="true" tabindex="-1"></a>ED_fig1_data <span class="ot">&lt;-</span> <span class="fu">read_data</span>(<span class="st">"ED_fig1_data.csv"</span>)</span>
<span id="cb2-15"><a href="#cb2-15" aria-hidden="true" tabindex="-1"></a>ED_fig2_data <span class="ot">&lt;-</span> <span class="fu">read_data</span>(<span class="st">"ED_fig2_data.csv"</span>)</span>
<span id="cb2-16"><a href="#cb2-16" aria-hidden="true" tabindex="-1"></a>ED_fig3_data <span class="ot">&lt;-</span> <span class="fu">read_data</span>(<span class="st">"ED_fig3_data.csv"</span>)</span>
<span id="cb2-17"><a href="#cb2-17" aria-hidden="true" tabindex="-1"></a>ED_fig5_data <span class="ot">&lt;-</span> <span class="fu">read_data</span>(<span class="st">"ED_fig5_data.csv"</span>)</span>
<span id="cb2-18"><a href="#cb2-18" aria-hidden="true" tabindex="-1"></a>ED_fig7_data <span class="ot">&lt;-</span> <span class="fu">read_data</span>(<span class="st">"ED_fig7_data.csv"</span>)</span>
<span id="cb2-19"><a href="#cb2-19" aria-hidden="true" tabindex="-1"></a>ED_fig8_data <span class="ot">&lt;-</span> <span class="fu">read_data</span>(<span class="st">"ED_fig8_data.csv"</span>)</span>
<span id="cb2-20"><a href="#cb2-20" aria-hidden="true" tabindex="-1"></a>ED_fig9_data <span class="ot">&lt;-</span> <span class="fu">read_data</span>(<span class="st">"ED_fig9_data.csv"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
<section id="main-figures" class="level1">
<h1>Main Figures</h1>
<section id="figure-1" class="level2">
<h2 class="anchored" data-anchor-id="figure-1">Figure 1</h2>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a>fig1a <span class="ot">&lt;-</span></span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a>  fig1_data_fits <span class="sc">%&gt;%</span> </span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">bind_rows</span>(<span class="fu">tibble</span>(<span class="at">col =</span> <span class="st">"dummy_var"</span>)) <span class="sc">%&gt;%</span> <span class="co"># needed for legend</span></span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> scaled_size, </span>
<span id="cb3-5"><a href="#cb3-5" aria-hidden="true" tabindex="-1"></a>             <span class="at">y =</span> scaled_n, </span>
<span id="cb3-6"><a href="#cb3-6" aria-hidden="true" tabindex="-1"></a>             <span class="at">group =</span> file)) <span class="sc">+</span></span>
<span id="cb3-7"><a href="#cb3-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">y =</span> scaled_n, </span>
<span id="cb3-8"><a href="#cb3-8" aria-hidden="true" tabindex="-1"></a>                <span class="at">group =</span> population, </span>
<span id="cb3-9"><a href="#cb3-9" aria-hidden="true" tabindex="-1"></a>                <span class="at">colour =</span> col),</span>
<span id="cb3-10"><a href="#cb3-10" aria-hidden="true" tabindex="-1"></a>            <span class="at">alpha =</span> <span class="fl">0.1</span>, </span>
<span id="cb3-11"><a href="#cb3-11" aria-hidden="true" tabindex="-1"></a>            <span class="at">data =</span> fig1_data_main <span class="sc">%&gt;%</span> </span>
<span id="cb3-12"><a href="#cb3-12" aria-hidden="true" tabindex="-1"></a>              <span class="fu">mutate</span>(<span class="at">col =</span> <span class="fu">case_when</span>(</span>
<span id="cb3-13"><a href="#cb3-13" aria-hidden="true" tabindex="-1"></a>                normal_better <span class="sc">~</span> <span class="fu">rgb</span>(<span class="dv">181</span>, <span class="dv">144</span>, <span class="dv">19</span>, </span>
<span id="cb3-14"><a href="#cb3-14" aria-hidden="true" tabindex="-1"></a>                                    <span class="at">maxColorValue=</span><span class="dv">255</span>), </span>
<span id="cb3-15"><a href="#cb3-15" aria-hidden="true" tabindex="-1"></a>                <span class="sc">!</span>normal_better <span class="sc">~</span> <span class="fu">rgb</span>(<span class="dv">29</span>, <span class="dv">84</span>, <span class="dv">128</span>, </span>
<span id="cb3-16"><a href="#cb3-16" aria-hidden="true" tabindex="-1"></a>                                     <span class="at">maxColorValue=</span><span class="dv">255</span>), </span>
<span id="cb3-17"><a href="#cb3-17" aria-hidden="true" tabindex="-1"></a>                <span class="cn">TRUE</span> <span class="sc">~</span> <span class="st">"grey80"</span>),</span>
<span id="cb3-18"><a href="#cb3-18" aria-hidden="true" tabindex="-1"></a>                <span class="at">lty =</span> <span class="fu">case_when</span>(normal_better <span class="sc">~</span> <span class="st">"solid"</span>, </span>
<span id="cb3-19"><a href="#cb3-19" aria-hidden="true" tabindex="-1"></a>                                <span class="sc">!</span>normal_better <span class="sc">~</span> <span class="st">"solid"</span>, </span>
<span id="cb3-20"><a href="#cb3-20" aria-hidden="true" tabindex="-1"></a>                                <span class="cn">TRUE</span> <span class="sc">~</span> <span class="st">"dashed"</span>),</span>
<span id="cb3-21"><a href="#cb3-21" aria-hidden="true" tabindex="-1"></a>                <span class="at">lwd =</span> <span class="fu">case_when</span>(normal_better <span class="sc">~</span> <span class="dv">2</span>, </span>
<span id="cb3-22"><a href="#cb3-22" aria-hidden="true" tabindex="-1"></a>                                <span class="sc">!</span>normal_better <span class="sc">~</span> <span class="dv">2</span>, </span>
<span id="cb3-23"><a href="#cb3-23" aria-hidden="true" tabindex="-1"></a>                                <span class="cn">TRUE</span> <span class="sc">~</span> <span class="fl">0.5</span>)) ) <span class="sc">+</span></span>
<span id="cb3-24"><a href="#cb3-24" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">col =</span> <span class="st">"black"</span>, <span class="at">lwd =</span> <span class="dv">3</span>, </span>
<span id="cb3-25"><a href="#cb3-25" aria-hidden="true" tabindex="-1"></a>            <span class="at">data =</span> fig1_data_fits <span class="sc">%&gt;%</span> </span>
<span id="cb3-26"><a href="#cb3-26" aria-hidden="true" tabindex="-1"></a>              <span class="fu">filter</span>(file <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">"normal"</span>, <span class="st">"lognormal"</span>))) <span class="sc">+</span></span>
<span id="cb3-27"><a href="#cb3-27" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">col =</span> col,</span>
<span id="cb3-28"><a href="#cb3-28" aria-hidden="true" tabindex="-1"></a>                <span class="at">lty =</span> lty,</span>
<span id="cb3-29"><a href="#cb3-29" aria-hidden="true" tabindex="-1"></a>                <span class="at">linewidth =</span> lwd)) <span class="sc">+</span></span>
<span id="cb3-30"><a href="#cb3-30" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">label =</span> <span class="fu">label_number</span>(<span class="at">suffix =</span> <span class="st">"x"</span>)) <span class="sc">+</span></span>
<span id="cb3-31"><a href="#cb3-31" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_identity</span>(<span class="at">labels =</span> <span class="fu">c</span>(</span>
<span id="cb3-32"><a href="#cb3-32" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Observed (Normal preferred)"</span>, </span>
<span id="cb3-33"><a href="#cb3-33" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Observed (Lognormal preferred)"</span>,</span>
<span id="cb3-34"><a href="#cb3-34" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Normal fit"</span>,</span>
<span id="cb3-35"><a href="#cb3-35" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Lognormal fit"</span>, </span>
<span id="cb3-36"><a href="#cb3-36" aria-hidden="true" tabindex="-1"></a>    <span class="st">"13 protist species"</span></span>
<span id="cb3-37"><a href="#cb3-37" aria-hidden="true" tabindex="-1"></a>  ), </span>
<span id="cb3-38"><a href="#cb3-38" aria-hidden="true" tabindex="-1"></a>  <span class="at">guide =</span> <span class="st">"legend"</span>) <span class="sc">+</span></span>
<span id="cb3-39"><a href="#cb3-39" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_linetype_identity</span>() <span class="sc">+</span></span>
<span id="cb3-40"><a href="#cb3-40" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_linewidth_identity</span>() <span class="sc">+</span></span>
<span id="cb3-41"><a href="#cb3-41" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_cowplot</span>(<span class="dv">20</span>) <span class="sc">+</span></span>
<span id="cb3-42"><a href="#cb3-42" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">1</span>), </span>
<span id="cb3-43"><a href="#cb3-43" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.justification =</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">1</span>),</span>
<span id="cb3-44"><a href="#cb3-44" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.title =</span> <span class="fu">element_blank</span>(), </span>
<span id="cb3-45"><a href="#cb3-45" aria-hidden="true" tabindex="-1"></a>        <span class="at">plot.margin =</span> <span class="fu">margin</span>(<span class="dv">10</span>, <span class="dv">20</span>, <span class="dv">10</span>, <span class="dv">10</span>)) <span class="sc">+</span></span>
<span id="cb3-46"><a href="#cb3-46" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb3-47"><a href="#cb3-47" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> <span class="st">"Body size relative to mean size"</span>,</span>
<span id="cb3-48"><a href="#cb3-48" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span> <span class="st">"Abundance relative to max"</span></span>
<span id="cb3-49"><a href="#cb3-49" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb3-50"><a href="#cb3-50" aria-hidden="true" tabindex="-1"></a>  <span class="fu">guides</span>(<span class="at">col =</span> <span class="fu">guide_legend</span>(</span>
<span id="cb3-51"><a href="#cb3-51" aria-hidden="true" tabindex="-1"></a>    <span class="at">override.aes =</span> <span class="fu">list</span>(<span class="at">lty =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">2</span>), </span>
<span id="cb3-52"><a href="#cb3-52" aria-hidden="true" tabindex="-1"></a>                        <span class="at">linewidth =</span> <span class="fu">c</span>(<span class="fl">0.3</span>, <span class="fl">0.3</span>, <span class="dv">3</span>, <span class="dv">3</span>, <span class="fl">0.5</span>), </span>
<span id="cb3-53"><a href="#cb3-53" aria-hidden="true" tabindex="-1"></a>                        <span class="at">colour =</span> <span class="fu">c</span>(<span class="fu">rgb</span>(<span class="dv">181</span>, <span class="dv">144</span>, <span class="dv">19</span>, <span class="at">maxColorValue=</span><span class="dv">255</span>),</span>
<span id="cb3-54"><a href="#cb3-54" aria-hidden="true" tabindex="-1"></a>                                   <span class="fu">rgb</span>(<span class="dv">29</span>, <span class="dv">84</span>, <span class="dv">128</span>, <span class="at">maxColorValue=</span><span class="dv">255</span>),</span>
<span id="cb3-55"><a href="#cb3-55" aria-hidden="true" tabindex="-1"></a>                                   <span class="fu">rgb</span>(<span class="dv">181</span>, <span class="dv">144</span>, <span class="dv">19</span>, <span class="at">maxColorValue=</span><span class="dv">255</span>),</span>
<span id="cb3-56"><a href="#cb3-56" aria-hidden="true" tabindex="-1"></a>                                   <span class="fu">rgb</span>(<span class="dv">29</span>, <span class="dv">84</span>, <span class="dv">128</span>, <span class="at">maxColorValue=</span><span class="dv">255</span>),</span>
<span id="cb3-57"><a href="#cb3-57" aria-hidden="true" tabindex="-1"></a>                                   <span class="st">"black"</span>), </span>
<span id="cb3-58"><a href="#cb3-58" aria-hidden="true" tabindex="-1"></a>                        <span class="at">alpha =</span> <span class="dv">1</span>), </span>
<span id="cb3-59"><a href="#cb3-59" aria-hidden="true" tabindex="-1"></a>    <span class="at">label.position =</span> <span class="st">"left"</span>))</span>
<span id="cb3-60"><a href="#cb3-60" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-61"><a href="#cb3-61" aria-hidden="true" tabindex="-1"></a><span class="co"># getting a random selection of species</span></span>
<span id="cb3-62"><a href="#cb3-62" aria-hidden="true" tabindex="-1"></a>out <span class="ot">&lt;-</span> <span class="fu">c</span>()</span>
<span id="cb3-63"><a href="#cb3-63" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">10</span>) {</span>
<span id="cb3-64"><a href="#cb3-64" aria-hidden="true" tabindex="-1"></a>  <span class="fu">set.seed</span>(<span class="dv">1</span>)</span>
<span id="cb3-65"><a href="#cb3-65" aria-hidden="true" tabindex="-1"></a>  out <span class="ot">&lt;-</span> <span class="fu">c</span>(out, <span class="fu">sample</span>(((<span class="dv">320</span><span class="sc">*</span>(i<span class="dv">-1</span>))<span class="sc">+</span><span class="dv">1</span>)<span class="sc">:</span>((<span class="dv">320</span><span class="sc">*</span>(i<span class="dv">-1</span>)<span class="sc">+</span><span class="dv">1</span>)<span class="sc">+</span><span class="dv">320</span>), <span class="dv">1</span>))</span>
<span id="cb3-66"><a href="#cb3-66" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb3-67"><a href="#cb3-67" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-68"><a href="#cb3-68" aria-hidden="true" tabindex="-1"></a>range_bodysizes <span class="ot">&lt;-</span> </span>
<span id="cb3-69"><a href="#cb3-69" aria-hidden="true" tabindex="-1"></a>  fig1_data_main <span class="sc">%&gt;%</span> </span>
<span id="cb3-70"><a href="#cb3-70" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(population <span class="sc">%in%</span> {fig1_data_main <span class="sc">%&gt;%</span> <span class="fu">filter</span>(model_fit) <span class="sc">%&gt;%</span> <span class="fu">pull</span>(population)}) <span class="sc">%&gt;%</span> </span>
<span id="cb3-71"><a href="#cb3-71" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(population, mean_size) <span class="sc">%&gt;%</span> </span>
<span id="cb3-72"><a href="#cb3-72" aria-hidden="true" tabindex="-1"></a>  <span class="fu">distinct</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb3-73"><a href="#cb3-73" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(mean_size) <span class="sc">%&gt;%</span> </span>
<span id="cb3-74"><a href="#cb3-74" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rownames_to_column</span>(<span class="st">"size_num"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb3-75"><a href="#cb3-75" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(size_num <span class="sc">%in%</span> out)</span>
<span id="cb3-76"><a href="#cb3-76" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-77"><a href="#cb3-77" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1</span>)</span>
<span id="cb3-78"><a href="#cb3-78" aria-hidden="true" tabindex="-1"></a>cbf_samples <span class="ot">&lt;-</span> </span>
<span id="cb3-79"><a href="#cb3-79" aria-hidden="true" tabindex="-1"></a>  fig1_data_main <span class="sc">%&gt;%</span> </span>
<span id="cb3-80"><a href="#cb3-80" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(population_n <span class="sc">&gt;</span> <span class="dv">100</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb3-81"><a href="#cb3-81" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(dat<span class="sc">==</span><span class="st">"cbf"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb3-82"><a href="#cb3-82" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(population, mean_size) <span class="sc">%&gt;%</span> </span>
<span id="cb3-83"><a href="#cb3-83" aria-hidden="true" tabindex="-1"></a>  <span class="fu">distinct</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb3-84"><a href="#cb3-84" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(mean_size) <span class="sc">%&gt;%</span> </span>
<span id="cb3-85"><a href="#cb3-85" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rownames_to_column</span>(<span class="st">"size_num"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb3-86"><a href="#cb3-86" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(size_num <span class="sc">%in%</span> <span class="fu">sample</span>(<span class="dv">1</span><span class="sc">:</span><span class="fu">nrow</span>(.), <span class="dv">2</span>))</span>
<span id="cb3-87"><a href="#cb3-87" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-88"><a href="#cb3-88" aria-hidden="true" tabindex="-1"></a>extra <span class="ot">&lt;-</span> </span>
<span id="cb3-89"><a href="#cb3-89" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tibble</span>(<span class="at">species =</span> <span class="fu">c</span>(range_bodysizes<span class="sc">$</span>population, </span>
<span id="cb3-90"><a href="#cb3-90" aria-hidden="true" tabindex="-1"></a>                     cbf_samples<span class="sc">$</span>population) <span class="sc">%&gt;%</span> </span>
<span id="cb3-91"><a href="#cb3-91" aria-hidden="true" tabindex="-1"></a>           <span class="fu">str_extract</span>(<span class="at">pattern =</span> <span class="st">".*(?=__)"</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb3-92"><a href="#cb3-92" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(species <span class="sc">%in%</span> {fig1_data_main <span class="sc">%&gt;%</span> <span class="fu">filter</span>(vector_icon) <span class="sc">%&gt;%</span> <span class="fu">pull</span>(species)})</span>
<span id="cb3-93"><a href="#cb3-93" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-94"><a href="#cb3-94" aria-hidden="true" tabindex="-1"></a>fig1b <span class="ot">&lt;-</span></span>
<span id="cb3-95"><a href="#cb3-95" aria-hidden="true" tabindex="-1"></a>  fig1_data_main <span class="sc">%&gt;%</span> </span>
<span id="cb3-96"><a href="#cb3-96" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(population <span class="sc">%in%</span> <span class="fu">c</span>(range_bodysizes<span class="sc">$</span>population, cbf_samples<span class="sc">$</span>population)) <span class="sc">%&gt;%</span></span>
<span id="cb3-97"><a href="#cb3-97" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">highlight_spp =</span> species <span class="sc">%in%</span> extra<span class="sc">$</span>species) <span class="sc">%&gt;%</span> </span>
<span id="cb3-98"><a href="#cb3-98" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>() <span class="sc">+</span></span>
<span id="cb3-99"><a href="#cb3-99" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">x =</span> scaled_size, </span>
<span id="cb3-100"><a href="#cb3-100" aria-hidden="true" tabindex="-1"></a>                <span class="at">y =</span> scaled_n,</span>
<span id="cb3-101"><a href="#cb3-101" aria-hidden="true" tabindex="-1"></a>                <span class="at">col =</span> dat,</span>
<span id="cb3-102"><a href="#cb3-102" aria-hidden="true" tabindex="-1"></a>                <span class="at">group =</span> population),</span>
<span id="cb3-103"><a href="#cb3-103" aria-hidden="true" tabindex="-1"></a>            <span class="at">alpha =</span> <span class="fl">0.5</span>, </span>
<span id="cb3-104"><a href="#cb3-104" aria-hidden="true" tabindex="-1"></a>            <span class="at">linewidth =</span> <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb3-105"><a href="#cb3-105" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">x =</span> scaled_size,</span>
<span id="cb3-106"><a href="#cb3-106" aria-hidden="true" tabindex="-1"></a>                <span class="at">y =</span> scaled_n,</span>
<span id="cb3-107"><a href="#cb3-107" aria-hidden="true" tabindex="-1"></a>                <span class="at">col =</span> dat,</span>
<span id="cb3-108"><a href="#cb3-108" aria-hidden="true" tabindex="-1"></a>                <span class="at">group =</span> population),</span>
<span id="cb3-109"><a href="#cb3-109" aria-hidden="true" tabindex="-1"></a>            <span class="at">data =</span> . <span class="sc">%&gt;%</span> <span class="fu">filter</span>(highlight_spp),</span>
<span id="cb3-110"><a href="#cb3-110" aria-hidden="true" tabindex="-1"></a>            <span class="at">linewidth =</span> <span class="fl">1.5</span>) <span class="sc">+</span></span>
<span id="cb3-111"><a href="#cb3-111" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">label =</span> <span class="fu">label_number</span>(<span class="at">suffix =</span> <span class="st">"x"</span>)) <span class="sc">+</span></span>
<span id="cb3-112"><a href="#cb3-112" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">"rls"</span> <span class="ot">=</span> <span class="st">"#56B4E9"</span>,</span>
<span id="cb3-113"><a href="#cb3-113" aria-hidden="true" tabindex="-1"></a>                                <span class="st">"cbf"</span> <span class="ot">=</span> <span class="st">"#E69F00"</span>),</span>
<span id="cb3-114"><a href="#cb3-114" aria-hidden="true" tabindex="-1"></a>                     <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"rls"</span> <span class="ot">=</span> <span class="st">"Visual census"</span>,</span>
<span id="cb3-115"><a href="#cb3-115" aria-hidden="true" tabindex="-1"></a>                                <span class="st">"cbf"</span> <span class="ot">=</span> <span class="st">"Cryptobenthic specimen collection"</span>)) <span class="sc">+</span></span>
<span id="cb3-116"><a href="#cb3-116" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_cowplot</span>(<span class="dv">20</span>) <span class="sc">+</span></span>
<span id="cb3-117"><a href="#cb3-117" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">1</span>), </span>
<span id="cb3-118"><a href="#cb3-118" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.justification =</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">1</span>),</span>
<span id="cb3-119"><a href="#cb3-119" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.title =</span> <span class="fu">element_blank</span>()) <span class="sc">+</span></span>
<span id="cb3-120"><a href="#cb3-120" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb3-121"><a href="#cb3-121" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> <span class="st">"Body size relative to mean size"</span>,</span>
<span id="cb3-122"><a href="#cb3-122" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span> <span class="st">"Abundance relative to max"</span></span>
<span id="cb3-123"><a href="#cb3-123" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb3-124"><a href="#cb3-124" aria-hidden="true" tabindex="-1"></a>  <span class="fu">guides</span>(<span class="at">col =</span> <span class="fu">guide_legend</span>(<span class="at">label.position =</span> <span class="st">"left"</span>))</span>
<span id="cb3-125"><a href="#cb3-125" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-126"><a href="#cb3-126" aria-hidden="true" tabindex="-1"></a>fig1 <span class="ot">&lt;-</span> </span>
<span id="cb3-127"><a href="#cb3-127" aria-hidden="true" tabindex="-1"></a>  fig1a <span class="sc">+</span> </span>
<span id="cb3-128"><a href="#cb3-128" aria-hidden="true" tabindex="-1"></a>  fig1b <span class="sc">+</span> </span>
<span id="cb3-129"><a href="#cb3-129" aria-hidden="true" tabindex="-1"></a>  <span class="fu">plot_layout</span>(<span class="at">ncol =</span> <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb3-130"><a href="#cb3-130" aria-hidden="true" tabindex="-1"></a>  <span class="fu">plot_annotation</span>(<span class="at">tag_levels =</span> <span class="st">'A'</span>)</span>
<span id="cb3-131"><a href="#cb3-131" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-132"><a href="#cb3-132" aria-hidden="true" tabindex="-1"></a><span class="fu">ggsave</span>(<span class="at">filename =</span> <span class="st">"ms_figs/scaling_distributions.png"</span>,</span>
<span id="cb3-133"><a href="#cb3-133" aria-hidden="true" tabindex="-1"></a>       <span class="at">plot =</span> fig1,</span>
<span id="cb3-134"><a href="#cb3-134" aria-hidden="true" tabindex="-1"></a>       <span class="at">height =</span> <span class="dv">25</span>,</span>
<span id="cb3-135"><a href="#cb3-135" aria-hidden="true" tabindex="-1"></a>       <span class="at">width =</span> <span class="dv">30</span>,</span>
<span id="cb3-136"><a href="#cb3-136" aria-hidden="true" tabindex="-1"></a>       <span class="at">units =</span> <span class="st">"cm"</span>, </span>
<span id="cb3-137"><a href="#cb3-137" aria-hidden="true" tabindex="-1"></a>       <span class="at">create.dir =</span> <span class="cn">TRUE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="ms_figs/scaling_distributions.png" class="img-fluid figure-img"></p>
<figcaption class="figure-caption">Observed body length distributions across 3,228 fish populations show a similar unimodal shape. A) Observed individual body length distributions shown in thin solid lines with the median parameter estimates from normal-preferred and lognormal-preferred model fits shown as thick yellow and dark blue lines, respectively. Dashed lines in (A) show scaled body size (cell diameter) distributions of 13 freshwater protist species extracted from Giometto et al.&nbsp;(2013). B) A random selection of 12 populations for visualisation purposes; three species have been highlighted (thicker lines) to indicate that each line represents a population-level body length distribution. Binned body length data were normalized to the bin width to allow comparison with continuous body length data. Abundance density (y-axis) is scaled to the maximum abundance density of the population, and body size (x-axis) is scaled to the mean body size of the population. The estimated CV values for fish length were consistent across three different spatial scales: population-level (Fig. 2), metapopulation or ecoregion-level20 (Extended Data Fig. 3), and the entire species-level (Fig. 2). The results were also similar when species that may be targeted by recreational or commercial fisheries (12% of total, n = 97 species) were removed from the analysis (Extended Data Fig. 4). Naturally, over short temporal and fine spatial scales, local recruitment and mortality events might increase the variability of size distributions and produce multimodal size frequencies, such as sometimes seen in fisheries samples, especially from highly seasonal species21,22. Multi-modality is likely to be rarer when body size data encompasses multiple sampling events and when seasonality is weaker, as is the case for our data. Only about 2% of coral reef and temperate rocky reef populations in our dataset revealed multiple peaks in body length frequencies (Extended Data Figs. 5).</figcaption>
</figure>
</div>
</section>
</section>
<section id="figure-2" class="level1">
<h1>Figure 2</h1>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a>inc_bimodal <span class="ot">&lt;-</span> <span class="cn">FALSE</span></span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a>inc_fished <span class="ot">&lt;-</span> <span class="cn">TRUE</span></span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-4"><a href="#cb4-4" aria-hidden="true" tabindex="-1"></a>main_plot <span class="ot">&lt;-</span> <span class="cf">function</span>(.data) {</span>
<span id="cb4-5"><a href="#cb4-5" aria-hidden="true" tabindex="-1"></a>  .data <span class="sc">%&gt;%</span> </span>
<span id="cb4-6"><a href="#cb4-6" aria-hidden="true" tabindex="-1"></a>    <span class="fu">ggplot</span>() <span class="sc">+</span> </span>
<span id="cb4-7"><a href="#cb4-7" aria-hidden="true" tabindex="-1"></a>    <span class="fu">aes</span>(</span>
<span id="cb4-8"><a href="#cb4-8" aria-hidden="true" tabindex="-1"></a>      <span class="at">x =</span> mean_size, </span>
<span id="cb4-9"><a href="#cb4-9" aria-hidden="true" tabindex="-1"></a>      <span class="at">y =</span> cov_pref, </span>
<span id="cb4-10"><a href="#cb4-10" aria-hidden="true" tabindex="-1"></a>      <span class="at">pch =</span> col</span>
<span id="cb4-11"><a href="#cb4-11" aria-hidden="true" tabindex="-1"></a>    ) <span class="sc">+</span></span>
<span id="cb4-12"><a href="#cb4-12" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> <span class="fl">0.30</span>, <span class="at">lty =</span> <span class="dv">2</span>, <span class="at">col =</span> <span class="st">"black"</span>, <span class="at">alpha =</span> <span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb4-13"><a href="#cb4-13" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> <span class="fl">0.34</span>, <span class="at">lty =</span> <span class="dv">1</span>, <span class="at">col =</span> <span class="st">"#56B4E9"</span>, <span class="at">alpha =</span> <span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb4-14"><a href="#cb4-14" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> <span class="fl">0.37</span>, <span class="at">lty =</span> <span class="dv">1</span>, <span class="at">col =</span> <span class="st">"#CC79A7"</span>, <span class="at">alpha =</span> <span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb4-15"><a href="#cb4-15" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> <span class="fl">0.23</span>, <span class="at">lty =</span> <span class="dv">1</span>, <span class="at">col =</span> <span class="st">"#E69F00"</span>, <span class="at">alpha =</span> <span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb4-16"><a href="#cb4-16" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> <span class="fl">0.33</span>, <span class="at">lty =</span> <span class="dv">1</span>, <span class="at">col =</span> <span class="st">"#000000"</span>, <span class="at">alpha =</span> <span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb4-17"><a href="#cb4-17" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_point</span>(<span class="at">alpha =</span> <span class="dv">1</span>, </span>
<span id="cb4-18"><a href="#cb4-18" aria-hidden="true" tabindex="-1"></a>               <span class="fu">aes</span>(<span class="at">col =</span> col, </span>
<span id="cb4-19"><a href="#cb4-19" aria-hidden="true" tabindex="-1"></a>                   <span class="at">size =</span> (population_n <span class="sc">%&gt;%</span> <span class="fu">log10</span>()))) <span class="sc">+</span></span>
<span id="cb4-20"><a href="#cb4-20" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_point</span>(<span class="at">col =</span> <span class="st">"red"</span>,</span>
<span id="cb4-21"><a href="#cb4-21" aria-hidden="true" tabindex="-1"></a>               <span class="at">pch =</span> <span class="dv">4</span>, </span>
<span id="cb4-22"><a href="#cb4-22" aria-hidden="true" tabindex="-1"></a>               <span class="at">size =</span> <span class="dv">2</span>,</span>
<span id="cb4-23"><a href="#cb4-23" aria-hidden="true" tabindex="-1"></a>               <span class="at">data =</span> .data <span class="sc">%&gt;%</span> <span class="fu">filter</span>(bimodal)) <span class="sc">+</span></span>
<span id="cb4-24"><a href="#cb4-24" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_size_continuous</span>(<span class="at">range =</span> <span class="fu">c</span>(<span class="fl">0.1</span>,<span class="dv">5</span>),</span>
<span id="cb4-25"><a href="#cb4-25" aria-hidden="true" tabindex="-1"></a>                          <span class="at">breaks =</span> <span class="fu">c</span>(<span class="dv">2</span>,<span class="dv">3</span>,<span class="dv">5</span>),</span>
<span id="cb4-26"><a href="#cb4-26" aria-hidden="true" tabindex="-1"></a>                          <span class="at">labels =</span>  <span class="fu">c</span>(<span class="st">"100"</span>, <span class="st">"1K"</span>, <span class="st">"100K"</span>),</span>
<span id="cb4-27"><a href="#cb4-27" aria-hidden="true" tabindex="-1"></a>                          <span class="at">transform =</span> <span class="st">"log10"</span>, </span>
<span id="cb4-28"><a href="#cb4-28" aria-hidden="true" tabindex="-1"></a>                          <span class="at">name =</span> <span class="st">"Sample size"</span>) <span class="sc">+</span> </span>
<span id="cb4-29"><a href="#cb4-29" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_x_continuous</span>(<span class="at">transform =</span> <span class="st">"log10"</span>, </span>
<span id="cb4-30"><a href="#cb4-30" aria-hidden="true" tabindex="-1"></a>                       <span class="at">labels =</span> <span class="fu">label_number</span>(<span class="at">suffix=</span><span class="st">"cm"</span>), </span>
<span id="cb4-31"><a href="#cb4-31" aria-hidden="true" tabindex="-1"></a>                       <span class="at">limits =</span> <span class="fu">range</span>(.data<span class="sc">$</span>mean_size)) <span class="sc">+</span></span>
<span id="cb4-32"><a href="#cb4-32" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_shape_manual</span>(</span>
<span id="cb4-33"><a href="#cb4-33" aria-hidden="true" tabindex="-1"></a>      <span class="at">values =</span> <span class="fu">c</span>(</span>
<span id="cb4-34"><a href="#cb4-34" aria-hidden="true" tabindex="-1"></a>        <span class="st">"rls_norm"</span> <span class="ot">=</span> <span class="dv">21</span>, </span>
<span id="cb4-35"><a href="#cb4-35" aria-hidden="true" tabindex="-1"></a>        <span class="st">"rls_lnorm"</span> <span class="ot">=</span> <span class="dv">21</span>, </span>
<span id="cb4-36"><a href="#cb4-36" aria-hidden="true" tabindex="-1"></a>        <span class="st">"cbf_norm"</span> <span class="ot">=</span> <span class="dv">24</span>, </span>
<span id="cb4-37"><a href="#cb4-37" aria-hidden="true" tabindex="-1"></a>        <span class="st">"cbf_lnorm"</span> <span class="ot">=</span> <span class="dv">24</span>),</span>
<span id="cb4-38"><a href="#cb4-38" aria-hidden="true" tabindex="-1"></a>      <span class="at">label =</span> <span class="fu">c</span>(</span>
<span id="cb4-39"><a href="#cb4-39" aria-hidden="true" tabindex="-1"></a>        <span class="st">"rls_norm"</span> <span class="ot">=</span> <span class="st">"Visual census (normal preferred)"</span>, </span>
<span id="cb4-40"><a href="#cb4-40" aria-hidden="true" tabindex="-1"></a>        <span class="st">"rls_lnorm"</span> <span class="ot">=</span> <span class="st">"Visual census (lognormal preferred)"</span>, </span>
<span id="cb4-41"><a href="#cb4-41" aria-hidden="true" tabindex="-1"></a>        <span class="st">"cbf_norm"</span> <span class="ot">=</span> <span class="st">"Cryptobenthic (normal preferred)"</span>, </span>
<span id="cb4-42"><a href="#cb4-42" aria-hidden="true" tabindex="-1"></a>        <span class="st">"cbf_lnorm"</span> <span class="ot">=</span> <span class="st">"Cryptobenthic (lognormal preferred)"</span>)) <span class="sc">+</span></span>
<span id="cb4-43"><a href="#cb4-43" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_color_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(</span>
<span id="cb4-44"><a href="#cb4-44" aria-hidden="true" tabindex="-1"></a>      <span class="st">"rls_norm"</span> <span class="ot">=</span> <span class="st">"#56B4E9"</span>, </span>
<span id="cb4-45"><a href="#cb4-45" aria-hidden="true" tabindex="-1"></a>      <span class="st">"rls_lnorm"</span> <span class="ot">=</span> <span class="st">"#CC79A7"</span>, </span>
<span id="cb4-46"><a href="#cb4-46" aria-hidden="true" tabindex="-1"></a>      <span class="st">"cbf_norm"</span> <span class="ot">=</span> <span class="st">"#E69F00"</span>, </span>
<span id="cb4-47"><a href="#cb4-47" aria-hidden="true" tabindex="-1"></a>      <span class="st">"cbf_lnorm"</span> <span class="ot">=</span> <span class="st">"#000000"</span>),</span>
<span id="cb4-48"><a href="#cb4-48" aria-hidden="true" tabindex="-1"></a>      <span class="at">label =</span> <span class="fu">c</span>(</span>
<span id="cb4-49"><a href="#cb4-49" aria-hidden="true" tabindex="-1"></a>        <span class="st">"rls_norm"</span> <span class="ot">=</span> <span class="st">"Visual census (normal preferred)"</span>, </span>
<span id="cb4-50"><a href="#cb4-50" aria-hidden="true" tabindex="-1"></a>        <span class="st">"rls_lnorm"</span> <span class="ot">=</span> <span class="st">"Visual census (lognormal preferred)"</span>, </span>
<span id="cb4-51"><a href="#cb4-51" aria-hidden="true" tabindex="-1"></a>        <span class="st">"cbf_norm"</span> <span class="ot">=</span> <span class="st">"Cryptobenthic (normal preferred)"</span>, </span>
<span id="cb4-52"><a href="#cb4-52" aria-hidden="true" tabindex="-1"></a>        <span class="st">"cbf_lnorm"</span> <span class="ot">=</span> <span class="st">"Cryptobenthic (lognormal preferred)"</span>)) <span class="sc">+</span></span>
<span id="cb4-53"><a href="#cb4-53" aria-hidden="true" tabindex="-1"></a>    <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"Mean body length (log)"</span>, </span>
<span id="cb4-54"><a href="#cb4-54" aria-hidden="true" tabindex="-1"></a>         <span class="at">y =</span> <span class="st">"Coefficient of variation in body size"</span>) <span class="sc">+</span></span>
<span id="cb4-55"><a href="#cb4-55" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb4-56"><a href="#cb4-56" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme_cowplot</span>(<span class="dv">20</span>) <span class="sc">+</span></span>
<span id="cb4-57"><a href="#cb4-57" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"none"</span>, </span>
<span id="cb4-58"><a href="#cb4-58" aria-hidden="true" tabindex="-1"></a>          <span class="at">axis.title.y =</span> <span class="fu">element_blank</span>()</span>
<span id="cb4-59"><a href="#cb4-59" aria-hidden="true" tabindex="-1"></a>    ) </span>
<span id="cb4-60"><a href="#cb4-60" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb4-61"><a href="#cb4-61" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-62"><a href="#cb4-62" aria-hidden="true" tabindex="-1"></a>side_plot <span class="ot">&lt;-</span> <span class="cf">function</span>(.data, ylim){</span>
<span id="cb4-63"><a href="#cb4-63" aria-hidden="true" tabindex="-1"></a>  .data <span class="sc">%&gt;%</span> </span>
<span id="cb4-64"><a href="#cb4-64" aria-hidden="true" tabindex="-1"></a>    <span class="fu">ggplot</span>() <span class="sc">+</span></span>
<span id="cb4-65"><a href="#cb4-65" aria-hidden="true" tabindex="-1"></a>    <span class="fu">aes</span>(</span>
<span id="cb4-66"><a href="#cb4-66" aria-hidden="true" tabindex="-1"></a>      <span class="at">x =</span> cov_pref,</span>
<span id="cb4-67"><a href="#cb4-67" aria-hidden="true" tabindex="-1"></a>      <span class="at">fill =</span> col,</span>
<span id="cb4-68"><a href="#cb4-68" aria-hidden="true" tabindex="-1"></a>    ) <span class="sc">+</span></span>
<span id="cb4-69"><a href="#cb4-69" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_fill_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(</span>
<span id="cb4-70"><a href="#cb4-70" aria-hidden="true" tabindex="-1"></a>      <span class="st">"rls_norm"</span> <span class="ot">=</span> <span class="st">"#56B4E9"</span>, </span>
<span id="cb4-71"><a href="#cb4-71" aria-hidden="true" tabindex="-1"></a>      <span class="st">"rls_lnorm"</span> <span class="ot">=</span> <span class="st">"#CC79A7"</span>, </span>
<span id="cb4-72"><a href="#cb4-72" aria-hidden="true" tabindex="-1"></a>      <span class="st">"cbf_norm"</span> <span class="ot">=</span> <span class="st">"#E69F00"</span>, </span>
<span id="cb4-73"><a href="#cb4-73" aria-hidden="true" tabindex="-1"></a>      <span class="st">"cbf_lnorm"</span> <span class="ot">=</span> <span class="st">"#000000"</span>),</span>
<span id="cb4-74"><a href="#cb4-74" aria-hidden="true" tabindex="-1"></a>      <span class="at">label =</span> <span class="fu">c</span>(</span>
<span id="cb4-75"><a href="#cb4-75" aria-hidden="true" tabindex="-1"></a>        <span class="st">"rls_norm"</span> <span class="ot">=</span> <span class="st">"Visual census (normal preferred)"</span>, </span>
<span id="cb4-76"><a href="#cb4-76" aria-hidden="true" tabindex="-1"></a>        <span class="st">"rls_lnorm"</span> <span class="ot">=</span> <span class="st">"Visual census (lognormal preferred)"</span>, </span>
<span id="cb4-77"><a href="#cb4-77" aria-hidden="true" tabindex="-1"></a>        <span class="st">"cbf_norm"</span> <span class="ot">=</span> <span class="st">"Cryptobenthic (normal preferred)"</span>, </span>
<span id="cb4-78"><a href="#cb4-78" aria-hidden="true" tabindex="-1"></a>        <span class="st">"cbf_lnorm"</span> <span class="ot">=</span> <span class="st">"Cryptobenthic (lognormal preferred)"</span>))<span class="sc">+</span></span>
<span id="cb4-79"><a href="#cb4-79" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_density</span>(<span class="at">alpha =</span> <span class="fl">0.3</span>, <span class="at">col =</span> <span class="st">"black"</span>) <span class="sc">+</span></span>
<span id="cb4-80"><a href="#cb4-80" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_x_continuous</span>(<span class="at">position =</span> <span class="st">"top"</span>, </span>
<span id="cb4-81"><a href="#cb4-81" aria-hidden="true" tabindex="-1"></a>                       <span class="at">limits =</span> <span class="fu">c</span>(<span class="dv">0</span>, ylim)) <span class="sc">+</span></span>
<span id="cb4-82"><a href="#cb4-82" aria-hidden="true" tabindex="-1"></a>    <span class="fu">coord_flip</span>() <span class="sc">+</span></span>
<span id="cb4-83"><a href="#cb4-83" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"none"</span>, </span>
<span id="cb4-84"><a href="#cb4-84" aria-hidden="true" tabindex="-1"></a>          <span class="at">plot.background =</span> <span class="fu">element_rect</span>(<span class="at">fill =</span> <span class="st">"white"</span>),</span>
<span id="cb4-85"><a href="#cb4-85" aria-hidden="true" tabindex="-1"></a>          <span class="at">panel.background =</span> <span class="fu">element_rect</span>(<span class="at">fill =</span> <span class="st">"white"</span>),</span>
<span id="cb4-86"><a href="#cb4-86" aria-hidden="true" tabindex="-1"></a>          <span class="at">axis.line.x =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb4-87"><a href="#cb4-87" aria-hidden="true" tabindex="-1"></a>          <span class="at">axis.text.x =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb4-88"><a href="#cb4-88" aria-hidden="true" tabindex="-1"></a>          <span class="at">axis.title.x =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb4-89"><a href="#cb4-89" aria-hidden="true" tabindex="-1"></a>          <span class="at">axis.ticks.x =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb4-90"><a href="#cb4-90" aria-hidden="true" tabindex="-1"></a>          <span class="at">axis.line.y =</span> <span class="fu">element_line</span>(), </span>
<span id="cb4-91"><a href="#cb4-91" aria-hidden="true" tabindex="-1"></a>          <span class="at">axis.title.y =</span> <span class="fu">element_blank</span>(), </span>
<span id="cb4-92"><a href="#cb4-92" aria-hidden="true" tabindex="-1"></a>          <span class="at">axis.text.y =</span> <span class="fu">element_text</span>(<span class="at">margin =</span> <span class="fu">margin</span>(<span class="at">t =</span> <span class="dv">0</span>, </span>
<span id="cb4-93"><a href="#cb4-93" aria-hidden="true" tabindex="-1"></a>                                                     <span class="at">r =</span> <span class="dv">0</span>, </span>
<span id="cb4-94"><a href="#cb4-94" aria-hidden="true" tabindex="-1"></a>                                                     <span class="at">b =</span> <span class="dv">0</span>, </span>
<span id="cb4-95"><a href="#cb4-95" aria-hidden="true" tabindex="-1"></a>                                                     <span class="at">l =</span> <span class="dv">10</span>), </span>
<span id="cb4-96"><a href="#cb4-96" aria-hidden="true" tabindex="-1"></a>                                     <span class="at">size =</span> <span class="dv">15</span>), </span>
<span id="cb4-97"><a href="#cb4-97" aria-hidden="true" tabindex="-1"></a>          <span class="at">axis.ticks =</span> <span class="fu">element_line</span>(<span class="at">linewidth =</span> <span class="dv">1</span>, <span class="at">colour =</span> <span class="st">"black"</span>))</span>
<span id="cb4-98"><a href="#cb4-98" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb4-99"><a href="#cb4-99" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-100"><a href="#cb4-100" aria-hidden="true" tabindex="-1"></a>pop_data <span class="ot">&lt;-</span> </span>
<span id="cb4-101"><a href="#cb4-101" aria-hidden="true" tabindex="-1"></a>  fig2_data_pop <span class="sc">%&gt;%</span></span>
<span id="cb4-102"><a href="#cb4-102" aria-hidden="true" tabindex="-1"></a>  {<span class="cf">if</span>(inc_fished) . <span class="cf">else</span> <span class="fu">filter</span>(., <span class="sc">!</span>fished)} <span class="sc">%&gt;%</span> </span>
<span id="cb4-103"><a href="#cb4-103" aria-hidden="true" tabindex="-1"></a>  {<span class="cf">if</span>(inc_bimodal) . <span class="cf">else</span> <span class="fu">filter</span>(., <span class="sc">!</span>bimodal)} </span>
<span id="cb4-104"><a href="#cb4-104" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-105"><a href="#cb4-105" aria-hidden="true" tabindex="-1"></a>spp_data <span class="ot">&lt;-</span> </span>
<span id="cb4-106"><a href="#cb4-106" aria-hidden="true" tabindex="-1"></a>  fig2_data_spp <span class="sc">%&gt;%</span> </span>
<span id="cb4-107"><a href="#cb4-107" aria-hidden="true" tabindex="-1"></a>  {<span class="cf">if</span>(inc_fished) . <span class="cf">else</span> <span class="fu">filter</span>(., <span class="sc">!</span>fished)} <span class="sc">%&gt;%</span> </span>
<span id="cb4-108"><a href="#cb4-108" aria-hidden="true" tabindex="-1"></a>  {<span class="cf">if</span>(inc_bimodal) . <span class="cf">else</span> <span class="fu">filter</span>(., <span class="sc">!</span>bimodal)}</span>
<span id="cb4-109"><a href="#cb4-109" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-110"><a href="#cb4-110" aria-hidden="true" tabindex="-1"></a>plot_ylim <span class="ot">&lt;-</span> </span>
<span id="cb4-111"><a href="#cb4-111" aria-hidden="true" tabindex="-1"></a>  <span class="fu">max</span>(<span class="fu">layer_scales</span>(</span>
<span id="cb4-112"><a href="#cb4-112" aria-hidden="true" tabindex="-1"></a>    <span class="fu">main_plot</span>(pop_data))<span class="sc">$</span>y<span class="sc">$</span>range<span class="sc">$</span>range,</span>
<span id="cb4-113"><a href="#cb4-113" aria-hidden="true" tabindex="-1"></a>    <span class="fu">layer_scales</span>(</span>
<span id="cb4-114"><a href="#cb4-114" aria-hidden="true" tabindex="-1"></a>      <span class="fu">main_plot</span>(spp_data))<span class="sc">$</span>y<span class="sc">$</span>range<span class="sc">$</span>range)</span>
<span id="cb4-115"><a href="#cb4-115" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-116"><a href="#cb4-116" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-117"><a href="#cb4-117" aria-hidden="true" tabindex="-1"></a>fig2_main <span class="ot">&lt;-</span> </span>
<span id="cb4-118"><a href="#cb4-118" aria-hidden="true" tabindex="-1"></a>  <span class="fu">main_plot</span>(pop_data) <span class="sc">+</span> </span>
<span id="cb4-119"><a href="#cb4-119" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.title.x =</span> <span class="fu">element_blank</span>()) <span class="sc">+</span></span>
<span id="cb4-120"><a href="#cb4-120" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylim</span>(<span class="dv">0</span>, plot_ylim) <span class="sc">+</span></span>
<span id="cb4-121"><a href="#cb4-121" aria-hidden="true" tabindex="-1"></a>  <span class="fu">annotate</span>(<span class="st">"text"</span>,</span>
<span id="cb4-122"><a href="#cb4-122" aria-hidden="true" tabindex="-1"></a>           <span class="at">x =</span> <span class="dv">1</span>, </span>
<span id="cb4-123"><a href="#cb4-123" aria-hidden="true" tabindex="-1"></a>           <span class="at">hjust =</span> <span class="dv">0</span>, </span>
<span id="cb4-124"><a href="#cb4-124" aria-hidden="true" tabindex="-1"></a>           <span class="at">y =</span> plot_ylim<span class="sc">*</span><span class="fl">0.95</span>,</span>
<span id="cb4-125"><a href="#cb4-125" aria-hidden="true" tabindex="-1"></a>           <span class="at">label =</span> <span class="st">"Population-level"</span>,</span>
<span id="cb4-126"><a href="#cb4-126" aria-hidden="true" tabindex="-1"></a>           <span class="at">size =</span> <span class="dv">10</span>) <span class="sc">+</span></span>
<span id="cb4-127"><a href="#cb4-127" aria-hidden="true" tabindex="-1"></a>  <span class="fu">side_plot</span>(pop_data <span class="sc">%&gt;%</span> </span>
<span id="cb4-128"><a href="#cb4-128" aria-hidden="true" tabindex="-1"></a>              <span class="fu">filter</span>(col <span class="sc">!=</span> <span class="st">"cbf_lnorm"</span>), </span>
<span id="cb4-129"><a href="#cb4-129" aria-hidden="true" tabindex="-1"></a>            plot_ylim) <span class="sc">+</span> </span>
<span id="cb4-130"><a href="#cb4-130" aria-hidden="true" tabindex="-1"></a>  <span class="fu">main_plot</span>(spp_data) <span class="sc">+</span> <span class="fu">ylim</span>(<span class="dv">0</span>, plot_ylim) <span class="sc">+</span></span>
<span id="cb4-131"><a href="#cb4-131" aria-hidden="true" tabindex="-1"></a>  <span class="fu">annotate</span>(<span class="st">"text"</span>, </span>
<span id="cb4-132"><a href="#cb4-132" aria-hidden="true" tabindex="-1"></a>           <span class="at">x =</span> <span class="dv">1</span>, </span>
<span id="cb4-133"><a href="#cb4-133" aria-hidden="true" tabindex="-1"></a>           <span class="at">hjust =</span> <span class="dv">0</span>, </span>
<span id="cb4-134"><a href="#cb4-134" aria-hidden="true" tabindex="-1"></a>           <span class="at">y =</span> plot_ylim<span class="sc">*</span><span class="fl">0.95</span>,</span>
<span id="cb4-135"><a href="#cb4-135" aria-hidden="true" tabindex="-1"></a>           <span class="at">label =</span> <span class="st">"Species-level"</span>,</span>
<span id="cb4-136"><a href="#cb4-136" aria-hidden="true" tabindex="-1"></a>           <span class="at">size =</span> <span class="dv">10</span>) <span class="sc">+</span></span>
<span id="cb4-137"><a href="#cb4-137" aria-hidden="true" tabindex="-1"></a>  <span class="fu">side_plot</span>(spp_data <span class="sc">%&gt;%</span> <span class="fu">filter</span>(col <span class="sc">!=</span> <span class="st">"cbf_lnorm"</span>), </span>
<span id="cb4-138"><a href="#cb4-138" aria-hidden="true" tabindex="-1"></a>            plot_ylim)  <span class="sc">+</span></span>
<span id="cb4-139"><a href="#cb4-139" aria-hidden="true" tabindex="-1"></a>  <span class="fu">plot_layout</span>(<span class="at">design =</span> {<span class="st">"</span></span>
<span id="cb4-140"><a href="#cb4-140" aria-hidden="true" tabindex="-1"></a><span class="st">      AAAAAAB</span></span>
<span id="cb4-141"><a href="#cb4-141" aria-hidden="true" tabindex="-1"></a><span class="st">      AAAAAAB</span></span>
<span id="cb4-142"><a href="#cb4-142" aria-hidden="true" tabindex="-1"></a><span class="st">      CCCCCCD</span></span>
<span id="cb4-143"><a href="#cb4-143" aria-hidden="true" tabindex="-1"></a><span class="st">      CCCCCCD"</span></span>
<span id="cb4-144"><a href="#cb4-144" aria-hidden="true" tabindex="-1"></a>  })</span>
<span id="cb4-145"><a href="#cb4-145" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-146"><a href="#cb4-146" aria-hidden="true" tabindex="-1"></a>fig2_legend <span class="ot">&lt;-</span></span>
<span id="cb4-147"><a href="#cb4-147" aria-hidden="true" tabindex="-1"></a>  ggpubr<span class="sc">::</span><span class="fu">as_ggplot</span>(</span>
<span id="cb4-148"><a href="#cb4-148" aria-hidden="true" tabindex="-1"></a>    ggpubr<span class="sc">::</span><span class="fu">get_legend</span>(</span>
<span id="cb4-149"><a href="#cb4-149" aria-hidden="true" tabindex="-1"></a>      <span class="fu">main_plot</span>(pop_data) <span class="sc">+</span></span>
<span id="cb4-150"><a href="#cb4-150" aria-hidden="true" tabindex="-1"></a>        <span class="fu">theme</span>(<span class="at">axis.title =</span> <span class="fu">element_text</span>(), </span>
<span id="cb4-151"><a href="#cb4-151" aria-hidden="true" tabindex="-1"></a>              <span class="at">axis.text =</span> <span class="fu">element_text</span>()) <span class="sc">+</span></span>
<span id="cb4-152"><a href="#cb4-152" aria-hidden="true" tabindex="-1"></a>        <span class="fu">guides</span>(<span class="at">colour =</span> <span class="fu">guide_legend</span>(<span class="at">override.aes =</span> <span class="fu">list</span>(<span class="at">size=</span><span class="dv">5</span>, <span class="at">stroke =</span> <span class="dv">2</span>),</span>
<span id="cb4-153"><a href="#cb4-153" aria-hidden="true" tabindex="-1"></a>                                     <span class="at">nrow =</span> <span class="dv">2</span>,</span>
<span id="cb4-154"><a href="#cb4-154" aria-hidden="true" tabindex="-1"></a>                                     <span class="at">byrow =</span> <span class="cn">TRUE</span>,</span>
<span id="cb4-155"><a href="#cb4-155" aria-hidden="true" tabindex="-1"></a>                                     <span class="at">title =</span> <span class="fu">element_blank</span>()), </span>
<span id="cb4-156"><a href="#cb4-156" aria-hidden="true" tabindex="-1"></a>               <span class="at">pch =</span> <span class="fu">guide_legend</span>(<span class="at">nrow =</span> <span class="dv">2</span>,</span>
<span id="cb4-157"><a href="#cb4-157" aria-hidden="true" tabindex="-1"></a>                                  <span class="at">byrow =</span> <span class="cn">TRUE</span>,</span>
<span id="cb4-158"><a href="#cb4-158" aria-hidden="true" tabindex="-1"></a>                                  <span class="at">title =</span> <span class="fu">element_blank</span>())) <span class="sc">+</span></span>
<span id="cb4-159"><a href="#cb4-159" aria-hidden="true" tabindex="-1"></a>        <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"bottom"</span>, </span>
<span id="cb4-160"><a href="#cb4-160" aria-hidden="true" tabindex="-1"></a>              <span class="at">legend.box =</span> <span class="st">"vertical"</span>,</span>
<span id="cb4-161"><a href="#cb4-161" aria-hidden="true" tabindex="-1"></a>              <span class="at">legend.justification =</span> <span class="fu">c</span>(<span class="fl">0.5</span>,<span class="fl">0.5</span>),</span>
<span id="cb4-162"><a href="#cb4-162" aria-hidden="true" tabindex="-1"></a>              <span class="at">legend.background =</span> <span class="fu">element_rect</span>(<span class="at">color =</span> <span class="st">"black"</span>),</span>
<span id="cb4-163"><a href="#cb4-163" aria-hidden="true" tabindex="-1"></a>              <span class="at">legend.margin=</span><span class="fu">margin</span>(<span class="dv">5</span>,<span class="dv">5</span>,<span class="dv">5</span>,<span class="dv">6</span>),</span>
<span id="cb4-164"><a href="#cb4-164" aria-hidden="true" tabindex="-1"></a>              <span class="at">legend.title =</span> <span class="fu">element_text</span>()), </span>
<span id="cb4-165"><a href="#cb4-165" aria-hidden="true" tabindex="-1"></a>      </span>
<span id="cb4-166"><a href="#cb4-166" aria-hidden="true" tabindex="-1"></a>    )) </span>
<span id="cb4-167"><a href="#cb4-167" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-168"><a href="#cb4-168" aria-hidden="true" tabindex="-1"></a>fig2_yaxis <span class="ot">&lt;-</span> </span>
<span id="cb4-169"><a href="#cb4-169" aria-hidden="true" tabindex="-1"></a>  <span class="fu">wrap_elements</span>(fig2_main) <span class="sc">+</span></span>
<span id="cb4-170"><a href="#cb4-170" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">tag =</span> <span class="st">"Coeffient of variation in body size"</span>) <span class="sc">+</span></span>
<span id="cb4-171"><a href="#cb4-171" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(</span>
<span id="cb4-172"><a href="#cb4-172" aria-hidden="true" tabindex="-1"></a>    <span class="at">plot.tag =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">20</span>, <span class="at">angle =</span> <span class="dv">90</span>),</span>
<span id="cb4-173"><a href="#cb4-173" aria-hidden="true" tabindex="-1"></a>    <span class="at">plot.tag.position =</span> <span class="st">"left"</span></span>
<span id="cb4-174"><a href="#cb4-174" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb4-175"><a href="#cb4-175" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-176"><a href="#cb4-176" aria-hidden="true" tabindex="-1"></a>fig2 <span class="ot">&lt;-</span> </span>
<span id="cb4-177"><a href="#cb4-177" aria-hidden="true" tabindex="-1"></a>  fig2_yaxis <span class="sc">+</span> </span>
<span id="cb4-178"><a href="#cb4-178" aria-hidden="true" tabindex="-1"></a>  fig2_legend <span class="sc">+</span></span>
<span id="cb4-179"><a href="#cb4-179" aria-hidden="true" tabindex="-1"></a>  <span class="fu">plot_layout</span>(<span class="at">design =</span> {<span class="st">"</span></span>
<span id="cb4-180"><a href="#cb4-180" aria-hidden="true" tabindex="-1"></a><span class="st">      AAAAAAA</span></span>
<span id="cb4-181"><a href="#cb4-181" aria-hidden="true" tabindex="-1"></a><span class="st">      AAAAAAA</span></span>
<span id="cb4-182"><a href="#cb4-182" aria-hidden="true" tabindex="-1"></a><span class="st">      AAAAAAA</span></span>
<span id="cb4-183"><a href="#cb4-183" aria-hidden="true" tabindex="-1"></a><span class="st">      AAAAAAA</span></span>
<span id="cb4-184"><a href="#cb4-184" aria-hidden="true" tabindex="-1"></a><span class="st">            #BBBBB#"</span></span>
<span id="cb4-185"><a href="#cb4-185" aria-hidden="true" tabindex="-1"></a>  })</span>
<span id="cb4-186"><a href="#cb4-186" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-187"><a href="#cb4-187" aria-hidden="true" tabindex="-1"></a><span class="fu">ggsave</span>(<span class="at">filename =</span> <span class="st">"ms_figs/cv_meansize.png"</span>,</span>
<span id="cb4-188"><a href="#cb4-188" aria-hidden="true" tabindex="-1"></a>       <span class="at">plot =</span> fig2,</span>
<span id="cb4-189"><a href="#cb4-189" aria-hidden="true" tabindex="-1"></a>       <span class="at">height =</span> <span class="dv">20</span>,</span>
<span id="cb4-190"><a href="#cb4-190" aria-hidden="true" tabindex="-1"></a>       <span class="at">width =</span> <span class="dv">20</span><span class="sc">*</span><span class="fl">1.618</span>,</span>
<span id="cb4-191"><a href="#cb4-191" aria-hidden="true" tabindex="-1"></a>       <span class="at">units =</span> <span class="st">"cm"</span>, </span>
<span id="cb4-192"><a href="#cb4-192" aria-hidden="true" tabindex="-1"></a>       <span class="at">create.dir =</span> <span class="cn">TRUE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="ms_figs/cv_meansize.png" class="img-fluid figure-img"></p>
<figcaption class="figure-caption">Coefficient of variation (CV) of body length distributions of ca 3000 fish populations of larger bodied species (visual census and largest cryptobenthic fish) is approximately 0.34, regardless of the mean body length of the population and the assumed statistical distribution. Each symbol shows the CV value of a single fish population (grid cell, see Methods) or species. The color and shape of the symbol indicates the better-fitting statistical distribution and the sampling method. CV (y-axis) is calculated as the median of the posterior parameters associated with the better-fit distribution. Colored horizonal lines represent the median CV values, dashed line shows the estimated CV value of protists from Giometto et al.13. Margin density plots show the distribution of CV values across populations; for cryptobenthic lognormal preferred (black triangles), marginal plots are not shown due to small sample sizes (n = 9 populations). Symbol size is relative to the sample size (log scale).</figcaption>
</figure>
</div>
</section>
<section id="figure-3" class="level1">
<h1>Figure 3</h1>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a>make_plot <span class="ot">&lt;-</span> <span class="cf">function</span>(data, title){</span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a>  data <span class="sc">%&gt;%</span> </span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> size_class,</span>
<span id="cb5-4"><a href="#cb5-4" aria-hidden="true" tabindex="-1"></a>               <span class="at">y =</span> p_obs, </span>
<span id="cb5-5"><a href="#cb5-5" aria-hidden="true" tabindex="-1"></a>               <span class="at">width =</span> size_max<span class="sc">-</span>size_min)) <span class="sc">+</span></span>
<span id="cb5-6"><a href="#cb5-6" aria-hidden="true" tabindex="-1"></a>    <span class="fu">facet_wrap</span>(<span class="sc">~</span>species, <span class="at">ncol =</span> <span class="dv">2</span>, <span class="at">scales =</span> <span class="st">"free"</span>) <span class="sc">+</span></span>
<span id="cb5-7"><a href="#cb5-7" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_vline</span>(<span class="fu">aes</span>(<span class="at">xintercept =</span> mean_size), <span class="at">lty =</span> <span class="dv">2</span>, <span class="at">linewidth =</span> <span class="fl">1.5</span>) <span class="sc">+</span></span>
<span id="cb5-8"><a href="#cb5-8" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_rect</span>(<span class="fu">aes</span>(<span class="at">xmin =</span> size_min, <span class="at">xmax =</span> size_max, <span class="at">ymin =</span> <span class="dv">0</span>, <span class="at">ymax =</span> p_obs), </span>
<span id="cb5-9"><a href="#cb5-9" aria-hidden="true" tabindex="-1"></a>              <span class="at">alpha =</span> <span class="fl">0.2</span>, </span>
<span id="cb5-10"><a href="#cb5-10" aria-hidden="true" tabindex="-1"></a>              <span class="at">col =</span> <span class="st">"black"</span>,</span>
<span id="cb5-11"><a href="#cb5-11" aria-hidden="true" tabindex="-1"></a>              <span class="at">fill =</span> <span class="st">"grey70"</span>) <span class="sc">+</span> </span>
<span id="cb5-12"><a href="#cb5-12" aria-hidden="true" tabindex="-1"></a>    <span class="co"># geom_point(aes(col = name, y = value, alpha = alp)) +</span></span>
<span id="cb5-13"><a href="#cb5-13" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_path</span>(<span class="fu">aes</span>(<span class="at">col =</span> name, <span class="at">y =</span> value, <span class="at">alpha =</span> alp, <span class="at">lty=</span>lty), <span class="at">linewidth =</span> <span class="dv">2</span>) <span class="sc">+</span></span>
<span id="cb5-14"><a href="#cb5-14" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_alpha_identity</span>()<span class="sc">+</span></span>
<span id="cb5-15"><a href="#cb5-15" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_linetype_identity</span>() <span class="sc">+</span></span>
<span id="cb5-16"><a href="#cb5-16" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_colour_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">"p_norm"</span> <span class="ot">=</span> <span class="fu">rgb</span>(<span class="dv">181</span>, <span class="dv">144</span>, <span class="dv">19</span>, <span class="at">maxColorValue=</span><span class="dv">255</span>), </span>
<span id="cb5-17"><a href="#cb5-17" aria-hidden="true" tabindex="-1"></a>                                   <span class="st">"p_lnorm"</span> <span class="ot">=</span> <span class="fu">rgb</span>(<span class="dv">29</span>, <span class="dv">84</span>, <span class="dv">128</span>, <span class="at">maxColorValue=</span><span class="dv">255</span>)))<span class="sc">+</span></span>
<span id="cb5-18"><a href="#cb5-18" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme_cowplot</span>(<span class="dv">20</span>) <span class="sc">+</span></span>
<span id="cb5-19"><a href="#cb5-19" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_y_continuous</span>(<span class="at">label =</span> <span class="fu">label_percent</span>())<span class="sc">+</span></span>
<span id="cb5-20"><a href="#cb5-20" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_x_continuous</span>(<span class="at">label =</span> <span class="fu">label_number</span>()) <span class="sc">+</span></span>
<span id="cb5-21"><a href="#cb5-21" aria-hidden="true" tabindex="-1"></a>    <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"Length class (cm)"</span>, </span>
<span id="cb5-22"><a href="#cb5-22" aria-hidden="true" tabindex="-1"></a>         <span class="at">y =</span> <span class="st">"Proportion in length class"</span>) <span class="sc">+</span></span>
<span id="cb5-23"><a href="#cb5-23" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"none"</span>,</span>
<span id="cb5-24"><a href="#cb5-24" aria-hidden="true" tabindex="-1"></a>          <span class="at">strip.background =</span> <span class="fu">element_rect</span>(</span>
<span id="cb5-25"><a href="#cb5-25" aria-hidden="true" tabindex="-1"></a>            <span class="at">colour =</span> <span class="st">"black"</span>,</span>
<span id="cb5-26"><a href="#cb5-26" aria-hidden="true" tabindex="-1"></a>            <span class="at">fill =</span> <span class="st">"white"</span>), </span>
<span id="cb5-27"><a href="#cb5-27" aria-hidden="true" tabindex="-1"></a>          <span class="at">strip.text =</span> <span class="fu">element_text</span>(<span class="at">face =</span> <span class="st">"italic"</span>), </span>
<span id="cb5-28"><a href="#cb5-28" aria-hidden="true" tabindex="-1"></a>          <span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">hjust =</span> <span class="fl">0.5</span>)) <span class="sc">+</span></span>
<span id="cb5-29"><a href="#cb5-29" aria-hidden="true" tabindex="-1"></a>    <span class="fu">ggtitle</span>(<span class="at">label =</span> title)</span>
<span id="cb5-30"><a href="#cb5-30" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb5-31"><a href="#cb5-31" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-32"><a href="#cb5-32" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-33"><a href="#cb5-33" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-34"><a href="#cb5-34" aria-hidden="true" tabindex="-1"></a>fig3a <span class="ot">&lt;-</span> </span>
<span id="cb5-35"><a href="#cb5-35" aria-hidden="true" tabindex="-1"></a>  fig3_data <span class="sc">%&gt;%</span> </span>
<span id="cb5-36"><a href="#cb5-36" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(pref <span class="sc">==</span> <span class="st">"lnorm_pref"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb5-37"><a href="#cb5-37" aria-hidden="true" tabindex="-1"></a>  <span class="fu">make_plot</span>(<span class="st">"Strong preference for lognormal"</span>)</span>
<span id="cb5-38"><a href="#cb5-38" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-39"><a href="#cb5-39" aria-hidden="true" tabindex="-1"></a>fig3b <span class="ot">&lt;-</span> </span>
<span id="cb5-40"><a href="#cb5-40" aria-hidden="true" tabindex="-1"></a>  fig3_data <span class="sc">%&gt;%</span> </span>
<span id="cb5-41"><a href="#cb5-41" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(pref <span class="sc">==</span> <span class="st">"no_pref"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb5-42"><a href="#cb5-42" aria-hidden="true" tabindex="-1"></a>  <span class="fu">make_plot</span>(<span class="st">"No preference for normal or lognormal"</span>)</span>
<span id="cb5-43"><a href="#cb5-43" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-44"><a href="#cb5-44" aria-hidden="true" tabindex="-1"></a>fig3c <span class="ot">&lt;-</span> </span>
<span id="cb5-45"><a href="#cb5-45" aria-hidden="true" tabindex="-1"></a>  fig3_data <span class="sc">%&gt;%</span> </span>
<span id="cb5-46"><a href="#cb5-46" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(pref <span class="sc">==</span> <span class="st">"norm_pref"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb5-47"><a href="#cb5-47" aria-hidden="true" tabindex="-1"></a>  <span class="fu">make_plot</span>(<span class="st">"Strong preference for normal"</span>)</span>
<span id="cb5-48"><a href="#cb5-48" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-49"><a href="#cb5-49" aria-hidden="true" tabindex="-1"></a>ks_curve <span class="ot">&lt;-</span> </span>
<span id="cb5-50"><a href="#cb5-50" aria-hidden="true" tabindex="-1"></a>  fig3_data_ks <span class="sc">%&gt;%</span> </span>
<span id="cb5-51"><a href="#cb5-51" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(<span class="at">cols =</span> <span class="fu">contains</span>(<span class="st">"ks"</span>), </span>
<span id="cb5-52"><a href="#cb5-52" aria-hidden="true" tabindex="-1"></a>               <span class="at">values_to =</span> <span class="st">"ks"</span>,</span>
<span id="cb5-53"><a href="#cb5-53" aria-hidden="true" tabindex="-1"></a>               <span class="at">names_to =</span> <span class="st">"dist"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb5-54"><a href="#cb5-54" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">mean_ks =</span> <span class="fu">mean</span>(ks), </span>
<span id="cb5-55"><a href="#cb5-55" aria-hidden="true" tabindex="-1"></a>            <span class="at">median_ks =</span> <span class="fu">median</span>(ks), </span>
<span id="cb5-56"><a href="#cb5-56" aria-hidden="true" tabindex="-1"></a>            <span class="at">lwr_ks =</span> <span class="fu">quantile</span>(ks, <span class="fl">0.025</span>), </span>
<span id="cb5-57"><a href="#cb5-57" aria-hidden="true" tabindex="-1"></a>            <span class="at">upr_ks =</span> <span class="fu">quantile</span>(ks, <span class="fl">0.875</span>), </span>
<span id="cb5-58"><a href="#cb5-58" aria-hidden="true" tabindex="-1"></a>            <span class="at">.by =</span> <span class="fu">c</span>(c, dist)) <span class="sc">%&gt;%</span> </span>
<span id="cb5-59"><a href="#cb5-59" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> c, </span>
<span id="cb5-60"><a href="#cb5-60" aria-hidden="true" tabindex="-1"></a>             <span class="at">y =</span> mean_ks, </span>
<span id="cb5-61"><a href="#cb5-61" aria-hidden="true" tabindex="-1"></a>             <span class="at">color =</span> dist)) <span class="sc">+</span></span>
<span id="cb5-62"><a href="#cb5-62" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">linewidth =</span> <span class="dv">2</span>, <span class="at">alpha =</span> <span class="fl">0.8</span>) <span class="sc">+</span></span>
<span id="cb5-63"><a href="#cb5-63" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">"norm_ks"</span> <span class="ot">=</span> <span class="fu">rgb</span>(<span class="dv">181</span>, <span class="dv">144</span>, <span class="dv">19</span>, <span class="at">maxColorValue=</span><span class="dv">255</span>),</span>
<span id="cb5-64"><a href="#cb5-64" aria-hidden="true" tabindex="-1"></a>                                <span class="st">"lnorm_ks"</span> <span class="ot">=</span> <span class="fu">rgb</span>(<span class="dv">29</span>, <span class="dv">84</span>, <span class="dv">128</span>, <span class="at">maxColorValue=</span><span class="dv">255</span>), </span>
<span id="cb5-65"><a href="#cb5-65" aria-hidden="true" tabindex="-1"></a>                                <span class="st">"pref_ks"</span> <span class="ot">=</span> <span class="st">"pink"</span>),</span>
<span id="cb5-66"><a href="#cb5-66" aria-hidden="true" tabindex="-1"></a>                     <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"norm_ks"</span> <span class="ot">=</span> <span class="st">"Normal"</span>,</span>
<span id="cb5-67"><a href="#cb5-67" aria-hidden="true" tabindex="-1"></a>                                <span class="st">"lnorm_ks"</span> <span class="ot">=</span> <span class="st">"Lognormal"</span>,                                 <span class="st">"pref_ks"</span> <span class="ot">=</span> <span class="st">"Preferred"</span>)) <span class="sc">+</span></span>
<span id="cb5-68"><a href="#cb5-68" aria-hidden="true" tabindex="-1"></a>  <span class="fu">guides</span>(<span class="at">color =</span> <span class="fu">guide_legend</span>(<span class="at">override.aes =</span> <span class="fu">list</span>(<span class="at">alpha =</span> <span class="dv">1</span>) ) ) <span class="sc">+</span></span>
<span id="cb5-69"><a href="#cb5-69" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>() <span class="sc">+</span></span>
<span id="cb5-70"><a href="#cb5-70" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"Assumed Coefficient of Variation"</span>, </span>
<span id="cb5-71"><a href="#cb5-71" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">"Dissimilarity (K-S statistic)"</span>) <span class="sc">+</span></span>
<span id="cb5-72"><a href="#cb5-72" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_cowplot</span>(<span class="dv">20</span>) <span class="sc">+</span></span>
<span id="cb5-73"><a href="#cb5-73" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="fu">c</span>(<span class="fl">0.95</span>,<span class="fl">0.05</span>), </span>
<span id="cb5-74"><a href="#cb5-74" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.justification =</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">0</span>),</span>
<span id="cb5-75"><a href="#cb5-75" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.title =</span> <span class="fu">element_blank</span>(), </span>
<span id="cb5-76"><a href="#cb5-76" aria-hidden="true" tabindex="-1"></a>        <span class="at">plot.background =</span> <span class="fu">element_rect</span>(<span class="at">color =</span> <span class="st">"transparent"</span>)) </span>
<span id="cb5-77"><a href="#cb5-77" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-78"><a href="#cb5-78" aria-hidden="true" tabindex="-1"></a>fig3 <span class="ot">&lt;-</span>  </span>
<span id="cb5-79"><a href="#cb5-79" aria-hidden="true" tabindex="-1"></a>  fig3a <span class="sc">+</span> </span>
<span id="cb5-80"><a href="#cb5-80" aria-hidden="true" tabindex="-1"></a>  fig3b <span class="sc">+</span> </span>
<span id="cb5-81"><a href="#cb5-81" aria-hidden="true" tabindex="-1"></a>  fig3c <span class="sc">+</span> </span>
<span id="cb5-82"><a href="#cb5-82" aria-hidden="true" tabindex="-1"></a>  ks_curve <span class="sc">+</span></span>
<span id="cb5-83"><a href="#cb5-83" aria-hidden="true" tabindex="-1"></a>  <span class="fu">plot_annotation</span>(<span class="at">tag_levels =</span> <span class="st">'A'</span>)</span>
<span id="cb5-84"><a href="#cb5-84" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-85"><a href="#cb5-85" aria-hidden="true" tabindex="-1"></a><span class="fu">ggsave</span>(<span class="at">filename =</span> <span class="st">"ms_figs/ks_curve.png"</span>,</span>
<span id="cb5-86"><a href="#cb5-86" aria-hidden="true" tabindex="-1"></a>       <span class="at">plot =</span> fig3,</span>
<span id="cb5-87"><a href="#cb5-87" aria-hidden="true" tabindex="-1"></a>       <span class="at">height =</span> <span class="dv">25</span>,</span>
<span id="cb5-88"><a href="#cb5-88" aria-hidden="true" tabindex="-1"></a>       <span class="at">width =</span> <span class="dv">25</span><span class="sc">*</span><span class="fl">1.618</span>,</span>
<span id="cb5-89"><a href="#cb5-89" aria-hidden="true" tabindex="-1"></a>       <span class="at">units =</span> <span class="st">"cm"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="ms_figs/ks_curve.png" class="img-fluid figure-img"></p>
<figcaption class="figure-caption">Empirical body size distributions (grey bars) can be reconstructed from the mean body size of the population (vertical black dashed line) and assumed CV of 0.34. Panels A-C show randomly selected populations from one of three population groups for which body size distributions were best described by lognormal, normal or either of the two statistical distributions. Grey bars show observed data and lines show predicted distributions assuming either truncated normal or lognormal statistical distribution and CV of 0.34. Panel D shows that assuming CV of 0.34 provides the best fitting distributions with lowest median Kolmogorov-Smirnov (K-S) statistic across all populations regardless of the assumed statistical distribution (lognormal for all 3000 populations, truncated normal for all, or estimated using the best fitting distribution). Lower or higher CV values quickly reduced the predictive power, shown by higher K-S values.</figcaption>
</figure>
</div>
</section>
<section id="figure-4" class="level1">
<h1>Figure 4</h1>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a>make_fig4 <span class="ot">&lt;-</span> <span class="cf">function</span>(data, spp_select){</span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a>  dat1 <span class="ot">&lt;-</span> </span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a>    data <span class="sc">%&gt;%</span> </span>
<span id="cb6-4"><a href="#cb6-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(species <span class="sc">==</span> spp_select) </span>
<span id="cb6-5"><a href="#cb6-5" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb6-6"><a href="#cb6-6" aria-hidden="true" tabindex="-1"></a>  dat1 <span class="sc">%&gt;%</span> </span>
<span id="cb6-7"><a href="#cb6-7" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(name <span class="sc">!=</span> <span class="st">"p_lnorm"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb6-8"><a href="#cb6-8" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(name <span class="sc">!=</span> <span class="st">"rls_obs"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb6-9"><a href="#cb6-9" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">species =</span> <span class="fu">fct_reorder</span>(species, std_mk)) <span class="sc">%&gt;%</span> </span>
<span id="cb6-10"><a href="#cb6-10" aria-hidden="true" tabindex="-1"></a>    <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> size_class, </span>
<span id="cb6-11"><a href="#cb6-11" aria-hidden="true" tabindex="-1"></a>               <span class="at">y =</span> value)) <span class="sc">+</span></span>
<span id="cb6-12"><a href="#cb6-12" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_rect</span>(<span class="fu">aes</span>(<span class="at">xmin =</span> size_min, </span>
<span id="cb6-13"><a href="#cb6-13" aria-hidden="true" tabindex="-1"></a>                  <span class="at">xmax =</span> size_max, </span>
<span id="cb6-14"><a href="#cb6-14" aria-hidden="true" tabindex="-1"></a>                  <span class="at">ymin =</span> <span class="dv">0</span>, </span>
<span id="cb6-15"><a href="#cb6-15" aria-hidden="true" tabindex="-1"></a>                  <span class="at">ymax =</span> value, </span>
<span id="cb6-16"><a href="#cb6-16" aria-hidden="true" tabindex="-1"></a>                  <span class="at">fill =</span> size_10), </span>
<span id="cb6-17"><a href="#cb6-17" aria-hidden="true" tabindex="-1"></a>              <span class="at">col =</span> <span class="st">"black"</span>,</span>
<span id="cb6-18"><a href="#cb6-18" aria-hidden="true" tabindex="-1"></a>              <span class="at">data =</span> dat1 <span class="sc">%&gt;%</span> </span>
<span id="cb6-19"><a href="#cb6-19" aria-hidden="true" tabindex="-1"></a>                <span class="fu">filter</span>(name <span class="sc">==</span> <span class="st">"rls_obs"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb6-20"><a href="#cb6-20" aria-hidden="true" tabindex="-1"></a>                <span class="fu">mutate</span>(<span class="at">size_10 =</span> <span class="fu">case_when</span>(size_class <span class="sc">&gt;=</span> <span class="dv">10</span> <span class="sc">~</span> <span class="st">"large"</span>, </span>
<span id="cb6-21"><a href="#cb6-21" aria-hidden="true" tabindex="-1"></a>                                           <span class="cn">TRUE</span> <span class="sc">~</span> <span class="st">"small"</span>))) <span class="sc">+</span></span>
<span id="cb6-22"><a href="#cb6-22" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_fill_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">"large"</span> <span class="ot">=</span> <span class="st">"grey70"</span>, </span>
<span id="cb6-23"><a href="#cb6-23" aria-hidden="true" tabindex="-1"></a>                                 <span class="st">"small"</span> <span class="ot">=</span> <span class="st">"grey90"</span>),</span>
<span id="cb6-24"><a href="#cb6-24" aria-hidden="true" tabindex="-1"></a>                      <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"large"</span> <span class="ot">=</span> <span class="st">"Observed (Length \U2265 10cm)"</span>, </span>
<span id="cb6-25"><a href="#cb6-25" aria-hidden="true" tabindex="-1"></a>                                 <span class="st">"small"</span> <span class="ot">=</span> <span class="st">"Observed (Length \U003C 10cm)"</span>)) <span class="sc">+</span></span>
<span id="cb6-26"><a href="#cb6-26" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_color_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">"p_norm"</span> <span class="ot">=</span> <span class="fu">rgb</span>(<span class="dv">181</span>, <span class="dv">144</span>, <span class="dv">19</span>, <span class="at">maxColorValue=</span><span class="dv">255</span>), </span>
<span id="cb6-27"><a href="#cb6-27" aria-hidden="true" tabindex="-1"></a>                                  <span class="st">"lbspr"</span> <span class="ot">=</span> <span class="fu">rgb</span>(<span class="dv">148</span>, <span class="dv">31</span>, <span class="dv">36</span>, <span class="at">maxColorValue=</span><span class="dv">255</span>), </span>
<span id="cb6-28"><a href="#cb6-28" aria-hidden="true" tabindex="-1"></a>                                  <span class="st">"lbspr_mk15"</span> <span class="ot">=</span> <span class="fu">rgb</span>(<span class="dv">70</span>, <span class="dv">172</span>, <span class="dv">200</span>, <span class="at">maxColorValue=</span><span class="dv">255</span>)),</span>
<span id="cb6-29"><a href="#cb6-29" aria-hidden="true" tabindex="-1"></a>                       <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"lbspr"</span> <span class="ot">=</span> <span class="st">"LBSPR (estimate)"</span>, </span>
<span id="cb6-30"><a href="#cb6-30" aria-hidden="true" tabindex="-1"></a>                                  <span class="st">"lbspr_mk15"</span> <span class="ot">=</span> <span class="st">"LBSPR (M/k = 1.5, estimate)"</span>,</span>
<span id="cb6-31"><a href="#cb6-31" aria-hidden="true" tabindex="-1"></a>                                  <span class="st">"p_norm"</span> <span class="ot">=</span> <span class="st">"Normal (estimate)"</span>)) <span class="sc">+</span></span>
<span id="cb6-32"><a href="#cb6-32" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_vline</span>(<span class="at">xintercept =</span> <span class="fl">8.75</span>, <span class="at">lty =</span> <span class="dv">2</span>) <span class="sc">+</span></span>
<span id="cb6-33"><a href="#cb6-33" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_path</span>(<span class="fu">aes</span>(<span class="at">col =</span> name), <span class="at">linewidth =</span> <span class="dv">2</span>, <span class="at">alpha =</span> <span class="fl">0.8</span>) <span class="sc">+</span></span>
<span id="cb6-34"><a href="#cb6-34" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_text</span>(<span class="fu">aes</span>(<span class="at">x =</span> <span class="cn">Inf</span>, <span class="at">y =</span> <span class="cn">Inf</span>, <span class="at">label =</span> <span class="fu">paste</span>(<span class="st">"M/k ="</span>, std_mk, <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>, </span>
<span id="cb6-35"><a href="#cb6-35" aria-hidden="true" tabindex="-1"></a>                                                  <span class="st">"L\U221E ="</span>, std_linf, <span class="st">"cm"</span>)),</span>
<span id="cb6-36"><a href="#cb6-36" aria-hidden="true" tabindex="-1"></a>              <span class="at">hjust =</span> <span class="dv">1</span>,</span>
<span id="cb6-37"><a href="#cb6-37" aria-hidden="true" tabindex="-1"></a>              <span class="at">vjust =</span> <span class="fl">1.2</span>,</span>
<span id="cb6-38"><a href="#cb6-38" aria-hidden="true" tabindex="-1"></a>              <span class="at">data =</span> mk_text <span class="sc">%&gt;%</span> <span class="fu">filter</span>(species <span class="sc">==</span> spp_select)) <span class="sc">+</span></span>
<span id="cb6-39"><a href="#cb6-39" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_x_continuous</span>(<span class="at">limits =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="cn">NA</span>), <span class="at">label =</span> <span class="fu">label_number</span>()) <span class="sc">+</span></span>
<span id="cb6-40"><a href="#cb6-40" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_y_continuous</span>(<span class="at">label =</span> <span class="fu">label_percent</span>()) <span class="sc">+</span></span>
<span id="cb6-41"><a href="#cb6-41" aria-hidden="true" tabindex="-1"></a>    <span class="fu">facet_wrap</span>(<span class="sc">~</span><span class="fu">fct_reorder</span>(species, std_mk), <span class="at">scales =</span> <span class="st">"free"</span>) <span class="sc">+</span></span>
<span id="cb6-42"><a href="#cb6-42" aria-hidden="true" tabindex="-1"></a>    <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"Length class (cm)"</span>, </span>
<span id="cb6-43"><a href="#cb6-43" aria-hidden="true" tabindex="-1"></a>         <span class="at">y =</span> <span class="st">"Proportion"</span>) <span class="sc">+</span></span>
<span id="cb6-44"><a href="#cb6-44" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme_cowplot</span>() <span class="sc">+</span></span>
<span id="cb6-45"><a href="#cb6-45" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"none"</span>, </span>
<span id="cb6-46"><a href="#cb6-46" aria-hidden="true" tabindex="-1"></a>          <span class="at">strip.background =</span> <span class="fu">element_rect</span>(<span class="at">fill =</span> <span class="st">"transparent"</span>), </span>
<span id="cb6-47"><a href="#cb6-47" aria-hidden="true" tabindex="-1"></a>          <span class="at">strip.text =</span> <span class="fu">element_text</span>(<span class="at">face =</span> <span class="st">"italic"</span>), </span>
<span id="cb6-48"><a href="#cb6-48" aria-hidden="true" tabindex="-1"></a>          <span class="at">axis.title.y =</span> <span class="fu">element_blank</span>(), </span>
<span id="cb6-49"><a href="#cb6-49" aria-hidden="true" tabindex="-1"></a>          <span class="at">axis.title.x =</span> <span class="fu">element_blank</span>())</span>
<span id="cb6-50"><a href="#cb6-50" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb6-51"><a href="#cb6-51" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-52"><a href="#cb6-52" aria-hidden="true" tabindex="-1"></a>ks_data <span class="ot">&lt;-</span> </span>
<span id="cb6-53"><a href="#cb6-53" aria-hidden="true" tabindex="-1"></a>  fig4_data <span class="sc">%&gt;%</span> </span>
<span id="cb6-54"><a href="#cb6-54" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_wider</span>(<span class="at">names_from =</span> name, <span class="at">values_from =</span> value)</span>
<span id="cb6-55"><a href="#cb6-55" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-56"><a href="#cb6-56" aria-hidden="true" tabindex="-1"></a>ks_fig_data <span class="ot">&lt;-</span> </span>
<span id="cb6-57"><a href="#cb6-57" aria-hidden="true" tabindex="-1"></a>  ks_data <span class="sc">%&gt;%</span> </span>
<span id="cb6-58"><a href="#cb6-58" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">ks_norm =</span> <span class="fu">ks.test</span>(<span class="at">x =</span> rls_obs, </span>
<span id="cb6-59"><a href="#cb6-59" aria-hidden="true" tabindex="-1"></a>                              <span class="at">y =</span> p_norm)<span class="sc">$</span>statistic,</span>
<span id="cb6-60"><a href="#cb6-60" aria-hidden="true" tabindex="-1"></a>            <span class="at">ks_lnorm =</span> <span class="fu">ks.test</span>(<span class="at">x =</span> rls_obs, </span>
<span id="cb6-61"><a href="#cb6-61" aria-hidden="true" tabindex="-1"></a>                               <span class="at">y =</span> p_lnorm)<span class="sc">$</span>statistic,</span>
<span id="cb6-62"><a href="#cb6-62" aria-hidden="true" tabindex="-1"></a>            <span class="at">ks_lbspr =</span> <span class="fu">ks.test</span>(<span class="at">x =</span> rls_obs, </span>
<span id="cb6-63"><a href="#cb6-63" aria-hidden="true" tabindex="-1"></a>                               <span class="at">y =</span> lbspr)<span class="sc">$</span>statistic,</span>
<span id="cb6-64"><a href="#cb6-64" aria-hidden="true" tabindex="-1"></a>            <span class="at">ks_lbspr_mk15 =</span> <span class="fu">ks.test</span>(<span class="at">x =</span> rls_obs, </span>
<span id="cb6-65"><a href="#cb6-65" aria-hidden="true" tabindex="-1"></a>                                    <span class="at">y =</span> lbspr_mk15)<span class="sc">$</span>statistic,</span>
<span id="cb6-66"><a href="#cb6-66" aria-hidden="true" tabindex="-1"></a>            <span class="at">.by =</span> species) <span class="sc">%&gt;%</span> </span>
<span id="cb6-67"><a href="#cb6-67" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(<span class="at">cols =</span> <span class="fu">contains</span>(<span class="st">"ks_"</span>))</span>
<span id="cb6-68"><a href="#cb6-68" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-69"><a href="#cb6-69" aria-hidden="true" tabindex="-1"></a>ks_fig_data_rmsmall <span class="ot">&lt;-</span> </span>
<span id="cb6-70"><a href="#cb6-70" aria-hidden="true" tabindex="-1"></a>  ks_data <span class="sc">%&gt;%</span> </span>
<span id="cb6-71"><a href="#cb6-71" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(size_class <span class="sc">&gt;=</span> <span class="dv">10</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb6-72"><a href="#cb6-72" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">ks_norm =</span> <span class="fu">ks.test</span>(<span class="at">x =</span> p_norm, </span>
<span id="cb6-73"><a href="#cb6-73" aria-hidden="true" tabindex="-1"></a>                              <span class="at">y =</span> rls_obs)<span class="sc">$</span>statistic,</span>
<span id="cb6-74"><a href="#cb6-74" aria-hidden="true" tabindex="-1"></a>            <span class="at">ks_lnorm =</span> <span class="fu">ks.test</span>(<span class="at">x =</span> p_lnorm, </span>
<span id="cb6-75"><a href="#cb6-75" aria-hidden="true" tabindex="-1"></a>                               <span class="at">y =</span> rls_obs)<span class="sc">$</span>statistic,</span>
<span id="cb6-76"><a href="#cb6-76" aria-hidden="true" tabindex="-1"></a>            <span class="at">ks_lbspr =</span> <span class="fu">ks.test</span>(<span class="at">x =</span> lbspr, </span>
<span id="cb6-77"><a href="#cb6-77" aria-hidden="true" tabindex="-1"></a>                               <span class="at">y =</span> rls_obs)<span class="sc">$</span>statistic,</span>
<span id="cb6-78"><a href="#cb6-78" aria-hidden="true" tabindex="-1"></a>            <span class="at">ks_lbspr_mk15 =</span> <span class="fu">ks.test</span>(<span class="at">x =</span> rls_obs, </span>
<span id="cb6-79"><a href="#cb6-79" aria-hidden="true" tabindex="-1"></a>                                    <span class="at">y =</span> lbspr_mk15)<span class="sc">$</span>statistic,</span>
<span id="cb6-80"><a href="#cb6-80" aria-hidden="true" tabindex="-1"></a>            <span class="at">.by =</span> species) <span class="sc">%&gt;%</span> </span>
<span id="cb6-81"><a href="#cb6-81" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(<span class="at">cols =</span> <span class="fu">contains</span>(<span class="st">"ks_"</span>))</span>
<span id="cb6-82"><a href="#cb6-82" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-83"><a href="#cb6-83" aria-hidden="true" tabindex="-1"></a>fig4_violins <span class="ot">&lt;-</span></span>
<span id="cb6-84"><a href="#cb6-84" aria-hidden="true" tabindex="-1"></a>  ks_fig_data_rmsmall <span class="sc">%&gt;%</span></span>
<span id="cb6-85"><a href="#cb6-85" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="at">rmsmall =</span> value) <span class="sc">%&gt;%</span></span>
<span id="cb6-86"><a href="#cb6-86" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span>(ks_fig_data <span class="sc">%&gt;%</span></span>
<span id="cb6-87"><a href="#cb6-87" aria-hidden="true" tabindex="-1"></a>              <span class="fu">rename</span>(<span class="at">withsmall =</span> value)) <span class="sc">%&gt;%</span></span>
<span id="cb6-88"><a href="#cb6-88" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(<span class="at">cols =</span> <span class="fu">contains</span>(<span class="st">"small"</span>),</span>
<span id="cb6-89"><a href="#cb6-89" aria-hidden="true" tabindex="-1"></a>               <span class="at">names_to =</span> <span class="st">"inc_small"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb6-90"><a href="#cb6-90" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">inc_small =</span> <span class="fu">case_when</span>(inc_small <span class="sc">==</span> <span class="st">"rmsmall"</span> <span class="sc">~</span> <span class="st">"Exluding sizes &lt; 10cm"</span>,</span>
<span id="cb6-91"><a href="#cb6-91" aria-hidden="true" tabindex="-1"></a>                               inc_small <span class="sc">==</span> <span class="st">"withsmall"</span> <span class="sc">~</span> <span class="st">"All size classes"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb6-92"><a href="#cb6-92" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(name <span class="sc">!=</span> <span class="st">"ks_lnorm"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb6-93"><a href="#cb6-93" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">y =</span> value, <span class="at">x =</span> name)) <span class="sc">+</span></span>
<span id="cb6-94"><a href="#cb6-94" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_violin</span>()<span class="sc">+</span></span>
<span id="cb6-95"><a href="#cb6-95" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>(<span class="at">width =</span> <span class="fl">0.1</span>) <span class="sc">+</span></span>
<span id="cb6-96"><a href="#cb6-96" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span>inc_small, <span class="at">nrow=</span><span class="dv">2</span>) <span class="sc">+</span></span>
<span id="cb6-97"><a href="#cb6-97" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_discrete</span>(<span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"ks_lbspr"</span> <span class="ot">=</span> <span class="st">"LBSPR"</span>,</span>
<span id="cb6-98"><a href="#cb6-98" aria-hidden="true" tabindex="-1"></a>                              <span class="st">"ks_lbspr_mk15"</span> <span class="ot">=</span> <span class="st">"LBSPR </span><span class="sc">\n</span><span class="st"> (M/k = 1.5)"</span>,</span>
<span id="cb6-99"><a href="#cb6-99" aria-hidden="true" tabindex="-1"></a>                              <span class="st">"ks_norm"</span> <span class="ot">=</span> <span class="st">"CV = 0.34"</span>)) <span class="sc">+</span></span>
<span id="cb6-100"><a href="#cb6-100" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">y =</span> <span class="st">"Dissimilarity to observed"</span>) <span class="sc">+</span></span>
<span id="cb6-101"><a href="#cb6-101" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_cowplot</span>(<span class="dv">17</span>) <span class="sc">+</span></span>
<span id="cb6-102"><a href="#cb6-102" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"none"</span>,</span>
<span id="cb6-103"><a href="#cb6-103" aria-hidden="true" tabindex="-1"></a>        <span class="at">panel.grid.major.y =</span> <span class="fu">element_line</span>(<span class="at">colour =</span> <span class="st">"grey80"</span>),</span>
<span id="cb6-104"><a href="#cb6-104" aria-hidden="true" tabindex="-1"></a>        <span class="at">strip.background =</span> <span class="fu">element_rect</span>(<span class="at">fill =</span> <span class="st">"transparent"</span>, <span class="at">colour =</span> <span class="st">"black"</span>),</span>
<span id="cb6-105"><a href="#cb6-105" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.title.x =</span> <span class="fu">element_blank</span>())</span>
<span id="cb6-106"><a href="#cb6-106" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-107"><a href="#cb6-107" aria-hidden="true" tabindex="-1"></a>arranged_species <span class="ot">&lt;-</span> fig4_data_sample <span class="sc">%&gt;%</span> <span class="fu">arrange</span>(std_mk) <span class="sc">%&gt;%</span> <span class="fu">pull</span>(species)  <span class="sc">%&gt;%</span> <span class="fu">unique</span>()</span>
<span id="cb6-108"><a href="#cb6-108" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-109"><a href="#cb6-109" aria-hidden="true" tabindex="-1"></a>mk_text <span class="ot">&lt;-</span> </span>
<span id="cb6-110"><a href="#cb6-110" aria-hidden="true" tabindex="-1"></a>  fig4_data_sample <span class="sc">%&gt;%</span> </span>
<span id="cb6-111"><a href="#cb6-111" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(p_obs <span class="sc">!=</span> <span class="dv">0</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb6-112"><a href="#cb6-112" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">max_x =</span> <span class="fu">max</span>(size_class, <span class="at">na.rm =</span> <span class="cn">TRUE</span>), </span>
<span id="cb6-113"><a href="#cb6-113" aria-hidden="true" tabindex="-1"></a>            <span class="at">max_y =</span> <span class="fu">max</span>(<span class="fu">c</span>(p_obs, p_lbspr), <span class="at">na.rm =</span> <span class="cn">TRUE</span>), </span>
<span id="cb6-114"><a href="#cb6-114" aria-hidden="true" tabindex="-1"></a>            <span class="at">std_mk =</span> <span class="fu">round</span>(<span class="fu">unique</span>(std_mk), <span class="dv">2</span>), </span>
<span id="cb6-115"><a href="#cb6-115" aria-hidden="true" tabindex="-1"></a>            <span class="at">std_linf =</span> <span class="fu">round</span>(<span class="fu">unique</span>(std_linf),<span class="dv">0</span>), </span>
<span id="cb6-116"><a href="#cb6-116" aria-hidden="true" tabindex="-1"></a>            <span class="at">.by =</span> species) </span>
<span id="cb6-117"><a href="#cb6-117" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-118"><a href="#cb6-118" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(arranged_species)){</span>
<span id="cb6-119"><a href="#cb6-119" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb6-120"><a href="#cb6-120" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span>(i<span class="sc">==</span><span class="dv">1</span>) {</span>
<span id="cb6-121"><a href="#cb6-121" aria-hidden="true" tabindex="-1"></a>    fig4_main <span class="ot">&lt;-</span> <span class="fu">make_fig4</span>(fig4_data, </span>
<span id="cb6-122"><a href="#cb6-122" aria-hidden="true" tabindex="-1"></a>                           <span class="at">spp_select =</span> arranged_species[i]) <span class="sc">+</span> </span>
<span id="cb6-123"><a href="#cb6-123" aria-hidden="true" tabindex="-1"></a>      <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"none"</span>)</span>
<span id="cb6-124"><a href="#cb6-124" aria-hidden="true" tabindex="-1"></a>  } <span class="cf">else</span> <span class="cf">if</span>(i <span class="sc">%in%</span> <span class="fu">c</span>(<span class="dv">6</span>,<span class="dv">7</span>)) {</span>
<span id="cb6-125"><a href="#cb6-125" aria-hidden="true" tabindex="-1"></a>    fig4_main <span class="ot">&lt;-</span> </span>
<span id="cb6-126"><a href="#cb6-126" aria-hidden="true" tabindex="-1"></a>      fig4_main <span class="sc">+</span> </span>
<span id="cb6-127"><a href="#cb6-127" aria-hidden="true" tabindex="-1"></a>      <span class="fu">make_fig4</span>(fig4_data, </span>
<span id="cb6-128"><a href="#cb6-128" aria-hidden="true" tabindex="-1"></a>                <span class="at">spp_select =</span> arranged_species[i]) <span class="sc">+</span> </span>
<span id="cb6-129"><a href="#cb6-129" aria-hidden="true" tabindex="-1"></a>      <span class="fu">theme</span>(<span class="at">axis.title.x =</span> <span class="fu">element_text</span>())</span>
<span id="cb6-130"><a href="#cb6-130" aria-hidden="true" tabindex="-1"></a>  } <span class="cf">else</span> <span class="cf">if</span>(i <span class="sc">==</span> <span class="fu">max</span>(<span class="fu">length</span>(arranged_species))) {</span>
<span id="cb6-131"><a href="#cb6-131" aria-hidden="true" tabindex="-1"></a>    fig4_main <span class="ot">&lt;-</span> </span>
<span id="cb6-132"><a href="#cb6-132" aria-hidden="true" tabindex="-1"></a>      fig4_main <span class="sc">+</span></span>
<span id="cb6-133"><a href="#cb6-133" aria-hidden="true" tabindex="-1"></a>      <span class="fu">make_fig4</span>(fig4_data, <span class="at">spp_select =</span> arranged_species[i]) <span class="sc">+</span> </span>
<span id="cb6-134"><a href="#cb6-134" aria-hidden="true" tabindex="-1"></a>      <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"bottom"</span>)</span>
<span id="cb6-135"><a href="#cb6-135" aria-hidden="true" tabindex="-1"></a>  } <span class="cf">else</span> {</span>
<span id="cb6-136"><a href="#cb6-136" aria-hidden="true" tabindex="-1"></a>    fig4_main <span class="ot">&lt;-</span> </span>
<span id="cb6-137"><a href="#cb6-137" aria-hidden="true" tabindex="-1"></a>      fig4_main <span class="sc">+</span> </span>
<span id="cb6-138"><a href="#cb6-138" aria-hidden="true" tabindex="-1"></a>      <span class="fu">make_fig4</span>(fig4_data, <span class="at">spp_select =</span> arranged_species[i]) <span class="sc">+</span> </span>
<span id="cb6-139"><a href="#cb6-139" aria-hidden="true" tabindex="-1"></a>      <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"none"</span>)</span>
<span id="cb6-140"><a href="#cb6-140" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb6-141"><a href="#cb6-141" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb6-142"><a href="#cb6-142" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb6-143"><a href="#cb6-143" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-144"><a href="#cb6-144" aria-hidden="true" tabindex="-1"></a>fig4_legend <span class="ot">&lt;-</span> </span>
<span id="cb6-145"><a href="#cb6-145" aria-hidden="true" tabindex="-1"></a>  {{<span class="fu">make_fig4</span>(fig4_data, </span>
<span id="cb6-146"><a href="#cb6-146" aria-hidden="true" tabindex="-1"></a>              <span class="at">spp_select =</span> arranged_species[i]) <span class="sc">+</span> </span>
<span id="cb6-147"><a href="#cb6-147" aria-hidden="true" tabindex="-1"></a>      <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"bottom"</span>, <span class="at">legend.title =</span> <span class="fu">element_blank</span>(), <span class="at">legend.justification =</span> <span class="fl">0.5</span>) } <span class="sc">%&gt;%</span> </span>
<span id="cb6-148"><a href="#cb6-148" aria-hidden="true" tabindex="-1"></a>      <span class="fu">get_legend</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb6-149"><a href="#cb6-149" aria-hidden="true" tabindex="-1"></a>      <span class="fu">as_ggplot</span>()}</span>
<span id="cb6-150"><a href="#cb6-150" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-151"><a href="#cb6-151" aria-hidden="true" tabindex="-1"></a>fig4 <span class="ot">&lt;-</span> </span>
<span id="cb6-152"><a href="#cb6-152" aria-hidden="true" tabindex="-1"></a>  fig4_main <span class="sc">+</span> </span>
<span id="cb6-153"><a href="#cb6-153" aria-hidden="true" tabindex="-1"></a>  fig4_violins <span class="sc">+</span> </span>
<span id="cb6-154"><a href="#cb6-154" aria-hidden="true" tabindex="-1"></a>  fig4_legend <span class="sc">+</span></span>
<span id="cb6-155"><a href="#cb6-155" aria-hidden="true" tabindex="-1"></a>  <span class="fu">plot_layout</span>(<span class="at">design =</span> </span>
<span id="cb6-156"><a href="#cb6-156" aria-hidden="true" tabindex="-1"></a>                <span class="st">"abc</span></span>
<span id="cb6-157"><a href="#cb6-157" aria-hidden="true" tabindex="-1"></a><span class="st">              deh</span></span>
<span id="cb6-158"><a href="#cb6-158" aria-hidden="true" tabindex="-1"></a><span class="st">              fgh</span></span>
<span id="cb6-159"><a href="#cb6-159" aria-hidden="true" tabindex="-1"></a><span class="st">              iii</span></span>
<span id="cb6-160"><a href="#cb6-160" aria-hidden="true" tabindex="-1"></a><span class="st">              "</span>, <span class="at">heights =</span> <span class="fu">c</span>(<span class="dv">4</span>,<span class="dv">4</span>,<span class="dv">4</span>,<span class="dv">1</span>)) <span class="sc">+</span></span>
<span id="cb6-161"><a href="#cb6-161" aria-hidden="true" tabindex="-1"></a>  <span class="fu">plot_annotation</span>(<span class="at">tag_levels =</span> <span class="st">"A"</span>)</span>
<span id="cb6-162"><a href="#cb6-162" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-163"><a href="#cb6-163" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-164"><a href="#cb6-164" aria-hidden="true" tabindex="-1"></a><span class="fu">ggsave</span>(<span class="at">filename =</span> <span class="st">"ms_figs/lbspr_comparison.png"</span>,</span>
<span id="cb6-165"><a href="#cb6-165" aria-hidden="true" tabindex="-1"></a>       <span class="at">plot =</span> fig4,</span>
<span id="cb6-166"><a href="#cb6-166" aria-hidden="true" tabindex="-1"></a>       <span class="at">height =</span> <span class="dv">20</span>,</span>
<span id="cb6-167"><a href="#cb6-167" aria-hidden="true" tabindex="-1"></a>       <span class="at">width =</span> <span class="dv">20</span><span class="sc">*</span><span class="fl">1.618</span>,</span>
<span id="cb6-168"><a href="#cb6-168" aria-hidden="true" tabindex="-1"></a>       <span class="at">units =</span> <span class="st">"cm"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="ms_figs/lbspr_comparison.png" class="img-fluid figure-img"></p>
<figcaption class="figure-caption">Simple one parameter model that assumes truncated normal distribution and CV = 0.34 matches observations similarly well or better than commonly used size-based methods with more parameters (LBSPR). Panels A-G shows observations (grey bars) and predictions (solid lines) for seven randomly selected (from 68 species with available life-history parameters). Predictions are shown for a simple method using truncated normal distribution (yellow) with a CV = 0.34 and from LBSPR using either empirically estimate M and k values from Prince et al.17 (red) or assuming a generic M/k ratio of 1.516. Panel H shows the dissimilarity (Kolmogorov-Smirnov statistic) between the prediction and the observed body size distribution for all 68 species using all size classes or removing individuals that may have observational sampling bias (less than 10cm in body length).</figcaption>
</figure>
</div>
</section>
<section id="si-figures" class="level1">
<h1>SI Figures</h1>
<section id="ed-fig.-1" class="level2">
<h2 class="anchored" data-anchor-id="ed-fig.-1">ED Fig. 1</h2>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a>logit_mod <span class="ot">&lt;-</span></span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a>  ED_fig1_data <span class="sc">%&gt;%</span> </span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">normal_better =</span> <span class="fu">as.numeric</span>(normal_better)) <span class="sc">%&gt;%</span> </span>
<span id="cb7-4"><a href="#cb7-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">glm</span>(normal_better <span class="sc">~</span> pop_mean_size, <span class="at">data =</span> ., <span class="at">family =</span> <span class="st">"binomial"</span>)</span>
<span id="cb7-5"><a href="#cb7-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-6"><a href="#cb7-6" aria-hidden="true" tabindex="-1"></a>logit_plot <span class="ot">&lt;-</span> </span>
<span id="cb7-7"><a href="#cb7-7" aria-hidden="true" tabindex="-1"></a>  ED_fig1_data <span class="sc">%&gt;%</span> </span>
<span id="cb7-8"><a href="#cb7-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(</span>
<span id="cb7-9"><a href="#cb7-9" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> pop_mean_size,</span>
<span id="cb7-10"><a href="#cb7-10" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span> normal_better <span class="sc">%&gt;%</span> as.numeric)) <span class="sc">+</span></span>
<span id="cb7-11"><a href="#cb7-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">alpha =</span> <span class="fl">0.3</span>, <span class="at">pch =</span> <span class="dv">3</span>, <span class="at">size =</span> <span class="dv">3</span>) <span class="sc">+</span></span>
<span id="cb7-12"><a href="#cb7-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">method =</span> <span class="st">"glm"</span>,</span>
<span id="cb7-13"><a href="#cb7-13" aria-hidden="true" tabindex="-1"></a>              <span class="at">method.args =</span> <span class="fu">list</span>(<span class="at">family =</span> <span class="st">"binomial"</span>),</span>
<span id="cb7-14"><a href="#cb7-14" aria-hidden="true" tabindex="-1"></a>              <span class="at">col =</span> <span class="st">"darkblue"</span>, <span class="at">fill =</span> <span class="st">"darkblue"</span>) <span class="sc">+</span></span>
<span id="cb7-15"><a href="#cb7-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">label =</span> <span class="fu">label_number</span>(<span class="at">suffix =</span> <span class="st">"cm"</span>)) <span class="sc">+</span></span>
<span id="cb7-16"><a href="#cb7-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_cowplot</span>(<span class="dv">20</span>) <span class="sc">+</span></span>
<span id="cb7-17"><a href="#cb7-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb7-18"><a href="#cb7-18" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> <span class="st">"Mean body length"</span>, </span>
<span id="cb7-19"><a href="#cb7-19" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span> <span class="st">"Probability Normal preferred"</span></span>
<span id="cb7-20"><a href="#cb7-20" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb7-21"><a href="#cb7-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-22"><a href="#cb7-22" aria-hidden="true" tabindex="-1"></a><span class="fu">ggsave</span>(<span class="at">filename =</span> <span class="st">"ms_figs/logistic.png"</span>,</span>
<span id="cb7-23"><a href="#cb7-23" aria-hidden="true" tabindex="-1"></a>       <span class="at">plot =</span> logit_plot,</span>
<span id="cb7-24"><a href="#cb7-24" aria-hidden="true" tabindex="-1"></a>       <span class="at">height =</span> <span class="dv">15</span>,</span>
<span id="cb7-25"><a href="#cb7-25" aria-hidden="true" tabindex="-1"></a>       <span class="at">width =</span> <span class="dv">15</span><span class="sc">*</span><span class="fl">1.618</span>,</span>
<span id="cb7-26"><a href="#cb7-26" aria-hidden="true" tabindex="-1"></a>       <span class="at">units =</span> <span class="st">"cm"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="ms_figs/logistic.png" class="img-fluid figure-img"></p>
<figcaption class="figure-caption">Populations with larger mean body lengths are usually better described by a truncated normal than a lognormal distribution. The blue line shows the logistic regression fit to the data. The populations include both visual census and cryptobenthic data.</figcaption>
</figure>
</div>
</section>
<section id="ed-fig.-2" class="level2">
<h2 class="anchored" data-anchor-id="ed-fig.-2">ED Fig. 2</h2>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a>p_binning <span class="ot">&lt;-</span> </span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a>  ED_fig2_data <span class="sc">%&gt;%</span></span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>() <span class="sc">+</span></span>
<span id="cb8-4"><a href="#cb8-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">aes</span>(</span>
<span id="cb8-5"><a href="#cb8-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> mean_size,</span>
<span id="cb8-6"><a href="#cb8-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">xend =</span> mean_size,</span>
<span id="cb8-7"><a href="#cb8-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span> cont,</span>
<span id="cb8-8"><a href="#cb8-8" aria-hidden="true" tabindex="-1"></a>    <span class="at">yend =</span> binned</span>
<span id="cb8-9"><a href="#cb8-9" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb8-10"><a href="#cb8-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> <span class="fu">median</span>(ED_fig2_data<span class="sc">$</span>binned, <span class="at">na.rm =</span> <span class="cn">TRUE</span>), <span class="at">lty =</span> <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb8-11"><a href="#cb8-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> <span class="fu">median</span>(ED_fig2_data<span class="sc">$</span>cont, <span class="at">na.rm =</span> <span class="cn">TRUE</span>), <span class="at">lty =</span> <span class="st">"35"</span>) <span class="sc">+</span></span>
<span id="cb8-12"><a href="#cb8-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_segment</span>(<span class="at">arrow =</span> <span class="fu">arrow</span>(<span class="at">length =</span> <span class="fu">unit</span>(<span class="fl">0.3</span>, <span class="st">"cm"</span>))) <span class="sc">+</span></span>
<span id="cb8-13"><a href="#cb8-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_log10</span>(<span class="at">label =</span> <span class="fu">label_number</span>(<span class="at">suffix =</span> <span class="st">"cm"</span>)) <span class="sc">+</span></span>
<span id="cb8-14"><a href="#cb8-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_cowplot</span>(<span class="dv">20</span>) <span class="sc">+</span></span>
<span id="cb8-15"><a href="#cb8-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"Mean body length (log)"</span>, </span>
<span id="cb8-16"><a href="#cb8-16" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">"CV value (before and after binning)"</span>)</span>
<span id="cb8-17"><a href="#cb8-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-18"><a href="#cb8-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-19"><a href="#cb8-19" aria-hidden="true" tabindex="-1"></a><span class="fu">ggsave</span>(<span class="at">filename =</span> <span class="st">"ms_figs/binning_effect.png"</span>,</span>
<span id="cb8-20"><a href="#cb8-20" aria-hidden="true" tabindex="-1"></a>       <span class="at">plot =</span> p_binning,</span>
<span id="cb8-21"><a href="#cb8-21" aria-hidden="true" tabindex="-1"></a>       <span class="at">height =</span> <span class="dv">15</span>,</span>
<span id="cb8-22"><a href="#cb8-22" aria-hidden="true" tabindex="-1"></a>       <span class="at">width =</span> <span class="dv">15</span><span class="sc">*</span><span class="fl">1.618</span>,</span>
<span id="cb8-23"><a href="#cb8-23" aria-hidden="true" tabindex="-1"></a>       <span class="at">units =</span> <span class="st">"cm"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p><img src="ms_figs/binning_effect.png" class="img-fluid" alt="Binning the cryptobenthic data (median CV = 0.23, dotted horizontal line) into visual census bins results in a greater median CV value (median CV = 0.28, solid horizontal line). Arrows represent the change from the CV value (either normal or lognormal) of the continuous data to the CV value of the binned data. Note: To be binned into the same visual census bins (2.5cm, 5cm, 7.5cm etc.), cryptobenthic body lengths were multiplied by a constant (constant = 3) before binning."> ## ED Fig. 3</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Must have run the functions in Figure 2</span></span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true" tabindex="-1"></a>plot_ylim <span class="ot">&lt;-</span> </span>
<span id="cb9-4"><a href="#cb9-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">max</span>(<span class="fu">layer_scales</span>(</span>
<span id="cb9-5"><a href="#cb9-5" aria-hidden="true" tabindex="-1"></a>    <span class="fu">main_plot</span>(ED_fig3_data))<span class="sc">$</span>y<span class="sc">$</span>range<span class="sc">$</span>range)</span>
<span id="cb9-6"><a href="#cb9-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-7"><a href="#cb9-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-8"><a href="#cb9-8" aria-hidden="true" tabindex="-1"></a>ppp <span class="ot">&lt;-</span> </span>
<span id="cb9-9"><a href="#cb9-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">main_plot</span>(ED_fig3_data) <span class="sc">+</span> </span>
<span id="cb9-10"><a href="#cb9-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.title.x =</span> <span class="fu">element_blank</span>()) <span class="sc">+</span></span>
<span id="cb9-11"><a href="#cb9-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylim</span>(<span class="dv">0</span>, plot_ylim) <span class="sc">+</span></span>
<span id="cb9-12"><a href="#cb9-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">annotate</span>(<span class="st">"text"</span>,</span>
<span id="cb9-13"><a href="#cb9-13" aria-hidden="true" tabindex="-1"></a>           <span class="at">x =</span> <span class="dv">1</span>, </span>
<span id="cb9-14"><a href="#cb9-14" aria-hidden="true" tabindex="-1"></a>           <span class="at">hjust =</span> <span class="dv">0</span>, </span>
<span id="cb9-15"><a href="#cb9-15" aria-hidden="true" tabindex="-1"></a>           <span class="at">y =</span> plot_ylim<span class="sc">*</span><span class="fl">0.95</span>,</span>
<span id="cb9-16"><a href="#cb9-16" aria-hidden="true" tabindex="-1"></a>           <span class="at">label =</span> <span class="st">"Ecoregion-level"</span>,</span>
<span id="cb9-17"><a href="#cb9-17" aria-hidden="true" tabindex="-1"></a>           <span class="at">size =</span> <span class="dv">10</span>) <span class="sc">+</span></span>
<span id="cb9-18"><a href="#cb9-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">side_plot</span>(ED_fig3_data <span class="sc">%&gt;%</span> <span class="fu">filter</span>(col <span class="sc">!=</span> <span class="st">"cbf_lnorm"</span>), </span>
<span id="cb9-19"><a href="#cb9-19" aria-hidden="true" tabindex="-1"></a>            plot_ylim)  <span class="sc">+</span></span>
<span id="cb9-20"><a href="#cb9-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">plot_layout</span>(<span class="at">design =</span> {<span class="st">"</span></span>
<span id="cb9-21"><a href="#cb9-21" aria-hidden="true" tabindex="-1"></a><span class="st">      AAAAAAB</span></span>
<span id="cb9-22"><a href="#cb9-22" aria-hidden="true" tabindex="-1"></a><span class="st">      AAAAAAB"</span></span>
<span id="cb9-23"><a href="#cb9-23" aria-hidden="true" tabindex="-1"></a>  })</span>
<span id="cb9-24"><a href="#cb9-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-25"><a href="#cb9-25" aria-hidden="true" tabindex="-1"></a>leg <span class="ot">&lt;-</span> </span>
<span id="cb9-26"><a href="#cb9-26" aria-hidden="true" tabindex="-1"></a>  ggpubr<span class="sc">::</span><span class="fu">as_ggplot</span>(</span>
<span id="cb9-27"><a href="#cb9-27" aria-hidden="true" tabindex="-1"></a>    <span class="fu">get_legend</span>(</span>
<span id="cb9-28"><a href="#cb9-28" aria-hidden="true" tabindex="-1"></a>      <span class="fu">main_plot</span>(ED_fig3_data) <span class="sc">+</span></span>
<span id="cb9-29"><a href="#cb9-29" aria-hidden="true" tabindex="-1"></a>        <span class="fu">theme</span>(<span class="at">axis.title =</span> <span class="fu">element_text</span>(), </span>
<span id="cb9-30"><a href="#cb9-30" aria-hidden="true" tabindex="-1"></a>              <span class="at">axis.text =</span> <span class="fu">element_text</span>()) <span class="sc">+</span></span>
<span id="cb9-31"><a href="#cb9-31" aria-hidden="true" tabindex="-1"></a>        <span class="fu">guides</span>(<span class="at">colour =</span> <span class="fu">guide_legend</span>(<span class="at">override.aes =</span> <span class="fu">list</span>(<span class="at">size=</span><span class="dv">5</span>, <span class="at">stroke =</span> <span class="dv">2</span>),</span>
<span id="cb9-32"><a href="#cb9-32" aria-hidden="true" tabindex="-1"></a>                                     <span class="at">nrow =</span> <span class="dv">2</span>,</span>
<span id="cb9-33"><a href="#cb9-33" aria-hidden="true" tabindex="-1"></a>                                     <span class="at">byrow =</span> <span class="cn">TRUE</span>,</span>
<span id="cb9-34"><a href="#cb9-34" aria-hidden="true" tabindex="-1"></a>                                     <span class="at">title =</span> <span class="fu">element_blank</span>()), </span>
<span id="cb9-35"><a href="#cb9-35" aria-hidden="true" tabindex="-1"></a>               <span class="at">pch =</span> <span class="fu">guide_legend</span>(<span class="at">nrow =</span> <span class="dv">2</span>,</span>
<span id="cb9-36"><a href="#cb9-36" aria-hidden="true" tabindex="-1"></a>                                  <span class="at">byrow =</span> <span class="cn">TRUE</span>,</span>
<span id="cb9-37"><a href="#cb9-37" aria-hidden="true" tabindex="-1"></a>                                  <span class="at">title =</span> <span class="fu">element_blank</span>())) <span class="sc">+</span></span>
<span id="cb9-38"><a href="#cb9-38" aria-hidden="true" tabindex="-1"></a>        <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"bottom"</span>, </span>
<span id="cb9-39"><a href="#cb9-39" aria-hidden="true" tabindex="-1"></a>              <span class="at">legend.box =</span> <span class="st">"vertical"</span>,</span>
<span id="cb9-40"><a href="#cb9-40" aria-hidden="true" tabindex="-1"></a>              <span class="at">legend.justification =</span> <span class="fu">c</span>(<span class="fl">0.5</span>,<span class="fl">0.5</span>),</span>
<span id="cb9-41"><a href="#cb9-41" aria-hidden="true" tabindex="-1"></a>              <span class="at">legend.background =</span> <span class="fu">element_rect</span>(<span class="at">color =</span> <span class="st">"black"</span>),</span>
<span id="cb9-42"><a href="#cb9-42" aria-hidden="true" tabindex="-1"></a>              <span class="at">legend.margin=</span><span class="fu">margin</span>(<span class="dv">5</span>,<span class="dv">5</span>,<span class="dv">5</span>,<span class="dv">6</span>),</span>
<span id="cb9-43"><a href="#cb9-43" aria-hidden="true" tabindex="-1"></a>              <span class="at">legend.title =</span> <span class="fu">element_text</span>()))) </span>
<span id="cb9-44"><a href="#cb9-44" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-45"><a href="#cb9-45" aria-hidden="true" tabindex="-1"></a>cc <span class="ot">&lt;-</span> </span>
<span id="cb9-46"><a href="#cb9-46" aria-hidden="true" tabindex="-1"></a>  <span class="fu">wrap_elements</span>(ppp) <span class="sc">+</span></span>
<span id="cb9-47"><a href="#cb9-47" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">tag =</span> <span class="st">"Coeffient of variation in body size"</span>) <span class="sc">+</span></span>
<span id="cb9-48"><a href="#cb9-48" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(</span>
<span id="cb9-49"><a href="#cb9-49" aria-hidden="true" tabindex="-1"></a>    <span class="at">plot.tag =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">20</span>, <span class="at">angle =</span> <span class="dv">90</span>),</span>
<span id="cb9-50"><a href="#cb9-50" aria-hidden="true" tabindex="-1"></a>    <span class="at">plot.tag.position =</span> <span class="st">"left"</span></span>
<span id="cb9-51"><a href="#cb9-51" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb9-52"><a href="#cb9-52" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-53"><a href="#cb9-53" aria-hidden="true" tabindex="-1"></a>p_simple <span class="ot">&lt;-</span> </span>
<span id="cb9-54"><a href="#cb9-54" aria-hidden="true" tabindex="-1"></a>  cc <span class="sc">+</span> </span>
<span id="cb9-55"><a href="#cb9-55" aria-hidden="true" tabindex="-1"></a>  leg <span class="sc">+</span></span>
<span id="cb9-56"><a href="#cb9-56" aria-hidden="true" tabindex="-1"></a>  <span class="fu">plot_layout</span>(<span class="at">design =</span> {<span class="st">"</span></span>
<span id="cb9-57"><a href="#cb9-57" aria-hidden="true" tabindex="-1"></a><span class="st">      AAAAAAA</span></span>
<span id="cb9-58"><a href="#cb9-58" aria-hidden="true" tabindex="-1"></a><span class="st">      AAAAAAA</span></span>
<span id="cb9-59"><a href="#cb9-59" aria-hidden="true" tabindex="-1"></a><span class="st">            #BBBBB#"</span></span>
<span id="cb9-60"><a href="#cb9-60" aria-hidden="true" tabindex="-1"></a>  })</span>
<span id="cb9-61"><a href="#cb9-61" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-62"><a href="#cb9-62" aria-hidden="true" tabindex="-1"></a><span class="fu">ggsave</span>(<span class="at">filename =</span> <span class="st">"ms_figs/meansize_cv_ecoregion.png"</span>,</span>
<span id="cb9-63"><a href="#cb9-63" aria-hidden="true" tabindex="-1"></a>       <span class="at">plot =</span> p_simple,</span>
<span id="cb9-64"><a href="#cb9-64" aria-hidden="true" tabindex="-1"></a>       <span class="at">height =</span> <span class="dv">15</span>,</span>
<span id="cb9-65"><a href="#cb9-65" aria-hidden="true" tabindex="-1"></a>       <span class="at">width =</span> <span class="dv">20</span><span class="sc">*</span><span class="fl">1.618</span>,</span>
<span id="cb9-66"><a href="#cb9-66" aria-hidden="true" tabindex="-1"></a>       <span class="at">units =</span> <span class="st">"cm"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="ms_figs/meansize_cv_ecoregion.png" class="img-fluid figure-img"></p>
<figcaption class="figure-caption">Relationship between population mean body length and CV at the ecoregion-level in the visual census data and location level in the cryptobenthic data. Fisheries-targeted species and distributions deemed to be bimodal have been excluded. The median CV value is 0.35, 80% of CV values fall in the range of 0.23 to 0.51 and 95% of the CV values fall in the range of 0.19 and 0.56.</figcaption>
</figure>
</div>
</section>
<section id="ed-fig.-4" class="level2">
<h2 class="anchored" data-anchor-id="ed-fig.-4">ED Fig. 4</h2>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a>inc_fished <span class="ot">&lt;-</span> <span class="cn">FALSE</span></span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a>inc_bimodal <span class="ot">&lt;-</span> <span class="cn">FALSE</span></span>
<span id="cb10-3"><a href="#cb10-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-4"><a href="#cb10-4" aria-hidden="true" tabindex="-1"></a>pop_data <span class="ot">&lt;-</span> </span>
<span id="cb10-5"><a href="#cb10-5" aria-hidden="true" tabindex="-1"></a>  fig2_data_pop <span class="sc">%&gt;%</span></span>
<span id="cb10-6"><a href="#cb10-6" aria-hidden="true" tabindex="-1"></a>  {<span class="cf">if</span>(inc_fished) . <span class="cf">else</span> <span class="fu">filter</span>(., <span class="sc">!</span>fished)} <span class="sc">%&gt;%</span> </span>
<span id="cb10-7"><a href="#cb10-7" aria-hidden="true" tabindex="-1"></a>  {<span class="cf">if</span>(inc_bimodal) . <span class="cf">else</span> <span class="fu">filter</span>(., <span class="sc">!</span>bimodal)} </span>
<span id="cb10-8"><a href="#cb10-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-9"><a href="#cb10-9" aria-hidden="true" tabindex="-1"></a>spp_data <span class="ot">&lt;-</span> </span>
<span id="cb10-10"><a href="#cb10-10" aria-hidden="true" tabindex="-1"></a>  fig2_data_spp <span class="sc">%&gt;%</span> </span>
<span id="cb10-11"><a href="#cb10-11" aria-hidden="true" tabindex="-1"></a>  {<span class="cf">if</span>(inc_fished) . <span class="cf">else</span> <span class="fu">filter</span>(., <span class="sc">!</span>fished)} <span class="sc">%&gt;%</span> </span>
<span id="cb10-12"><a href="#cb10-12" aria-hidden="true" tabindex="-1"></a>  {<span class="cf">if</span>(inc_bimodal) . <span class="cf">else</span> <span class="fu">filter</span>(., <span class="sc">!</span>bimodal)}</span>
<span id="cb10-13"><a href="#cb10-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-14"><a href="#cb10-14" aria-hidden="true" tabindex="-1"></a>plot_ylim <span class="ot">&lt;-</span> </span>
<span id="cb10-15"><a href="#cb10-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">max</span>(<span class="fu">layer_scales</span>(</span>
<span id="cb10-16"><a href="#cb10-16" aria-hidden="true" tabindex="-1"></a>    <span class="fu">main_plot</span>(pop_data))<span class="sc">$</span>y<span class="sc">$</span>range<span class="sc">$</span>range,</span>
<span id="cb10-17"><a href="#cb10-17" aria-hidden="true" tabindex="-1"></a>    <span class="fu">layer_scales</span>(</span>
<span id="cb10-18"><a href="#cb10-18" aria-hidden="true" tabindex="-1"></a>      <span class="fu">main_plot</span>(spp_data))<span class="sc">$</span>y<span class="sc">$</span>range<span class="sc">$</span>range)</span>
<span id="cb10-19"><a href="#cb10-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-20"><a href="#cb10-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-21"><a href="#cb10-21" aria-hidden="true" tabindex="-1"></a>ED_fig4_main <span class="ot">&lt;-</span> </span>
<span id="cb10-22"><a href="#cb10-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">main_plot</span>(pop_data) <span class="sc">+</span> </span>
<span id="cb10-23"><a href="#cb10-23" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.title.x =</span> <span class="fu">element_blank</span>()) <span class="sc">+</span></span>
<span id="cb10-24"><a href="#cb10-24" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylim</span>(<span class="dv">0</span>, plot_ylim) <span class="sc">+</span></span>
<span id="cb10-25"><a href="#cb10-25" aria-hidden="true" tabindex="-1"></a>  <span class="fu">annotate</span>(<span class="st">"text"</span>,</span>
<span id="cb10-26"><a href="#cb10-26" aria-hidden="true" tabindex="-1"></a>           <span class="at">x =</span> <span class="dv">1</span>, </span>
<span id="cb10-27"><a href="#cb10-27" aria-hidden="true" tabindex="-1"></a>           <span class="at">hjust =</span> <span class="dv">0</span>, </span>
<span id="cb10-28"><a href="#cb10-28" aria-hidden="true" tabindex="-1"></a>           <span class="at">y =</span> plot_ylim<span class="sc">*</span><span class="fl">0.95</span>,</span>
<span id="cb10-29"><a href="#cb10-29" aria-hidden="true" tabindex="-1"></a>           <span class="at">label =</span> <span class="st">"Population-level"</span>,</span>
<span id="cb10-30"><a href="#cb10-30" aria-hidden="true" tabindex="-1"></a>           <span class="at">size =</span> <span class="dv">10</span>) <span class="sc">+</span></span>
<span id="cb10-31"><a href="#cb10-31" aria-hidden="true" tabindex="-1"></a>  <span class="fu">side_plot</span>(pop_data <span class="sc">%&gt;%</span> </span>
<span id="cb10-32"><a href="#cb10-32" aria-hidden="true" tabindex="-1"></a>              <span class="fu">filter</span>(col <span class="sc">!=</span> <span class="st">"cbf_lnorm"</span>), </span>
<span id="cb10-33"><a href="#cb10-33" aria-hidden="true" tabindex="-1"></a>            plot_ylim) <span class="sc">+</span> </span>
<span id="cb10-34"><a href="#cb10-34" aria-hidden="true" tabindex="-1"></a>  <span class="fu">main_plot</span>(spp_data) <span class="sc">+</span> <span class="fu">ylim</span>(<span class="dv">0</span>, plot_ylim) <span class="sc">+</span></span>
<span id="cb10-35"><a href="#cb10-35" aria-hidden="true" tabindex="-1"></a>  <span class="fu">annotate</span>(<span class="st">"text"</span>, </span>
<span id="cb10-36"><a href="#cb10-36" aria-hidden="true" tabindex="-1"></a>           <span class="at">x =</span> <span class="dv">1</span>, </span>
<span id="cb10-37"><a href="#cb10-37" aria-hidden="true" tabindex="-1"></a>           <span class="at">hjust =</span> <span class="dv">0</span>, </span>
<span id="cb10-38"><a href="#cb10-38" aria-hidden="true" tabindex="-1"></a>           <span class="at">y =</span> plot_ylim<span class="sc">*</span><span class="fl">0.95</span>,</span>
<span id="cb10-39"><a href="#cb10-39" aria-hidden="true" tabindex="-1"></a>           <span class="at">label =</span> <span class="st">"Species-level"</span>,</span>
<span id="cb10-40"><a href="#cb10-40" aria-hidden="true" tabindex="-1"></a>           <span class="at">size =</span> <span class="dv">10</span>) <span class="sc">+</span></span>
<span id="cb10-41"><a href="#cb10-41" aria-hidden="true" tabindex="-1"></a>  <span class="fu">side_plot</span>(spp_data <span class="sc">%&gt;%</span> <span class="fu">filter</span>(col <span class="sc">!=</span> <span class="st">"cbf_lnorm"</span>), </span>
<span id="cb10-42"><a href="#cb10-42" aria-hidden="true" tabindex="-1"></a>            plot_ylim)  <span class="sc">+</span></span>
<span id="cb10-43"><a href="#cb10-43" aria-hidden="true" tabindex="-1"></a>  <span class="fu">plot_layout</span>(<span class="at">design =</span> {<span class="st">"</span></span>
<span id="cb10-44"><a href="#cb10-44" aria-hidden="true" tabindex="-1"></a><span class="st">      AAAAAAB</span></span>
<span id="cb10-45"><a href="#cb10-45" aria-hidden="true" tabindex="-1"></a><span class="st">      AAAAAAB</span></span>
<span id="cb10-46"><a href="#cb10-46" aria-hidden="true" tabindex="-1"></a><span class="st">      CCCCCCD</span></span>
<span id="cb10-47"><a href="#cb10-47" aria-hidden="true" tabindex="-1"></a><span class="st">      CCCCCCD"</span></span>
<span id="cb10-48"><a href="#cb10-48" aria-hidden="true" tabindex="-1"></a>  })</span>
<span id="cb10-49"><a href="#cb10-49" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-50"><a href="#cb10-50" aria-hidden="true" tabindex="-1"></a>ED_fig4_legend <span class="ot">&lt;-</span></span>
<span id="cb10-51"><a href="#cb10-51" aria-hidden="true" tabindex="-1"></a>  ggpubr<span class="sc">::</span><span class="fu">as_ggplot</span>(</span>
<span id="cb10-52"><a href="#cb10-52" aria-hidden="true" tabindex="-1"></a>    ggpubr<span class="sc">::</span><span class="fu">get_legend</span>(</span>
<span id="cb10-53"><a href="#cb10-53" aria-hidden="true" tabindex="-1"></a>      <span class="fu">main_plot</span>(pop_data) <span class="sc">+</span></span>
<span id="cb10-54"><a href="#cb10-54" aria-hidden="true" tabindex="-1"></a>        <span class="fu">theme</span>(<span class="at">axis.title =</span> <span class="fu">element_text</span>(), </span>
<span id="cb10-55"><a href="#cb10-55" aria-hidden="true" tabindex="-1"></a>              <span class="at">axis.text =</span> <span class="fu">element_text</span>()) <span class="sc">+</span></span>
<span id="cb10-56"><a href="#cb10-56" aria-hidden="true" tabindex="-1"></a>        <span class="fu">guides</span>(<span class="at">colour =</span> <span class="fu">guide_legend</span>(<span class="at">override.aes =</span> <span class="fu">list</span>(<span class="at">size=</span><span class="dv">5</span>, <span class="at">stroke =</span> <span class="dv">2</span>),</span>
<span id="cb10-57"><a href="#cb10-57" aria-hidden="true" tabindex="-1"></a>                                     <span class="at">nrow =</span> <span class="dv">2</span>,</span>
<span id="cb10-58"><a href="#cb10-58" aria-hidden="true" tabindex="-1"></a>                                     <span class="at">byrow =</span> <span class="cn">TRUE</span>,</span>
<span id="cb10-59"><a href="#cb10-59" aria-hidden="true" tabindex="-1"></a>                                     <span class="at">title =</span> <span class="fu">element_blank</span>()), </span>
<span id="cb10-60"><a href="#cb10-60" aria-hidden="true" tabindex="-1"></a>               <span class="at">pch =</span> <span class="fu">guide_legend</span>(<span class="at">nrow =</span> <span class="dv">2</span>,</span>
<span id="cb10-61"><a href="#cb10-61" aria-hidden="true" tabindex="-1"></a>                                  <span class="at">byrow =</span> <span class="cn">TRUE</span>,</span>
<span id="cb10-62"><a href="#cb10-62" aria-hidden="true" tabindex="-1"></a>                                  <span class="at">title =</span> <span class="fu">element_blank</span>())) <span class="sc">+</span></span>
<span id="cb10-63"><a href="#cb10-63" aria-hidden="true" tabindex="-1"></a>        <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"bottom"</span>, </span>
<span id="cb10-64"><a href="#cb10-64" aria-hidden="true" tabindex="-1"></a>              <span class="at">legend.box =</span> <span class="st">"vertical"</span>,</span>
<span id="cb10-65"><a href="#cb10-65" aria-hidden="true" tabindex="-1"></a>              <span class="at">legend.justification =</span> <span class="fu">c</span>(<span class="fl">0.5</span>,<span class="fl">0.5</span>),</span>
<span id="cb10-66"><a href="#cb10-66" aria-hidden="true" tabindex="-1"></a>              <span class="at">legend.background =</span> <span class="fu">element_rect</span>(<span class="at">color =</span> <span class="st">"black"</span>),</span>
<span id="cb10-67"><a href="#cb10-67" aria-hidden="true" tabindex="-1"></a>              <span class="at">legend.margin=</span><span class="fu">margin</span>(<span class="dv">5</span>,<span class="dv">5</span>,<span class="dv">5</span>,<span class="dv">6</span>),</span>
<span id="cb10-68"><a href="#cb10-68" aria-hidden="true" tabindex="-1"></a>              <span class="at">legend.title =</span> <span class="fu">element_text</span>()), </span>
<span id="cb10-69"><a href="#cb10-69" aria-hidden="true" tabindex="-1"></a>      </span>
<span id="cb10-70"><a href="#cb10-70" aria-hidden="true" tabindex="-1"></a>    )) </span>
<span id="cb10-71"><a href="#cb10-71" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-72"><a href="#cb10-72" aria-hidden="true" tabindex="-1"></a>ED_fig4_yaxis <span class="ot">&lt;-</span> </span>
<span id="cb10-73"><a href="#cb10-73" aria-hidden="true" tabindex="-1"></a>  <span class="fu">wrap_elements</span>(ED_fig4_main) <span class="sc">+</span></span>
<span id="cb10-74"><a href="#cb10-74" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">tag =</span> <span class="st">"Coeffient of variation in body size"</span>) <span class="sc">+</span></span>
<span id="cb10-75"><a href="#cb10-75" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(</span>
<span id="cb10-76"><a href="#cb10-76" aria-hidden="true" tabindex="-1"></a>    <span class="at">plot.tag =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">20</span>, <span class="at">angle =</span> <span class="dv">90</span>),</span>
<span id="cb10-77"><a href="#cb10-77" aria-hidden="true" tabindex="-1"></a>    <span class="at">plot.tag.position =</span> <span class="st">"left"</span></span>
<span id="cb10-78"><a href="#cb10-78" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb10-79"><a href="#cb10-79" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-80"><a href="#cb10-80" aria-hidden="true" tabindex="-1"></a>ED_fig4 <span class="ot">&lt;-</span> </span>
<span id="cb10-81"><a href="#cb10-81" aria-hidden="true" tabindex="-1"></a>  ED_fig4_yaxis <span class="sc">+</span> </span>
<span id="cb10-82"><a href="#cb10-82" aria-hidden="true" tabindex="-1"></a>  ED_fig4_legend <span class="sc">+</span></span>
<span id="cb10-83"><a href="#cb10-83" aria-hidden="true" tabindex="-1"></a>  <span class="fu">plot_layout</span>(<span class="at">design =</span> {<span class="st">"</span></span>
<span id="cb10-84"><a href="#cb10-84" aria-hidden="true" tabindex="-1"></a><span class="st">      AAAAAAA</span></span>
<span id="cb10-85"><a href="#cb10-85" aria-hidden="true" tabindex="-1"></a><span class="st">      AAAAAAA</span></span>
<span id="cb10-86"><a href="#cb10-86" aria-hidden="true" tabindex="-1"></a><span class="st">      AAAAAAA</span></span>
<span id="cb10-87"><a href="#cb10-87" aria-hidden="true" tabindex="-1"></a><span class="st">      AAAAAAA</span></span>
<span id="cb10-88"><a href="#cb10-88" aria-hidden="true" tabindex="-1"></a><span class="st">            #BBBBB#"</span></span>
<span id="cb10-89"><a href="#cb10-89" aria-hidden="true" tabindex="-1"></a>  })</span>
<span id="cb10-90"><a href="#cb10-90" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-91"><a href="#cb10-91" aria-hidden="true" tabindex="-1"></a><span class="fu">ggsave</span>(<span class="at">filename =</span> <span class="st">"ms_figs/cv_meansize_rmfished.png"</span>,</span>
<span id="cb10-92"><a href="#cb10-92" aria-hidden="true" tabindex="-1"></a>       <span class="at">plot =</span> ED_fig4,</span>
<span id="cb10-93"><a href="#cb10-93" aria-hidden="true" tabindex="-1"></a>       <span class="at">height =</span> <span class="dv">20</span>,</span>
<span id="cb10-94"><a href="#cb10-94" aria-hidden="true" tabindex="-1"></a>       <span class="at">width =</span> <span class="dv">20</span><span class="sc">*</span><span class="fl">1.618</span>,</span>
<span id="cb10-95"><a href="#cb10-95" aria-hidden="true" tabindex="-1"></a>       <span class="at">units =</span> <span class="st">"cm"</span>, </span>
<span id="cb10-96"><a href="#cb10-96" aria-hidden="true" tabindex="-1"></a>       <span class="at">create.dir =</span> <span class="cn">TRUE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="ms_figs/cv_meansize_rmfished.png" class="img-fluid figure-img"></p>
<figcaption class="figure-caption">Reconstruction of Fig. 2 of the main text but excluding species and genera that are potentially targeted by fishing. Excluding these species has almost no influence on the estimate of CV. At the population level the median CV value is 0.34, 80% of CV values fall in the range of 0.22 to 0.51 and 95% of the CV values fall in the range of 0.19 and 0.55. At the species-level the median CV value is 0.35, 80% of CV values fall in the range of 0.22 to 0.50 and 95% of the CV values fall in the range of 0.17 and 0.56.</figcaption>
</figure>
</div>
</section>
<section id="ed-fig.-5" class="level2">
<h2 class="anchored" data-anchor-id="ed-fig.-5">ED Fig. 5</h2>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a>bimod_plot <span class="ot">&lt;-</span> <span class="cf">function</span>(data, nrow, fill_col){</span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(data) <span class="sc">+</span></span>
<span id="cb11-3"><a href="#cb11-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_rect</span>(<span class="fu">aes</span>(</span>
<span id="cb11-4"><a href="#cb11-4" aria-hidden="true" tabindex="-1"></a>      <span class="at">xmin =</span> size_min,</span>
<span id="cb11-5"><a href="#cb11-5" aria-hidden="true" tabindex="-1"></a>      <span class="at">xmax =</span> size_max,</span>
<span id="cb11-6"><a href="#cb11-6" aria-hidden="true" tabindex="-1"></a>      <span class="at">ymax =</span> n, </span>
<span id="cb11-7"><a href="#cb11-7" aria-hidden="true" tabindex="-1"></a>      <span class="at">ymin =</span> <span class="dv">0</span></span>
<span id="cb11-8"><a href="#cb11-8" aria-hidden="true" tabindex="-1"></a>    ), <span class="at">fill =</span> fill_col, </span>
<span id="cb11-9"><a href="#cb11-9" aria-hidden="true" tabindex="-1"></a>    <span class="at">col =</span> <span class="st">"black"</span>) <span class="sc">+</span></span>
<span id="cb11-10"><a href="#cb11-10" aria-hidden="true" tabindex="-1"></a>    <span class="fu">facet_wrap</span>(<span class="sc">~</span>pop_label, </span>
<span id="cb11-11"><a href="#cb11-11" aria-hidden="true" tabindex="-1"></a>               <span class="at">nrow =</span> nrow,</span>
<span id="cb11-12"><a href="#cb11-12" aria-hidden="true" tabindex="-1"></a>               <span class="at">scales =</span> <span class="st">"free_y"</span>) <span class="sc">+</span> </span>
<span id="cb11-13"><a href="#cb11-13" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_x_continuous</span>(<span class="at">labels =</span> <span class="fu">label_number</span>(<span class="at">suffix =</span> <span class="st">"cm"</span>)) <span class="sc">+</span></span>
<span id="cb11-14"><a href="#cb11-14" aria-hidden="true" tabindex="-1"></a>    <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"Body length class"</span>, </span>
<span id="cb11-15"><a href="#cb11-15" aria-hidden="true" tabindex="-1"></a>         <span class="at">y =</span> <span class="st">"Count"</span>) <span class="sc">+</span></span>
<span id="cb11-16"><a href="#cb11-16" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme_cowplot</span>() <span class="sc">+</span></span>
<span id="cb11-17"><a href="#cb11-17" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme</span>(<span class="at">strip.background =</span> <span class="fu">element_rect</span>(<span class="at">fill =</span> <span class="st">"white"</span>, <span class="at">colour =</span> <span class="st">"black"</span>), </span>
<span id="cb11-18"><a href="#cb11-18" aria-hidden="true" tabindex="-1"></a>          <span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">hjust =</span> <span class="fl">0.5</span>)) </span>
<span id="cb11-19"><a href="#cb11-19" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb11-20"><a href="#cb11-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-21"><a href="#cb11-21" aria-hidden="true" tabindex="-1"></a>p1 <span class="ot">&lt;-</span> </span>
<span id="cb11-22"><a href="#cb11-22" aria-hidden="true" tabindex="-1"></a>  ED_fig5_data <span class="sc">%&gt;%</span> </span>
<span id="cb11-23"><a href="#cb11-23" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(data <span class="sc">==</span> <span class="st">"rls"</span>, <span class="sc">!</span>is_bimodal) <span class="sc">%&gt;%</span> </span>
<span id="cb11-24"><a href="#cb11-24" aria-hidden="true" tabindex="-1"></a>  <span class="fu">bimod_plot</span>(<span class="at">nrow =</span> <span class="dv">4</span>, </span>
<span id="cb11-25"><a href="#cb11-25" aria-hidden="true" tabindex="-1"></a>             <span class="at">fill_col =</span> <span class="st">"#56B4E9"</span>) <span class="sc">+</span> </span>
<span id="cb11-26"><a href="#cb11-26" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">"Unimodal examples (n = 4 of 3,169)"</span>)</span>
<span id="cb11-27"><a href="#cb11-27" aria-hidden="true" tabindex="-1"></a>p2 <span class="ot">&lt;-</span> </span>
<span id="cb11-28"><a href="#cb11-28" aria-hidden="true" tabindex="-1"></a>  ED_fig5_data <span class="sc">%&gt;%</span> </span>
<span id="cb11-29"><a href="#cb11-29" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(data <span class="sc">==</span> <span class="st">"rls"</span>, is_bimodal) <span class="sc">%&gt;%</span> </span>
<span id="cb11-30"><a href="#cb11-30" aria-hidden="true" tabindex="-1"></a>  <span class="fu">bimod_plot</span>(<span class="at">nrow =</span> <span class="dv">4</span>, </span>
<span id="cb11-31"><a href="#cb11-31" aria-hidden="true" tabindex="-1"></a>             <span class="at">fill_col =</span> <span class="st">"#56B4E9"</span>)  <span class="sc">+</span> </span>
<span id="cb11-32"><a href="#cb11-32" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">"Bimodal examples (n = 4 of 59)"</span>)</span>
<span id="cb11-33"><a href="#cb11-33" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-34"><a href="#cb11-34" aria-hidden="true" tabindex="-1"></a>p3 <span class="ot">&lt;-</span> </span>
<span id="cb11-35"><a href="#cb11-35" aria-hidden="true" tabindex="-1"></a>  ED_fig5_data <span class="sc">%&gt;%</span> </span>
<span id="cb11-36"><a href="#cb11-36" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(data <span class="sc">==</span> <span class="st">"cbf"</span>, <span class="sc">!</span>is_bimodal) <span class="sc">%&gt;%</span> </span>
<span id="cb11-37"><a href="#cb11-37" aria-hidden="true" tabindex="-1"></a>  <span class="fu">bimod_plot</span>(<span class="at">nrow =</span> <span class="dv">3</span>, </span>
<span id="cb11-38"><a href="#cb11-38" aria-hidden="true" tabindex="-1"></a>             <span class="at">fill_col =</span> <span class="st">"#E69F00"</span>) <span class="sc">+</span></span>
<span id="cb11-39"><a href="#cb11-39" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">"Unimodal examples (n = 3 of 133)"</span>)</span>
<span id="cb11-40"><a href="#cb11-40" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-41"><a href="#cb11-41" aria-hidden="true" tabindex="-1"></a>p4 <span class="ot">&lt;-</span>   ED_fig5_data <span class="sc">%&gt;%</span> </span>
<span id="cb11-42"><a href="#cb11-42" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(data <span class="sc">==</span> <span class="st">"cbf"</span>, is_bimodal) <span class="sc">%&gt;%</span> </span>
<span id="cb11-43"><a href="#cb11-43" aria-hidden="true" tabindex="-1"></a>  <span class="fu">bimod_plot</span>(<span class="at">nrow =</span> <span class="dv">3</span>, </span>
<span id="cb11-44"><a href="#cb11-44" aria-hidden="true" tabindex="-1"></a>             <span class="at">fill_col =</span> <span class="st">"#E69F00"</span>)  <span class="sc">+</span></span>
<span id="cb11-45"><a href="#cb11-45" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">"Bimodal distributions (n = 3 of 3)"</span>)</span>
<span id="cb11-46"><a href="#cb11-46" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-47"><a href="#cb11-47" aria-hidden="true" tabindex="-1"></a>bimod_dists <span class="ot">&lt;-</span> </span>
<span id="cb11-48"><a href="#cb11-48" aria-hidden="true" tabindex="-1"></a>  p1 <span class="sc">+</span></span>
<span id="cb11-49"><a href="#cb11-49" aria-hidden="true" tabindex="-1"></a>  p2 <span class="sc">+</span> </span>
<span id="cb11-50"><a href="#cb11-50" aria-hidden="true" tabindex="-1"></a>  p3 <span class="sc">+</span> </span>
<span id="cb11-51"><a href="#cb11-51" aria-hidden="true" tabindex="-1"></a>  p4 <span class="sc">+</span> </span>
<span id="cb11-52"><a href="#cb11-52" aria-hidden="true" tabindex="-1"></a>  <span class="fu">plot_layout</span>(<span class="at">ncol=</span> <span class="dv">2</span>) <span class="sc">+</span></span>
<span id="cb11-53"><a href="#cb11-53" aria-hidden="true" tabindex="-1"></a>  <span class="fu">plot_annotation</span>(<span class="at">tag_levels =</span> <span class="st">"A"</span>)</span>
<span id="cb11-54"><a href="#cb11-54" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-55"><a href="#cb11-55" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-56"><a href="#cb11-56" aria-hidden="true" tabindex="-1"></a><span class="fu">ggsave</span>(<span class="at">filename =</span> <span class="st">"ms_figs/bimodal.png"</span>, </span>
<span id="cb11-57"><a href="#cb11-57" aria-hidden="true" tabindex="-1"></a>       <span class="at">plot =</span> bimod_dists, </span>
<span id="cb11-58"><a href="#cb11-58" aria-hidden="true" tabindex="-1"></a>       <span class="at">height =</span> <span class="dv">20</span>, </span>
<span id="cb11-59"><a href="#cb11-59" aria-hidden="true" tabindex="-1"></a>       <span class="at">width =</span> <span class="dv">15</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="ms_figs/bimodal.png" class="img-fluid figure-img"></p>
<figcaption class="figure-caption">Randomly selected examples of approximately unimodal (A, C) and bimodal (B, D) observed body length distributions in visual census sampling (blue, A, B) and cryptobenthic sampling (orange, C, D). Approximately bimodal shapes were found in 59 out of 3,089 (2%) of visual census, and 3 of 136 (2%) cryptobenthic population-level datasets. Bimodal distributions were removed from distribution-fitting analyses.</figcaption>
</figure>
</div>
</section>
<section id="ed-fig.-6" class="level2">
<h2 class="anchored" data-anchor-id="ed-fig.-6">ED Fig. 6</h2>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a>ED_fig6 <span class="ot">&lt;-</span> </span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a>  fig2_data_spp <span class="sc">%&gt;%</span> </span>
<span id="cb12-3"><a href="#cb12-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span>bimodal) <span class="sc">%&gt;%</span> </span>
<span id="cb12-4"><a href="#cb12-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>() <span class="sc">+</span> </span>
<span id="cb12-5"><a href="#cb12-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">aes</span>(</span>
<span id="cb12-6"><a href="#cb12-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> mean_size, </span>
<span id="cb12-7"><a href="#cb12-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span> cov_pref, </span>
<span id="cb12-8"><a href="#cb12-8" aria-hidden="true" tabindex="-1"></a>    <span class="at">pch =</span> dat,</span>
<span id="cb12-9"><a href="#cb12-9" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb12-10"><a href="#cb12-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">alpha =</span> <span class="dv">1</span>, <span class="at">size =</span> <span class="dv">2</span>, <span class="at">col =</span> <span class="st">"grey80"</span>) <span class="sc">+</span></span>
<span id="cb12-11"><a href="#cb12-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">alpha =</span> <span class="dv">1</span>, <span class="at">size =</span> <span class="dv">2</span>, <span class="at">col=</span><span class="st">"black"</span>,</span>
<span id="cb12-12"><a href="#cb12-12" aria-hidden="true" tabindex="-1"></a>             <span class="at">data =</span> fig2_data_spp <span class="sc">%&gt;%</span> </span>
<span id="cb12-13"><a href="#cb12-13" aria-hidden="true" tabindex="-1"></a>               <span class="fu">filter</span>(species <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">"Scorpis aequipinnis"</span>, </span>
<span id="cb12-14"><a href="#cb12-14" aria-hidden="true" tabindex="-1"></a>                                     <span class="st">"Cheilodactylus spectabilis"</span>))) <span class="sc">+</span></span>
<span id="cb12-15"><a href="#cb12-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">alpha =</span> <span class="fl">0.4</span>, <span class="at">size =</span> <span class="dv">2</span>, <span class="at">col=</span><span class="st">"red"</span>, </span>
<span id="cb12-16"><a href="#cb12-16" aria-hidden="true" tabindex="-1"></a>             <span class="at">data =</span> fig2_data_spp <span class="sc">%&gt;%</span> </span>
<span id="cb12-17"><a href="#cb12-17" aria-hidden="true" tabindex="-1"></a>               <span class="fu">filter</span>(<span class="fu">str_detect</span>(species, <span class="st">"Eviota"</span>))) <span class="sc">+</span></span>
<span id="cb12-18"><a href="#cb12-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">alpha =</span> <span class="dv">1</span>, <span class="at">size =</span> <span class="dv">2</span>, <span class="at">col=</span><span class="st">"red"</span>,</span>
<span id="cb12-19"><a href="#cb12-19" aria-hidden="true" tabindex="-1"></a>             <span class="at">data =</span> fig2_data_spp <span class="sc">%&gt;%</span> </span>
<span id="cb12-20"><a href="#cb12-20" aria-hidden="true" tabindex="-1"></a>               <span class="fu">filter</span>(<span class="fu">str_detect</span>(species, <span class="st">"Eviota queenslandica"</span>))) <span class="sc">+</span></span>
<span id="cb12-21"><a href="#cb12-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">trans =</span> <span class="st">"log10"</span>, </span>
<span id="cb12-22"><a href="#cb12-22" aria-hidden="true" tabindex="-1"></a>                     <span class="at">labels =</span> <span class="fu">label_number</span>(<span class="at">suffix=</span><span class="st">"cm"</span>)) <span class="sc">+</span></span>
<span id="cb12-23"><a href="#cb12-23" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_shape_manual</span>(</span>
<span id="cb12-24"><a href="#cb12-24" aria-hidden="true" tabindex="-1"></a>    <span class="at">values =</span> <span class="fu">c</span>(<span class="st">"rls"</span> <span class="ot">=</span> <span class="dv">21</span>, <span class="st">"cbf"</span> <span class="ot">=</span> <span class="dv">24</span>), </span>
<span id="cb12-25"><a href="#cb12-25" aria-hidden="true" tabindex="-1"></a>    <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"rls"</span> <span class="ot">=</span> <span class="st">"Visual census"</span>,</span>
<span id="cb12-26"><a href="#cb12-26" aria-hidden="true" tabindex="-1"></a>               <span class="st">"cbf"</span> <span class="ot">=</span> <span class="st">"Cryptobenthic (exhaustive)"</span>)) <span class="sc">+</span></span>
<span id="cb12-27"><a href="#cb12-27" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(</span>
<span id="cb12-28"><a href="#cb12-28" aria-hidden="true" tabindex="-1"></a>    <span class="at">values =</span> <span class="fu">c</span>(<span class="st">"normal"</span> <span class="ot">=</span> <span class="fu">rgb</span>(<span class="dv">181</span>, <span class="dv">144</span>, <span class="dv">19</span>, <span class="at">maxColorValue=</span><span class="dv">255</span>),</span>
<span id="cb12-29"><a href="#cb12-29" aria-hidden="true" tabindex="-1"></a>               <span class="st">"lognormal"</span> <span class="ot">=</span> <span class="fu">rgb</span>(<span class="dv">29</span>, <span class="dv">84</span>, <span class="dv">128</span>, <span class="at">maxColorValue=</span><span class="dv">255</span>)),</span>
<span id="cb12-30"><a href="#cb12-30" aria-hidden="true" tabindex="-1"></a>    <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"normal"</span> <span class="ot">=</span> <span class="st">"Normal preferred"</span>,</span>
<span id="cb12-31"><a href="#cb12-31" aria-hidden="true" tabindex="-1"></a>               <span class="st">"lognormal"</span> <span class="ot">=</span> <span class="st">"Lognormal preferred"</span>)) <span class="sc">+</span></span>
<span id="cb12-32"><a href="#cb12-32" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"Mean body size (log)"</span>, </span>
<span id="cb12-33"><a href="#cb12-33" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">"Coefficient of variation in body size"</span>) <span class="sc">+</span></span>
<span id="cb12-34"><a href="#cb12-34" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb12-35"><a href="#cb12-35" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_cowplot</span>(<span class="dv">20</span>) <span class="sc">+</span></span>
<span id="cb12-36"><a href="#cb12-36" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"none"</span>) </span>
<span id="cb12-37"><a href="#cb12-37" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-38"><a href="#cb12-38" aria-hidden="true" tabindex="-1"></a><span class="fu">ggsave</span>(<span class="at">filename =</span> <span class="st">"ms_figs/cv_meansize_spphighlight.png"</span>,</span>
<span id="cb12-39"><a href="#cb12-39" aria-hidden="true" tabindex="-1"></a>       <span class="at">plot =</span> ED_fig6,</span>
<span id="cb12-40"><a href="#cb12-40" aria-hidden="true" tabindex="-1"></a>       <span class="at">height =</span> <span class="dv">20</span>,</span>
<span id="cb12-41"><a href="#cb12-41" aria-hidden="true" tabindex="-1"></a>       <span class="at">width =</span> <span class="dv">20</span><span class="sc">*</span><span class="fl">1.618</span>,</span>
<span id="cb12-42"><a href="#cb12-42" aria-hidden="true" tabindex="-1"></a>       <span class="at">units =</span> <span class="st">"cm"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="ms_figs/cv_meansize_spphighlight.png" class="img-fluid figure-img"></p>
<figcaption class="figure-caption">Relationship between mean body length and coefficient of variation (CV), highlighting three species with known extreme life-histories. The two species in black text are known to be long-lived, slow growing species (<em>Scorpis aequipinus</em> and <em>Chirodactylus spectabilis</em>), yet their CV values fall in the center of the of the distribution of CV values. On the other hand, <em>Eviota</em> spp. and in particular, <em>E. queenslandica</em>, are known to be fast-growing and short-lived. <em>Eviota</em> spp. are on the lower end of the range of CV estimates.</figcaption>
</figure>
</div>
</section>
<section id="ed-fig.-7" class="level2">
<h2 class="anchored" data-anchor-id="ed-fig.-7">ED Fig. 7</h2>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a>ED_fig7_eq <span class="ot">&lt;-</span> <span class="fu">lm</span>(<span class="fu">log</span>(mean_size) <span class="sc">~</span> <span class="fu">log</span>(std_linf), <span class="at">data =</span> ED_fig7_data)</span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-3"><a href="#cb13-3" aria-hidden="true" tabindex="-1"></a>ED_fig7 <span class="ot">&lt;-</span></span>
<span id="cb13-4"><a href="#cb13-4" aria-hidden="true" tabindex="-1"></a>  ED_fig7_data <span class="sc">%&gt;%</span> </span>
<span id="cb13-5"><a href="#cb13-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">add_predictions</span>(ED_fig7_eq) <span class="sc">%&gt;%</span> </span>
<span id="cb13-6"><a href="#cb13-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> std_linf, </span>
<span id="cb13-7"><a href="#cb13-7" aria-hidden="true" tabindex="-1"></a>             <span class="at">y =</span> mean_size)) <span class="sc">+</span></span>
<span id="cb13-8"><a href="#cb13-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb13-9"><a href="#cb13-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">y =</span> <span class="fu">exp</span>(pred)), <span class="at">col =</span> <span class="st">"red"</span>) <span class="sc">+</span></span>
<span id="cb13-10"><a href="#cb13-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_cowplot</span>() <span class="sc">+</span></span>
<span id="cb13-11"><a href="#cb13-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">label =</span> <span class="fu">label_number</span>(<span class="at">suffix =</span> <span class="st">"cm"</span>)) <span class="sc">+</span></span>
<span id="cb13-12"><a href="#cb13-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">label =</span> <span class="fu">label_number</span>(<span class="at">suffix =</span> <span class="st">"cm"</span>)) <span class="sc">+</span></span>
<span id="cb13-13"><a href="#cb13-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"Asymptotic length (literature)"</span>, </span>
<span id="cb13-14"><a href="#cb13-14" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">"Mean length (observed)"</span>)</span>
<span id="cb13-15"><a href="#cb13-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-16"><a href="#cb13-16" aria-hidden="true" tabindex="-1"></a><span class="fu">ggsave</span>(<span class="at">filename =</span> <span class="st">"ms_figs/linf_lmu.png"</span>,</span>
<span id="cb13-17"><a href="#cb13-17" aria-hidden="true" tabindex="-1"></a>       <span class="at">plot =</span> ED_fig7,</span>
<span id="cb13-18"><a href="#cb13-18" aria-hidden="true" tabindex="-1"></a>       <span class="at">height =</span> <span class="dv">10</span>,</span>
<span id="cb13-19"><a href="#cb13-19" aria-hidden="true" tabindex="-1"></a>       <span class="at">width =</span> <span class="dv">10</span><span class="sc">*</span><span class="fl">1.618</span>,</span>
<span id="cb13-20"><a href="#cb13-20" aria-hidden="true" tabindex="-1"></a>       <span class="at">units =</span> <span class="st">"cm"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="ms_figs/linf_lmu.png" class="img-fluid figure-img"></p>
<figcaption class="figure-caption">A fitted linear model to predict mean population body length (from empirical body length distributions) from asymptotic body length (available from Prince et al.17). This fitted model was used to reconstruct the body length distribution when only asymptotic body length is known, which is often the case for many species or populations. Fitted model (red line): log(mean_length) = 0.37 + 0.78*log(asymptotic_length).</figcaption>
</figure>
</div>
</section>
<section id="ed-fig.-8" class="level2">
<h2 class="anchored" data-anchor-id="ed-fig.-8">ED Fig. 8</h2>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a>difference_plots_all_40cm <span class="ot">&lt;-</span></span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a>  ED_fig8_data <span class="sc">%&gt;%</span> </span>
<span id="cb14-3"><a href="#cb14-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">obs_minus_exp =</span> p_obs<span class="sc">-</span>p_lbspr) <span class="sc">%&gt;%</span> </span>
<span id="cb14-4"><a href="#cb14-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> size_class, </span>
<span id="cb14-5"><a href="#cb14-5" aria-hidden="true" tabindex="-1"></a>             <span class="at">y =</span> obs_minus_exp)) <span class="sc">+</span></span>
<span id="cb14-6"><a href="#cb14-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> <span class="dv">0</span>, <span class="at">col =</span> <span class="st">"red"</span>) <span class="sc">+</span></span>
<span id="cb14-7"><a href="#cb14-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_path</span>(<span class="at">alpha =</span> <span class="fl">0.1</span>, <span class="fu">aes</span>(<span class="at">group =</span> species)) <span class="sc">+</span> </span>
<span id="cb14-8"><a href="#cb14-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">alpha =</span> <span class="fl">0.1</span>) <span class="sc">+</span></span>
<span id="cb14-9"><a href="#cb14-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_smooth</span>() <span class="sc">+</span></span>
<span id="cb14-10"><a href="#cb14-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">breaks =</span> <span class="fu">c</span>(fig4_data<span class="sc">$</span>size_class), </span>
<span id="cb14-11"><a href="#cb14-11" aria-hidden="true" tabindex="-1"></a>                     <span class="at">limits =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">40</span>)) <span class="sc">+</span></span>
<span id="cb14-12"><a href="#cb14-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">label =</span> <span class="fu">label_number</span>())<span class="sc">+</span></span>
<span id="cb14-13"><a href="#cb14-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"Visual census length classes (cm)"</span>, </span>
<span id="cb14-14"><a href="#cb14-14" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">"Observed minus LBSPR"</span>) <span class="sc">+</span></span>
<span id="cb14-15"><a href="#cb14-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">annotate</span>(<span class="at">geom =</span> <span class="st">"text"</span>, <span class="at">x =</span> <span class="cn">Inf</span>, </span>
<span id="cb14-16"><a href="#cb14-16" aria-hidden="true" tabindex="-1"></a>           <span class="at">y =</span> <span class="sc">-</span><span class="cn">Inf</span>, </span>
<span id="cb14-17"><a href="#cb14-17" aria-hidden="true" tabindex="-1"></a>           <span class="at">label =</span> <span class="st">"Observed &lt; LBSPR"</span>, </span>
<span id="cb14-18"><a href="#cb14-18" aria-hidden="true" tabindex="-1"></a>           <span class="at">hjust =</span> <span class="fl">1.1</span>, </span>
<span id="cb14-19"><a href="#cb14-19" aria-hidden="true" tabindex="-1"></a>           <span class="at">vjust =</span> <span class="sc">-</span><span class="fl">0.5</span>, </span>
<span id="cb14-20"><a href="#cb14-20" aria-hidden="true" tabindex="-1"></a>           <span class="at">size =</span> <span class="dv">8</span>) <span class="sc">+</span></span>
<span id="cb14-21"><a href="#cb14-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">annotate</span>(<span class="at">geom =</span> <span class="st">"text"</span>, </span>
<span id="cb14-22"><a href="#cb14-22" aria-hidden="true" tabindex="-1"></a>           <span class="at">x =</span> <span class="cn">Inf</span>, </span>
<span id="cb14-23"><a href="#cb14-23" aria-hidden="true" tabindex="-1"></a>           <span class="at">y =</span> <span class="cn">Inf</span>, </span>
<span id="cb14-24"><a href="#cb14-24" aria-hidden="true" tabindex="-1"></a>           <span class="at">label =</span> <span class="st">"Observed &gt; LBSPR"</span>, </span>
<span id="cb14-25"><a href="#cb14-25" aria-hidden="true" tabindex="-1"></a>           <span class="at">hjust =</span> <span class="fl">1.1</span>, </span>
<span id="cb14-26"><a href="#cb14-26" aria-hidden="true" tabindex="-1"></a>           <span class="at">vjust =</span> <span class="fl">1.5</span>, </span>
<span id="cb14-27"><a href="#cb14-27" aria-hidden="true" tabindex="-1"></a>           <span class="at">size =</span> <span class="dv">8</span>) <span class="sc">+</span></span>
<span id="cb14-28"><a href="#cb14-28" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_cowplot</span>()</span>
<span id="cb14-29"><a href="#cb14-29" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-30"><a href="#cb14-30" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-31"><a href="#cb14-31" aria-hidden="true" tabindex="-1"></a><span class="fu">ggsave</span>(<span class="at">filename =</span> <span class="st">"ms_figs/obs_minus_lbspr.png"</span>,</span>
<span id="cb14-32"><a href="#cb14-32" aria-hidden="true" tabindex="-1"></a>       <span class="at">plot =</span> difference_plots_all_40cm,</span>
<span id="cb14-33"><a href="#cb14-33" aria-hidden="true" tabindex="-1"></a>       <span class="at">height =</span> <span class="dv">15</span>,</span>
<span id="cb14-34"><a href="#cb14-34" aria-hidden="true" tabindex="-1"></a>       <span class="at">width =</span> <span class="dv">15</span><span class="sc">*</span><span class="fl">1.618</span>,</span>
<span id="cb14-35"><a href="#cb14-35" aria-hidden="true" tabindex="-1"></a>       <span class="at">units =</span> <span class="st">"cm"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="ms_figs/obs_minus_lbspr.png" class="img-fluid figure-img"></p>
<figcaption class="figure-caption">Observed proportion within a length bin minus expected proportion as predicted by the theoretical model LBSPR. LBSPR is parameterized by asymptotic length, mortality (M) and growth rate (k). Points below the red horizontal line indicate there is a lower observed proportion of individuals in the size bin than predicted by LBSPR. The x-axis has been truncated to 40cm to emphasize this region where observational sampling bias is most likely to occur.</figcaption>
</figure>
</div>
</section>
<section id="ed-fig.-9" class="level2">
<h2 class="anchored" data-anchor-id="ed-fig.-9">ED Fig. 9</h2>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a>ED_fig9 <span class="ot">&lt;-</span></span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a>  ED_fig9_data <span class="sc">%&gt;%</span> </span>
<span id="cb15-3"><a href="#cb15-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> <span class="fu">as.factor</span>(mincount), <span class="at">y =</span> cv_50, <span class="at">col =</span> mod)) <span class="sc">+</span></span>
<span id="cb15-4"><a href="#cb15-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_violin</span>() <span class="sc">+</span></span>
<span id="cb15-5"><a href="#cb15-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(datatype<span class="sc">~</span>., <span class="at">scales =</span> <span class="st">"free_x"</span>) <span class="sc">+</span></span>
<span id="cb15-6"><a href="#cb15-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">limits =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">1</span>))<span class="sc">+</span></span>
<span id="cb15-7"><a href="#cb15-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text</span>(<span class="fu">aes</span>(<span class="at">label =</span> <span class="fu">paste</span>(<span class="st">"n ="</span>, max_n)), <span class="at">y =</span> <span class="fl">0.0</span>, <span class="at">show.legend =</span> <span class="cn">FALSE</span>, <span class="at">col =</span> <span class="st">"black"</span>, </span>
<span id="cb15-8"><a href="#cb15-8" aria-hidden="true" tabindex="-1"></a>            <span class="at">data =</span> </span>
<span id="cb15-9"><a href="#cb15-9" aria-hidden="true" tabindex="-1"></a>              ED_fig9_data <span class="sc">%&gt;%</span> </span>
<span id="cb15-10"><a href="#cb15-10" aria-hidden="true" tabindex="-1"></a>              <span class="fu">count</span>(datatype, mod, mincount) <span class="sc">%&gt;%</span> </span>
<span id="cb15-11"><a href="#cb15-11" aria-hidden="true" tabindex="-1"></a>              <span class="fu">summarise</span>(<span class="at">max_n =</span> <span class="fu">max</span>(n), </span>
<span id="cb15-12"><a href="#cb15-12" aria-hidden="true" tabindex="-1"></a>                        <span class="at">.by =</span> <span class="fu">c</span>(datatype, mincount))) <span class="sc">+</span></span>
<span id="cb15-13"><a href="#cb15-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">"normal"</span> <span class="ot">=</span> <span class="fu">rgb</span>(<span class="dv">181</span>, <span class="dv">144</span>, <span class="dv">19</span>, <span class="at">maxColorValue=</span><span class="dv">255</span>),</span>
<span id="cb15-14"><a href="#cb15-14" aria-hidden="true" tabindex="-1"></a>                                <span class="st">"lognormal"</span> <span class="ot">=</span> <span class="fu">rgb</span>(<span class="dv">29</span>, <span class="dv">84</span>, <span class="dv">128</span>, <span class="at">maxColorValue=</span><span class="dv">255</span>)), </span>
<span id="cb15-15"><a href="#cb15-15" aria-hidden="true" tabindex="-1"></a>                     <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"normal"</span> <span class="ot">=</span> <span class="st">"Normal"</span>,</span>
<span id="cb15-16"><a href="#cb15-16" aria-hidden="true" tabindex="-1"></a>                                <span class="st">"lognormal"</span> <span class="ot">=</span> <span class="st">"Lognormal"</span>)) <span class="sc">+</span></span>
<span id="cb15-17"><a href="#cb15-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"Minimum population size (# individuals)"</span>, </span>
<span id="cb15-18"><a href="#cb15-18" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">"Median CV estimate"</span>) <span class="sc">+</span></span>
<span id="cb15-19"><a href="#cb15-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_cowplot</span>(<span class="dv">20</span>) <span class="sc">+</span></span>
<span id="cb15-20"><a href="#cb15-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">1</span>), </span>
<span id="cb15-21"><a href="#cb15-21" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.justification =</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="fl">1.1</span>),</span>
<span id="cb15-22"><a href="#cb15-22" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.title =</span> <span class="fu">element_blank</span>(), </span>
<span id="cb15-23"><a href="#cb15-23" aria-hidden="true" tabindex="-1"></a>        <span class="at">plot.margin =</span> <span class="fu">margin</span>(<span class="dv">10</span>, <span class="dv">50</span>, <span class="dv">10</span>, <span class="dv">10</span>), </span>
<span id="cb15-24"><a href="#cb15-24" aria-hidden="true" tabindex="-1"></a>        <span class="at">strip.background =</span> <span class="fu">element_rect</span>(<span class="at">fill =</span> <span class="st">"white"</span>, <span class="at">colour =</span> <span class="st">"black"</span>))</span>
<span id="cb15-25"><a href="#cb15-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-26"><a href="#cb15-26" aria-hidden="true" tabindex="-1"></a><span class="fu">ggsave</span>(<span class="at">filename =</span> <span class="st">"ms_figs/mincount_sensitivity.png"</span>,</span>
<span id="cb15-27"><a href="#cb15-27" aria-hidden="true" tabindex="-1"></a>       <span class="at">plot =</span> ED_fig9,</span>
<span id="cb15-28"><a href="#cb15-28" aria-hidden="true" tabindex="-1"></a>       <span class="at">height =</span> <span class="dv">15</span>,</span>
<span id="cb15-29"><a href="#cb15-29" aria-hidden="true" tabindex="-1"></a>       <span class="at">width =</span> <span class="dv">25</span>,</span>
<span id="cb15-30"><a href="#cb15-30" aria-hidden="true" tabindex="-1"></a>       <span class="at">units =</span> <span class="st">"cm"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="ms_figs/mincount_sensitivity.png" class="img-fluid figure-img"></p>
<figcaption class="figure-caption">Changing the minimum sample size (individuals within a population) required for distribution fitting has minimal influence of the median estimate of the coefficient of variation (CV). CV values greater than one have been excluded from this figure.</figcaption>
</figure>
</div>
</section>
<section id="ed-fig.-10" class="level2">
<h2 class="anchored" data-anchor-id="ed-fig.-10">ED Fig. 10</h2>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a>inc_bimodal <span class="ot">&lt;-</span> <span class="cn">TRUE</span></span>
<span id="cb16-2"><a href="#cb16-2" aria-hidden="true" tabindex="-1"></a>inc_fished <span class="ot">&lt;-</span> <span class="cn">TRUE</span></span>
<span id="cb16-3"><a href="#cb16-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-4"><a href="#cb16-4" aria-hidden="true" tabindex="-1"></a>pop_data <span class="ot">&lt;-</span> </span>
<span id="cb16-5"><a href="#cb16-5" aria-hidden="true" tabindex="-1"></a>  fig2_data_pop <span class="sc">%&gt;%</span></span>
<span id="cb16-6"><a href="#cb16-6" aria-hidden="true" tabindex="-1"></a>  {<span class="cf">if</span>(inc_fished) . <span class="cf">else</span> <span class="fu">filter</span>(., <span class="sc">!</span>fished)} <span class="sc">%&gt;%</span> </span>
<span id="cb16-7"><a href="#cb16-7" aria-hidden="true" tabindex="-1"></a>  {<span class="cf">if</span>(inc_bimodal) . <span class="cf">else</span> <span class="fu">filter</span>(., <span class="sc">!</span>bimodal)} </span>
<span id="cb16-8"><a href="#cb16-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-9"><a href="#cb16-9" aria-hidden="true" tabindex="-1"></a>spp_data <span class="ot">&lt;-</span> </span>
<span id="cb16-10"><a href="#cb16-10" aria-hidden="true" tabindex="-1"></a>  fig2_data_spp <span class="sc">%&gt;%</span> </span>
<span id="cb16-11"><a href="#cb16-11" aria-hidden="true" tabindex="-1"></a>  {<span class="cf">if</span>(inc_fished) . <span class="cf">else</span> <span class="fu">filter</span>(., <span class="sc">!</span>fished)} <span class="sc">%&gt;%</span> </span>
<span id="cb16-12"><a href="#cb16-12" aria-hidden="true" tabindex="-1"></a>  {<span class="cf">if</span>(inc_bimodal) . <span class="cf">else</span> <span class="fu">filter</span>(., <span class="sc">!</span>bimodal)}</span>
<span id="cb16-13"><a href="#cb16-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-14"><a href="#cb16-14" aria-hidden="true" tabindex="-1"></a>plot_ylim <span class="ot">&lt;-</span> </span>
<span id="cb16-15"><a href="#cb16-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">max</span>(<span class="fu">layer_scales</span>(</span>
<span id="cb16-16"><a href="#cb16-16" aria-hidden="true" tabindex="-1"></a>    <span class="fu">main_plot</span>(pop_data))<span class="sc">$</span>y<span class="sc">$</span>range<span class="sc">$</span>range,</span>
<span id="cb16-17"><a href="#cb16-17" aria-hidden="true" tabindex="-1"></a>    <span class="fu">layer_scales</span>(</span>
<span id="cb16-18"><a href="#cb16-18" aria-hidden="true" tabindex="-1"></a>      <span class="fu">main_plot</span>(spp_data))<span class="sc">$</span>y<span class="sc">$</span>range<span class="sc">$</span>range)</span>
<span id="cb16-19"><a href="#cb16-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-20"><a href="#cb16-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-21"><a href="#cb16-21" aria-hidden="true" tabindex="-1"></a>ED_fig10_main <span class="ot">&lt;-</span> </span>
<span id="cb16-22"><a href="#cb16-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">main_plot</span>(pop_data) <span class="sc">+</span> </span>
<span id="cb16-23"><a href="#cb16-23" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.title.x =</span> <span class="fu">element_blank</span>()) <span class="sc">+</span></span>
<span id="cb16-24"><a href="#cb16-24" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylim</span>(<span class="dv">0</span>, plot_ylim) <span class="sc">+</span></span>
<span id="cb16-25"><a href="#cb16-25" aria-hidden="true" tabindex="-1"></a>  <span class="fu">annotate</span>(<span class="st">"text"</span>,</span>
<span id="cb16-26"><a href="#cb16-26" aria-hidden="true" tabindex="-1"></a>           <span class="at">x =</span> <span class="dv">1</span>, </span>
<span id="cb16-27"><a href="#cb16-27" aria-hidden="true" tabindex="-1"></a>           <span class="at">hjust =</span> <span class="dv">0</span>, </span>
<span id="cb16-28"><a href="#cb16-28" aria-hidden="true" tabindex="-1"></a>           <span class="at">y =</span> plot_ylim<span class="sc">*</span><span class="fl">0.95</span>,</span>
<span id="cb16-29"><a href="#cb16-29" aria-hidden="true" tabindex="-1"></a>           <span class="at">label =</span> <span class="st">"Population-level"</span>,</span>
<span id="cb16-30"><a href="#cb16-30" aria-hidden="true" tabindex="-1"></a>           <span class="at">size =</span> <span class="dv">10</span>) <span class="sc">+</span></span>
<span id="cb16-31"><a href="#cb16-31" aria-hidden="true" tabindex="-1"></a>  <span class="fu">side_plot</span>(pop_data <span class="sc">%&gt;%</span> </span>
<span id="cb16-32"><a href="#cb16-32" aria-hidden="true" tabindex="-1"></a>              <span class="fu">filter</span>(col <span class="sc">!=</span> <span class="st">"cbf_lnorm"</span>), </span>
<span id="cb16-33"><a href="#cb16-33" aria-hidden="true" tabindex="-1"></a>            plot_ylim) <span class="sc">+</span> </span>
<span id="cb16-34"><a href="#cb16-34" aria-hidden="true" tabindex="-1"></a>  <span class="fu">main_plot</span>(spp_data) <span class="sc">+</span> <span class="fu">ylim</span>(<span class="dv">0</span>, plot_ylim) <span class="sc">+</span></span>
<span id="cb16-35"><a href="#cb16-35" aria-hidden="true" tabindex="-1"></a>  <span class="fu">annotate</span>(<span class="st">"text"</span>, </span>
<span id="cb16-36"><a href="#cb16-36" aria-hidden="true" tabindex="-1"></a>           <span class="at">x =</span> <span class="dv">1</span>, </span>
<span id="cb16-37"><a href="#cb16-37" aria-hidden="true" tabindex="-1"></a>           <span class="at">hjust =</span> <span class="dv">0</span>, </span>
<span id="cb16-38"><a href="#cb16-38" aria-hidden="true" tabindex="-1"></a>           <span class="at">y =</span> plot_ylim<span class="sc">*</span><span class="fl">0.95</span>,</span>
<span id="cb16-39"><a href="#cb16-39" aria-hidden="true" tabindex="-1"></a>           <span class="at">label =</span> <span class="st">"Species-level"</span>,</span>
<span id="cb16-40"><a href="#cb16-40" aria-hidden="true" tabindex="-1"></a>           <span class="at">size =</span> <span class="dv">10</span>) <span class="sc">+</span></span>
<span id="cb16-41"><a href="#cb16-41" aria-hidden="true" tabindex="-1"></a>  <span class="fu">side_plot</span>(spp_data <span class="sc">%&gt;%</span> <span class="fu">filter</span>(col <span class="sc">!=</span> <span class="st">"cbf_lnorm"</span>), </span>
<span id="cb16-42"><a href="#cb16-42" aria-hidden="true" tabindex="-1"></a>            plot_ylim)  <span class="sc">+</span></span>
<span id="cb16-43"><a href="#cb16-43" aria-hidden="true" tabindex="-1"></a>  <span class="fu">plot_layout</span>(<span class="at">design =</span> {<span class="st">"</span></span>
<span id="cb16-44"><a href="#cb16-44" aria-hidden="true" tabindex="-1"></a><span class="st">      AAAAAAB</span></span>
<span id="cb16-45"><a href="#cb16-45" aria-hidden="true" tabindex="-1"></a><span class="st">      AAAAAAB</span></span>
<span id="cb16-46"><a href="#cb16-46" aria-hidden="true" tabindex="-1"></a><span class="st">      CCCCCCD</span></span>
<span id="cb16-47"><a href="#cb16-47" aria-hidden="true" tabindex="-1"></a><span class="st">      CCCCCCD"</span></span>
<span id="cb16-48"><a href="#cb16-48" aria-hidden="true" tabindex="-1"></a>  })</span>
<span id="cb16-49"><a href="#cb16-49" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-50"><a href="#cb16-50" aria-hidden="true" tabindex="-1"></a>ED_fig10_legend <span class="ot">&lt;-</span></span>
<span id="cb16-51"><a href="#cb16-51" aria-hidden="true" tabindex="-1"></a>  ggpubr<span class="sc">::</span><span class="fu">as_ggplot</span>(</span>
<span id="cb16-52"><a href="#cb16-52" aria-hidden="true" tabindex="-1"></a>    ggpubr<span class="sc">::</span><span class="fu">get_legend</span>(</span>
<span id="cb16-53"><a href="#cb16-53" aria-hidden="true" tabindex="-1"></a>      <span class="fu">main_plot</span>(pop_data) <span class="sc">+</span></span>
<span id="cb16-54"><a href="#cb16-54" aria-hidden="true" tabindex="-1"></a>        <span class="fu">theme</span>(<span class="at">axis.title =</span> <span class="fu">element_text</span>(), </span>
<span id="cb16-55"><a href="#cb16-55" aria-hidden="true" tabindex="-1"></a>              <span class="at">axis.text =</span> <span class="fu">element_text</span>()) <span class="sc">+</span></span>
<span id="cb16-56"><a href="#cb16-56" aria-hidden="true" tabindex="-1"></a>        <span class="fu">guides</span>(<span class="at">colour =</span> <span class="fu">guide_legend</span>(<span class="at">override.aes =</span> <span class="fu">list</span>(<span class="at">size=</span><span class="dv">5</span>, <span class="at">stroke =</span> <span class="dv">2</span>),</span>
<span id="cb16-57"><a href="#cb16-57" aria-hidden="true" tabindex="-1"></a>                                     <span class="at">nrow =</span> <span class="dv">2</span>,</span>
<span id="cb16-58"><a href="#cb16-58" aria-hidden="true" tabindex="-1"></a>                                     <span class="at">byrow =</span> <span class="cn">TRUE</span>,</span>
<span id="cb16-59"><a href="#cb16-59" aria-hidden="true" tabindex="-1"></a>                                     <span class="at">title =</span> <span class="fu">element_blank</span>()), </span>
<span id="cb16-60"><a href="#cb16-60" aria-hidden="true" tabindex="-1"></a>               <span class="at">pch =</span> <span class="fu">guide_legend</span>(<span class="at">nrow =</span> <span class="dv">2</span>,</span>
<span id="cb16-61"><a href="#cb16-61" aria-hidden="true" tabindex="-1"></a>                                  <span class="at">byrow =</span> <span class="cn">TRUE</span>,</span>
<span id="cb16-62"><a href="#cb16-62" aria-hidden="true" tabindex="-1"></a>                                  <span class="at">title =</span> <span class="fu">element_blank</span>())) <span class="sc">+</span></span>
<span id="cb16-63"><a href="#cb16-63" aria-hidden="true" tabindex="-1"></a>        <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"bottom"</span>, </span>
<span id="cb16-64"><a href="#cb16-64" aria-hidden="true" tabindex="-1"></a>              <span class="at">legend.box =</span> <span class="st">"vertical"</span>,</span>
<span id="cb16-65"><a href="#cb16-65" aria-hidden="true" tabindex="-1"></a>              <span class="at">legend.justification =</span> <span class="fu">c</span>(<span class="fl">0.5</span>,<span class="fl">0.5</span>),</span>
<span id="cb16-66"><a href="#cb16-66" aria-hidden="true" tabindex="-1"></a>              <span class="at">legend.background =</span> <span class="fu">element_rect</span>(<span class="at">color =</span> <span class="st">"black"</span>),</span>
<span id="cb16-67"><a href="#cb16-67" aria-hidden="true" tabindex="-1"></a>              <span class="at">legend.margin=</span><span class="fu">margin</span>(<span class="dv">5</span>,<span class="dv">5</span>,<span class="dv">5</span>,<span class="dv">6</span>),</span>
<span id="cb16-68"><a href="#cb16-68" aria-hidden="true" tabindex="-1"></a>              <span class="at">legend.title =</span> <span class="fu">element_text</span>()), </span>
<span id="cb16-69"><a href="#cb16-69" aria-hidden="true" tabindex="-1"></a>      </span>
<span id="cb16-70"><a href="#cb16-70" aria-hidden="true" tabindex="-1"></a>    )) </span>
<span id="cb16-71"><a href="#cb16-71" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-72"><a href="#cb16-72" aria-hidden="true" tabindex="-1"></a>ED_fig10_yaxis <span class="ot">&lt;-</span> </span>
<span id="cb16-73"><a href="#cb16-73" aria-hidden="true" tabindex="-1"></a>  <span class="fu">wrap_elements</span>(ED_fig10_main) <span class="sc">+</span></span>
<span id="cb16-74"><a href="#cb16-74" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">tag =</span> <span class="st">"Coeffient of variation in body size"</span>) <span class="sc">+</span></span>
<span id="cb16-75"><a href="#cb16-75" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(</span>
<span id="cb16-76"><a href="#cb16-76" aria-hidden="true" tabindex="-1"></a>    <span class="at">plot.tag =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">20</span>, <span class="at">angle =</span> <span class="dv">90</span>),</span>
<span id="cb16-77"><a href="#cb16-77" aria-hidden="true" tabindex="-1"></a>    <span class="at">plot.tag.position =</span> <span class="st">"left"</span></span>
<span id="cb16-78"><a href="#cb16-78" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb16-79"><a href="#cb16-79" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-80"><a href="#cb16-80" aria-hidden="true" tabindex="-1"></a>ED_fig10 <span class="ot">&lt;-</span> </span>
<span id="cb16-81"><a href="#cb16-81" aria-hidden="true" tabindex="-1"></a>  ED_fig10_yaxis <span class="sc">+</span> </span>
<span id="cb16-82"><a href="#cb16-82" aria-hidden="true" tabindex="-1"></a>  ED_fig10_legend <span class="sc">+</span></span>
<span id="cb16-83"><a href="#cb16-83" aria-hidden="true" tabindex="-1"></a>  <span class="fu">plot_layout</span>(<span class="at">design =</span> {<span class="st">"</span></span>
<span id="cb16-84"><a href="#cb16-84" aria-hidden="true" tabindex="-1"></a><span class="st">      AAAAAAA</span></span>
<span id="cb16-85"><a href="#cb16-85" aria-hidden="true" tabindex="-1"></a><span class="st">      AAAAAAA</span></span>
<span id="cb16-86"><a href="#cb16-86" aria-hidden="true" tabindex="-1"></a><span class="st">      AAAAAAA</span></span>
<span id="cb16-87"><a href="#cb16-87" aria-hidden="true" tabindex="-1"></a><span class="st">      AAAAAAA</span></span>
<span id="cb16-88"><a href="#cb16-88" aria-hidden="true" tabindex="-1"></a><span class="st">            #BBBBB#"</span></span>
<span id="cb16-89"><a href="#cb16-89" aria-hidden="true" tabindex="-1"></a>  })</span>
<span id="cb16-90"><a href="#cb16-90" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-91"><a href="#cb16-91" aria-hidden="true" tabindex="-1"></a><span class="fu">ggsave</span>(<span class="at">filename =</span> <span class="st">"ms_figs/cv_meansize_incbimod.png"</span>,</span>
<span id="cb16-92"><a href="#cb16-92" aria-hidden="true" tabindex="-1"></a>       <span class="at">plot =</span> ED_fig10,</span>
<span id="cb16-93"><a href="#cb16-93" aria-hidden="true" tabindex="-1"></a>       <span class="at">height =</span> <span class="dv">20</span>,</span>
<span id="cb16-94"><a href="#cb16-94" aria-hidden="true" tabindex="-1"></a>       <span class="at">width =</span> <span class="dv">20</span><span class="sc">*</span><span class="fl">1.618</span>,</span>
<span id="cb16-95"><a href="#cb16-95" aria-hidden="true" tabindex="-1"></a>       <span class="at">units =</span> <span class="st">"cm"</span>, </span>
<span id="cb16-96"><a href="#cb16-96" aria-hidden="true" tabindex="-1"></a>       <span class="at">create.dir =</span> <span class="cn">TRUE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="ms_figs/cv_meansize_incbimod.png" class="img-fluid figure-img"></p>
<figcaption class="figure-caption">Distributions deemed to be bimodal (red crosses, 2% of total populations) were excluded in Fig. 2 in the main text. Including these distributions has minor influence on the estimate of CV. At the population level the median CV value is 0.34, 80% of CV values fall in the range of 0.22 to 0.51 and 95% of the CV values fall in the range of 0.19 and 0.56. At the species-level the median CV value is 0.36, 80% of CV values fall in the range of 0.22 to 0.51 and 95% of the CV values fall in the range of 0.17 and 0.57.</figcaption>
</figure>
</div>
<!-- -->

</section>
</section>

</main>
<!-- /main column -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  const viewSource = window.document.getElementById('quarto-view-source') ||
                     window.document.getElementById('quarto-code-tools-source');
  if (viewSource) {
    const sourceUrl = viewSource.getAttribute("data-quarto-source-url");
    viewSource.addEventListener("click", function(e) {
      if (sourceUrl) {
        // rstudio viewer pane
        if (/\bcapabilities=\b/.test(window.location)) {
          window.open(sourceUrl);
        } else {
          window.location.href = sourceUrl;
        }
      } else {
        const modal = new bootstrap.Modal(document.getElementById('quarto-embedded-source-code-modal'));
        modal.show();
      }
      return false;
    });
  }
  function toggleCodeHandler(show) {
    return function(e) {
      const detailsSrc = window.document.querySelectorAll(".cell > details > .sourceCode");
      for (let i=0; i<detailsSrc.length; i++) {
        const details = detailsSrc[i].parentElement;
        if (show) {
          details.open = true;
        } else {
          details.removeAttribute("open");
        }
      }
      const cellCodeDivs = window.document.querySelectorAll(".cell > .sourceCode");
      const fromCls = show ? "hidden" : "unhidden";
      const toCls = show ? "unhidden" : "hidden";
      for (let i=0; i<cellCodeDivs.length; i++) {
        const codeDiv = cellCodeDivs[i];
        if (codeDiv.classList.contains(fromCls)) {
          codeDiv.classList.remove(fromCls);
          codeDiv.classList.add(toCls);
        } 
      }
      return false;
    }
  }
  const hideAllCode = window.document.getElementById("quarto-hide-all-code");
  if (hideAllCode) {
    hideAllCode.addEventListener("click", toggleCodeHandler(false));
  }
  const showAllCode = window.document.getElementById("quarto-show-all-code");
  if (showAllCode) {
    showAllCode.addEventListener("click", toggleCodeHandler(true));
  }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    if (id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        for (let i = 0; i < 2; i++) {
          container.appendChild(note.children[i].cloneNode(true));
        }
        return container.innerHTML
      } else {
        return note.innerHTML;
      }
    } else {
      return note.innerHTML;
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      try { hash = new URL(url).hash; } catch {}
      const id = hash.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note !== null) {
        try {
          const html = processXRef(id, note);
          instance.setContent(html);
        } finally {
          instance.enable();
          instance.show();
        }
      } else {
        // See if we can fetch this
        fetch(url.split('#')[0])
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.getElementById(id);
          if (note !== null) {
            const html = processXRef(id, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script><div class="modal fade" id="quarto-embedded-source-code-modal" tabindex="-1" aria-labelledby="quarto-embedded-source-code-modal-label" aria-hidden="true"><div class="modal-dialog modal-dialog-scrollable"><div class="modal-content"><div class="modal-header"><h5 class="modal-title" id="quarto-embedded-source-code-modal-label">Source Code</h5><button class="btn-close" data-bs-dismiss="modal"></button></div><div class="modal-body"><div class="">
<div class="sourceCode" id="cb17" data-shortcodes="false"><pre class="sourceCode markdown code-with-copy"><code class="sourceCode markdown"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a><span class="co">---</span></span>
<span id="cb17-2"><a href="#cb17-2" aria-hidden="true" tabindex="-1"></a><span class="an">title:</span><span class="co"> "Consistency in species body size distributions across marine fishes"</span></span>
<span id="cb17-3"><a href="#cb17-3" aria-hidden="true" tabindex="-1"></a><span class="an">subtitle:</span><span class="co"> "R script to reconstruct figures"</span></span>
<span id="cb17-4"><a href="#cb17-4" aria-hidden="true" tabindex="-1"></a><span class="an">author:</span><span class="co"> Freddie Heather</span></span>
<span id="cb17-5"><a href="#cb17-5" aria-hidden="true" tabindex="-1"></a><span class="an">date:</span><span class="co"> "2024-05-14"</span></span>
<span id="cb17-6"><a href="#cb17-6" aria-hidden="true" tabindex="-1"></a><span class="an">format:</span><span class="co"> </span></span>
<span id="cb17-7"><a href="#cb17-7" aria-hidden="true" tabindex="-1"></a><span class="co">  html:</span></span>
<span id="cb17-8"><a href="#cb17-8" aria-hidden="true" tabindex="-1"></a><span class="co">    code-fold: true</span></span>
<span id="cb17-9"><a href="#cb17-9" aria-hidden="true" tabindex="-1"></a><span class="co">    code-tools: true</span></span>
<span id="cb17-10"><a href="#cb17-10" aria-hidden="true" tabindex="-1"></a><span class="an">editor:</span><span class="co"> visual</span></span>
<span id="cb17-11"><a href="#cb17-11" aria-hidden="true" tabindex="-1"></a><span class="an">execute:</span></span>
<span id="cb17-12"><a href="#cb17-12" aria-hidden="true" tabindex="-1"></a><span class="co">  message: false</span></span>
<span id="cb17-13"><a href="#cb17-13" aria-hidden="true" tabindex="-1"></a><span class="co">  warning: false</span></span>
<span id="cb17-14"><a href="#cb17-14" aria-hidden="true" tabindex="-1"></a><span class="co">---</span></span>
<span id="cb17-15"><a href="#cb17-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-16"><a href="#cb17-16" aria-hidden="true" tabindex="-1"></a><span class="fu">## About</span></span>
<span id="cb17-17"><a href="#cb17-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-18"><a href="#cb17-18" aria-hidden="true" tabindex="-1"></a>The following code will reconstruct the figures from the manuscript: Heather *et al.* (Submitted) "Consistency in species body size distributions across marine fishes". </span>
<span id="cb17-19"><a href="#cb17-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-20"><a href="#cb17-20" aria-hidden="true" tabindex="-1"></a><span class="fu">## Setup</span></span>
<span id="cb17-21"><a href="#cb17-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-22"><a href="#cb17-22" aria-hidden="true" tabindex="-1"></a>Loading the required packages.</span>
<span id="cb17-23"><a href="#cb17-23" aria-hidden="true" tabindex="-1"></a><span class="in">```{r packages}</span></span>
<span id="cb17-24"><a href="#cb17-24" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb17-25"><a href="#cb17-25" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(scales)</span>
<span id="cb17-26"><a href="#cb17-26" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(cowplot)</span>
<span id="cb17-27"><a href="#cb17-27" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(patchwork)</span>
<span id="cb17-28"><a href="#cb17-28" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggpubr)</span>
<span id="cb17-29"><a href="#cb17-29" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(modelr)</span>
<span id="cb17-30"><a href="#cb17-30" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb17-31"><a href="#cb17-31" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-32"><a href="#cb17-32" aria-hidden="true" tabindex="-1"></a>Loading the required data.</span>
<span id="cb17-33"><a href="#cb17-33" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-34"><a href="#cb17-34" aria-hidden="true" tabindex="-1"></a><span class="in">```{r data}</span></span>
<span id="cb17-35"><a href="#cb17-35" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-36"><a href="#cb17-36" aria-hidden="true" tabindex="-1"></a>read_data <span class="ot">&lt;-</span> <span class="cf">function</span>(str) <span class="fu">read_csv</span>(<span class="fu">paste0</span>(<span class="st">"fig_data/"</span>, str), <span class="at">show_col_types =</span> <span class="cn">FALSE</span>)</span>
<span id="cb17-37"><a href="#cb17-37" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-38"><a href="#cb17-38" aria-hidden="true" tabindex="-1"></a><span class="co"># Data for main figures</span></span>
<span id="cb17-39"><a href="#cb17-39" aria-hidden="true" tabindex="-1"></a>fig1_data_fits   <span class="ot">&lt;-</span> <span class="fu">read_data</span>(<span class="st">"fig1_data_fits.csv"</span>)</span>
<span id="cb17-40"><a href="#cb17-40" aria-hidden="true" tabindex="-1"></a>fig1_data_main   <span class="ot">&lt;-</span> <span class="fu">read_data</span>(<span class="st">"fig1_data_main.csv"</span>)</span>
<span id="cb17-41"><a href="#cb17-41" aria-hidden="true" tabindex="-1"></a>fig2_data_pop    <span class="ot">&lt;-</span> <span class="fu">read_data</span>(<span class="st">"fig2_data_pop.csv"</span>)</span>
<span id="cb17-42"><a href="#cb17-42" aria-hidden="true" tabindex="-1"></a>fig2_data_spp    <span class="ot">&lt;-</span> <span class="fu">read_data</span>(<span class="st">"fig2_data_spp.csv"</span>)</span>
<span id="cb17-43"><a href="#cb17-43" aria-hidden="true" tabindex="-1"></a>fig3_data        <span class="ot">&lt;-</span> <span class="fu">read_data</span>(<span class="st">"fig3_data.csv"</span>)</span>
<span id="cb17-44"><a href="#cb17-44" aria-hidden="true" tabindex="-1"></a>fig3_data_ks     <span class="ot">&lt;-</span> <span class="fu">read_data</span>(<span class="st">"fig3_data_ks.csv"</span>)</span>
<span id="cb17-45"><a href="#cb17-45" aria-hidden="true" tabindex="-1"></a>fig4_data        <span class="ot">&lt;-</span> <span class="fu">read_data</span>(<span class="st">"fig4_data.csv"</span>)</span>
<span id="cb17-46"><a href="#cb17-46" aria-hidden="true" tabindex="-1"></a>fig4_data_sample <span class="ot">&lt;-</span> <span class="fu">read_data</span>(<span class="st">"fig4_data_sample.csv"</span>)</span>
<span id="cb17-47"><a href="#cb17-47" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-48"><a href="#cb17-48" aria-hidden="true" tabindex="-1"></a><span class="co"># Data for supplementary figures</span></span>
<span id="cb17-49"><a href="#cb17-49" aria-hidden="true" tabindex="-1"></a>ED_fig1_data <span class="ot">&lt;-</span> <span class="fu">read_data</span>(<span class="st">"ED_fig1_data.csv"</span>)</span>
<span id="cb17-50"><a href="#cb17-50" aria-hidden="true" tabindex="-1"></a>ED_fig2_data <span class="ot">&lt;-</span> <span class="fu">read_data</span>(<span class="st">"ED_fig2_data.csv"</span>)</span>
<span id="cb17-51"><a href="#cb17-51" aria-hidden="true" tabindex="-1"></a>ED_fig3_data <span class="ot">&lt;-</span> <span class="fu">read_data</span>(<span class="st">"ED_fig3_data.csv"</span>)</span>
<span id="cb17-52"><a href="#cb17-52" aria-hidden="true" tabindex="-1"></a>ED_fig5_data <span class="ot">&lt;-</span> <span class="fu">read_data</span>(<span class="st">"ED_fig5_data.csv"</span>)</span>
<span id="cb17-53"><a href="#cb17-53" aria-hidden="true" tabindex="-1"></a>ED_fig7_data <span class="ot">&lt;-</span> <span class="fu">read_data</span>(<span class="st">"ED_fig7_data.csv"</span>)</span>
<span id="cb17-54"><a href="#cb17-54" aria-hidden="true" tabindex="-1"></a>ED_fig8_data <span class="ot">&lt;-</span> <span class="fu">read_data</span>(<span class="st">"ED_fig8_data.csv"</span>)</span>
<span id="cb17-55"><a href="#cb17-55" aria-hidden="true" tabindex="-1"></a>ED_fig9_data <span class="ot">&lt;-</span> <span class="fu">read_data</span>(<span class="st">"ED_fig9_data.csv"</span>)</span>
<span id="cb17-56"><a href="#cb17-56" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-57"><a href="#cb17-57" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb17-58"><a href="#cb17-58" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-59"><a href="#cb17-59" aria-hidden="true" tabindex="-1"></a><span class="fu"># Main Figures</span></span>
<span id="cb17-60"><a href="#cb17-60" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-61"><a href="#cb17-61" aria-hidden="true" tabindex="-1"></a><span class="fu">## Figure 1</span></span>
<span id="cb17-62"><a href="#cb17-62" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-63"><a href="#cb17-63" aria-hidden="true" tabindex="-1"></a><span class="in">```{r fig1}</span></span>
<span id="cb17-64"><a href="#cb17-64" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-65"><a href="#cb17-65" aria-hidden="true" tabindex="-1"></a>fig1a <span class="ot">&lt;-</span></span>
<span id="cb17-66"><a href="#cb17-66" aria-hidden="true" tabindex="-1"></a>  fig1_data_fits <span class="sc">%&gt;%</span> </span>
<span id="cb17-67"><a href="#cb17-67" aria-hidden="true" tabindex="-1"></a>  <span class="fu">bind_rows</span>(<span class="fu">tibble</span>(<span class="at">col =</span> <span class="st">"dummy_var"</span>)) <span class="sc">%&gt;%</span> <span class="co"># needed for legend</span></span>
<span id="cb17-68"><a href="#cb17-68" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> scaled_size, </span>
<span id="cb17-69"><a href="#cb17-69" aria-hidden="true" tabindex="-1"></a>             <span class="at">y =</span> scaled_n, </span>
<span id="cb17-70"><a href="#cb17-70" aria-hidden="true" tabindex="-1"></a>             <span class="at">group =</span> file)) <span class="sc">+</span></span>
<span id="cb17-71"><a href="#cb17-71" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">y =</span> scaled_n, </span>
<span id="cb17-72"><a href="#cb17-72" aria-hidden="true" tabindex="-1"></a>                <span class="at">group =</span> population, </span>
<span id="cb17-73"><a href="#cb17-73" aria-hidden="true" tabindex="-1"></a>                <span class="at">colour =</span> col),</span>
<span id="cb17-74"><a href="#cb17-74" aria-hidden="true" tabindex="-1"></a>            <span class="at">alpha =</span> <span class="fl">0.1</span>, </span>
<span id="cb17-75"><a href="#cb17-75" aria-hidden="true" tabindex="-1"></a>            <span class="at">data =</span> fig1_data_main <span class="sc">%&gt;%</span> </span>
<span id="cb17-76"><a href="#cb17-76" aria-hidden="true" tabindex="-1"></a>              <span class="fu">mutate</span>(<span class="at">col =</span> <span class="fu">case_when</span>(</span>
<span id="cb17-77"><a href="#cb17-77" aria-hidden="true" tabindex="-1"></a>                normal_better <span class="sc">~</span> <span class="fu">rgb</span>(<span class="dv">181</span>, <span class="dv">144</span>, <span class="dv">19</span>, </span>
<span id="cb17-78"><a href="#cb17-78" aria-hidden="true" tabindex="-1"></a>                                    <span class="at">maxColorValue=</span><span class="dv">255</span>), </span>
<span id="cb17-79"><a href="#cb17-79" aria-hidden="true" tabindex="-1"></a>                <span class="sc">!</span>normal_better <span class="sc">~</span> <span class="fu">rgb</span>(<span class="dv">29</span>, <span class="dv">84</span>, <span class="dv">128</span>, </span>
<span id="cb17-80"><a href="#cb17-80" aria-hidden="true" tabindex="-1"></a>                                     <span class="at">maxColorValue=</span><span class="dv">255</span>), </span>
<span id="cb17-81"><a href="#cb17-81" aria-hidden="true" tabindex="-1"></a>                <span class="cn">TRUE</span> <span class="sc">~</span> <span class="st">"grey80"</span>),</span>
<span id="cb17-82"><a href="#cb17-82" aria-hidden="true" tabindex="-1"></a>                <span class="at">lty =</span> <span class="fu">case_when</span>(normal_better <span class="sc">~</span> <span class="st">"solid"</span>, </span>
<span id="cb17-83"><a href="#cb17-83" aria-hidden="true" tabindex="-1"></a>                                <span class="sc">!</span>normal_better <span class="sc">~</span> <span class="st">"solid"</span>, </span>
<span id="cb17-84"><a href="#cb17-84" aria-hidden="true" tabindex="-1"></a>                                <span class="cn">TRUE</span> <span class="sc">~</span> <span class="st">"dashed"</span>),</span>
<span id="cb17-85"><a href="#cb17-85" aria-hidden="true" tabindex="-1"></a>                <span class="at">lwd =</span> <span class="fu">case_when</span>(normal_better <span class="sc">~</span> <span class="dv">2</span>, </span>
<span id="cb17-86"><a href="#cb17-86" aria-hidden="true" tabindex="-1"></a>                                <span class="sc">!</span>normal_better <span class="sc">~</span> <span class="dv">2</span>, </span>
<span id="cb17-87"><a href="#cb17-87" aria-hidden="true" tabindex="-1"></a>                                <span class="cn">TRUE</span> <span class="sc">~</span> <span class="fl">0.5</span>)) ) <span class="sc">+</span></span>
<span id="cb17-88"><a href="#cb17-88" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">col =</span> <span class="st">"black"</span>, <span class="at">lwd =</span> <span class="dv">3</span>, </span>
<span id="cb17-89"><a href="#cb17-89" aria-hidden="true" tabindex="-1"></a>            <span class="at">data =</span> fig1_data_fits <span class="sc">%&gt;%</span> </span>
<span id="cb17-90"><a href="#cb17-90" aria-hidden="true" tabindex="-1"></a>              <span class="fu">filter</span>(file <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">"normal"</span>, <span class="st">"lognormal"</span>))) <span class="sc">+</span></span>
<span id="cb17-91"><a href="#cb17-91" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">col =</span> col,</span>
<span id="cb17-92"><a href="#cb17-92" aria-hidden="true" tabindex="-1"></a>                <span class="at">lty =</span> lty,</span>
<span id="cb17-93"><a href="#cb17-93" aria-hidden="true" tabindex="-1"></a>                <span class="at">linewidth =</span> lwd)) <span class="sc">+</span></span>
<span id="cb17-94"><a href="#cb17-94" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">label =</span> <span class="fu">label_number</span>(<span class="at">suffix =</span> <span class="st">"x"</span>)) <span class="sc">+</span></span>
<span id="cb17-95"><a href="#cb17-95" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_identity</span>(<span class="at">labels =</span> <span class="fu">c</span>(</span>
<span id="cb17-96"><a href="#cb17-96" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Observed (Normal preferred)"</span>, </span>
<span id="cb17-97"><a href="#cb17-97" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Observed (Lognormal preferred)"</span>,</span>
<span id="cb17-98"><a href="#cb17-98" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Normal fit"</span>,</span>
<span id="cb17-99"><a href="#cb17-99" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Lognormal fit"</span>, </span>
<span id="cb17-100"><a href="#cb17-100" aria-hidden="true" tabindex="-1"></a>    <span class="st">"13 protist species"</span></span>
<span id="cb17-101"><a href="#cb17-101" aria-hidden="true" tabindex="-1"></a>  ), </span>
<span id="cb17-102"><a href="#cb17-102" aria-hidden="true" tabindex="-1"></a>  <span class="at">guide =</span> <span class="st">"legend"</span>) <span class="sc">+</span></span>
<span id="cb17-103"><a href="#cb17-103" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_linetype_identity</span>() <span class="sc">+</span></span>
<span id="cb17-104"><a href="#cb17-104" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_linewidth_identity</span>() <span class="sc">+</span></span>
<span id="cb17-105"><a href="#cb17-105" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_cowplot</span>(<span class="dv">20</span>) <span class="sc">+</span></span>
<span id="cb17-106"><a href="#cb17-106" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">1</span>), </span>
<span id="cb17-107"><a href="#cb17-107" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.justification =</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">1</span>),</span>
<span id="cb17-108"><a href="#cb17-108" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.title =</span> <span class="fu">element_blank</span>(), </span>
<span id="cb17-109"><a href="#cb17-109" aria-hidden="true" tabindex="-1"></a>        <span class="at">plot.margin =</span> <span class="fu">margin</span>(<span class="dv">10</span>, <span class="dv">20</span>, <span class="dv">10</span>, <span class="dv">10</span>)) <span class="sc">+</span></span>
<span id="cb17-110"><a href="#cb17-110" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb17-111"><a href="#cb17-111" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> <span class="st">"Body size relative to mean size"</span>,</span>
<span id="cb17-112"><a href="#cb17-112" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span> <span class="st">"Abundance relative to max"</span></span>
<span id="cb17-113"><a href="#cb17-113" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb17-114"><a href="#cb17-114" aria-hidden="true" tabindex="-1"></a>  <span class="fu">guides</span>(<span class="at">col =</span> <span class="fu">guide_legend</span>(</span>
<span id="cb17-115"><a href="#cb17-115" aria-hidden="true" tabindex="-1"></a>    <span class="at">override.aes =</span> <span class="fu">list</span>(<span class="at">lty =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">2</span>), </span>
<span id="cb17-116"><a href="#cb17-116" aria-hidden="true" tabindex="-1"></a>                        <span class="at">linewidth =</span> <span class="fu">c</span>(<span class="fl">0.3</span>, <span class="fl">0.3</span>, <span class="dv">3</span>, <span class="dv">3</span>, <span class="fl">0.5</span>), </span>
<span id="cb17-117"><a href="#cb17-117" aria-hidden="true" tabindex="-1"></a>                        <span class="at">colour =</span> <span class="fu">c</span>(<span class="fu">rgb</span>(<span class="dv">181</span>, <span class="dv">144</span>, <span class="dv">19</span>, <span class="at">maxColorValue=</span><span class="dv">255</span>),</span>
<span id="cb17-118"><a href="#cb17-118" aria-hidden="true" tabindex="-1"></a>                                   <span class="fu">rgb</span>(<span class="dv">29</span>, <span class="dv">84</span>, <span class="dv">128</span>, <span class="at">maxColorValue=</span><span class="dv">255</span>),</span>
<span id="cb17-119"><a href="#cb17-119" aria-hidden="true" tabindex="-1"></a>                                   <span class="fu">rgb</span>(<span class="dv">181</span>, <span class="dv">144</span>, <span class="dv">19</span>, <span class="at">maxColorValue=</span><span class="dv">255</span>),</span>
<span id="cb17-120"><a href="#cb17-120" aria-hidden="true" tabindex="-1"></a>                                   <span class="fu">rgb</span>(<span class="dv">29</span>, <span class="dv">84</span>, <span class="dv">128</span>, <span class="at">maxColorValue=</span><span class="dv">255</span>),</span>
<span id="cb17-121"><a href="#cb17-121" aria-hidden="true" tabindex="-1"></a>                                   <span class="st">"black"</span>), </span>
<span id="cb17-122"><a href="#cb17-122" aria-hidden="true" tabindex="-1"></a>                        <span class="at">alpha =</span> <span class="dv">1</span>), </span>
<span id="cb17-123"><a href="#cb17-123" aria-hidden="true" tabindex="-1"></a>    <span class="at">label.position =</span> <span class="st">"left"</span>))</span>
<span id="cb17-124"><a href="#cb17-124" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-125"><a href="#cb17-125" aria-hidden="true" tabindex="-1"></a><span class="co"># getting a random selection of species</span></span>
<span id="cb17-126"><a href="#cb17-126" aria-hidden="true" tabindex="-1"></a>out <span class="ot">&lt;-</span> <span class="fu">c</span>()</span>
<span id="cb17-127"><a href="#cb17-127" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">10</span>) {</span>
<span id="cb17-128"><a href="#cb17-128" aria-hidden="true" tabindex="-1"></a>  <span class="fu">set.seed</span>(<span class="dv">1</span>)</span>
<span id="cb17-129"><a href="#cb17-129" aria-hidden="true" tabindex="-1"></a>  out <span class="ot">&lt;-</span> <span class="fu">c</span>(out, <span class="fu">sample</span>(((<span class="dv">320</span><span class="sc">*</span>(i<span class="dv">-1</span>))<span class="sc">+</span><span class="dv">1</span>)<span class="sc">:</span>((<span class="dv">320</span><span class="sc">*</span>(i<span class="dv">-1</span>)<span class="sc">+</span><span class="dv">1</span>)<span class="sc">+</span><span class="dv">320</span>), <span class="dv">1</span>))</span>
<span id="cb17-130"><a href="#cb17-130" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb17-131"><a href="#cb17-131" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-132"><a href="#cb17-132" aria-hidden="true" tabindex="-1"></a>range_bodysizes <span class="ot">&lt;-</span> </span>
<span id="cb17-133"><a href="#cb17-133" aria-hidden="true" tabindex="-1"></a>  fig1_data_main <span class="sc">%&gt;%</span> </span>
<span id="cb17-134"><a href="#cb17-134" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(population <span class="sc">%in%</span> {fig1_data_main <span class="sc">%&gt;%</span> <span class="fu">filter</span>(model_fit) <span class="sc">%&gt;%</span> <span class="fu">pull</span>(population)}) <span class="sc">%&gt;%</span> </span>
<span id="cb17-135"><a href="#cb17-135" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(population, mean_size) <span class="sc">%&gt;%</span> </span>
<span id="cb17-136"><a href="#cb17-136" aria-hidden="true" tabindex="-1"></a>  <span class="fu">distinct</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb17-137"><a href="#cb17-137" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(mean_size) <span class="sc">%&gt;%</span> </span>
<span id="cb17-138"><a href="#cb17-138" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rownames_to_column</span>(<span class="st">"size_num"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb17-139"><a href="#cb17-139" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(size_num <span class="sc">%in%</span> out)</span>
<span id="cb17-140"><a href="#cb17-140" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-141"><a href="#cb17-141" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1</span>)</span>
<span id="cb17-142"><a href="#cb17-142" aria-hidden="true" tabindex="-1"></a>cbf_samples <span class="ot">&lt;-</span> </span>
<span id="cb17-143"><a href="#cb17-143" aria-hidden="true" tabindex="-1"></a>  fig1_data_main <span class="sc">%&gt;%</span> </span>
<span id="cb17-144"><a href="#cb17-144" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(population_n <span class="sc">&gt;</span> <span class="dv">100</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb17-145"><a href="#cb17-145" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(dat<span class="sc">==</span><span class="st">"cbf"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb17-146"><a href="#cb17-146" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(population, mean_size) <span class="sc">%&gt;%</span> </span>
<span id="cb17-147"><a href="#cb17-147" aria-hidden="true" tabindex="-1"></a>  <span class="fu">distinct</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb17-148"><a href="#cb17-148" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(mean_size) <span class="sc">%&gt;%</span> </span>
<span id="cb17-149"><a href="#cb17-149" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rownames_to_column</span>(<span class="st">"size_num"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb17-150"><a href="#cb17-150" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(size_num <span class="sc">%in%</span> <span class="fu">sample</span>(<span class="dv">1</span><span class="sc">:</span><span class="fu">nrow</span>(.), <span class="dv">2</span>))</span>
<span id="cb17-151"><a href="#cb17-151" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-152"><a href="#cb17-152" aria-hidden="true" tabindex="-1"></a>extra <span class="ot">&lt;-</span> </span>
<span id="cb17-153"><a href="#cb17-153" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tibble</span>(<span class="at">species =</span> <span class="fu">c</span>(range_bodysizes<span class="sc">$</span>population, </span>
<span id="cb17-154"><a href="#cb17-154" aria-hidden="true" tabindex="-1"></a>                     cbf_samples<span class="sc">$</span>population) <span class="sc">%&gt;%</span> </span>
<span id="cb17-155"><a href="#cb17-155" aria-hidden="true" tabindex="-1"></a>           <span class="fu">str_extract</span>(<span class="at">pattern =</span> <span class="st">".*(?=__)"</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb17-156"><a href="#cb17-156" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(species <span class="sc">%in%</span> {fig1_data_main <span class="sc">%&gt;%</span> <span class="fu">filter</span>(vector_icon) <span class="sc">%&gt;%</span> <span class="fu">pull</span>(species)})</span>
<span id="cb17-157"><a href="#cb17-157" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-158"><a href="#cb17-158" aria-hidden="true" tabindex="-1"></a>fig1b <span class="ot">&lt;-</span></span>
<span id="cb17-159"><a href="#cb17-159" aria-hidden="true" tabindex="-1"></a>  fig1_data_main <span class="sc">%&gt;%</span> </span>
<span id="cb17-160"><a href="#cb17-160" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(population <span class="sc">%in%</span> <span class="fu">c</span>(range_bodysizes<span class="sc">$</span>population, cbf_samples<span class="sc">$</span>population)) <span class="sc">%&gt;%</span></span>
<span id="cb17-161"><a href="#cb17-161" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">highlight_spp =</span> species <span class="sc">%in%</span> extra<span class="sc">$</span>species) <span class="sc">%&gt;%</span> </span>
<span id="cb17-162"><a href="#cb17-162" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>() <span class="sc">+</span></span>
<span id="cb17-163"><a href="#cb17-163" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">x =</span> scaled_size, </span>
<span id="cb17-164"><a href="#cb17-164" aria-hidden="true" tabindex="-1"></a>                <span class="at">y =</span> scaled_n,</span>
<span id="cb17-165"><a href="#cb17-165" aria-hidden="true" tabindex="-1"></a>                <span class="at">col =</span> dat,</span>
<span id="cb17-166"><a href="#cb17-166" aria-hidden="true" tabindex="-1"></a>                <span class="at">group =</span> population),</span>
<span id="cb17-167"><a href="#cb17-167" aria-hidden="true" tabindex="-1"></a>            <span class="at">alpha =</span> <span class="fl">0.5</span>, </span>
<span id="cb17-168"><a href="#cb17-168" aria-hidden="true" tabindex="-1"></a>            <span class="at">linewidth =</span> <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb17-169"><a href="#cb17-169" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">x =</span> scaled_size,</span>
<span id="cb17-170"><a href="#cb17-170" aria-hidden="true" tabindex="-1"></a>                <span class="at">y =</span> scaled_n,</span>
<span id="cb17-171"><a href="#cb17-171" aria-hidden="true" tabindex="-1"></a>                <span class="at">col =</span> dat,</span>
<span id="cb17-172"><a href="#cb17-172" aria-hidden="true" tabindex="-1"></a>                <span class="at">group =</span> population),</span>
<span id="cb17-173"><a href="#cb17-173" aria-hidden="true" tabindex="-1"></a>            <span class="at">data =</span> . <span class="sc">%&gt;%</span> <span class="fu">filter</span>(highlight_spp),</span>
<span id="cb17-174"><a href="#cb17-174" aria-hidden="true" tabindex="-1"></a>            <span class="at">linewidth =</span> <span class="fl">1.5</span>) <span class="sc">+</span></span>
<span id="cb17-175"><a href="#cb17-175" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">label =</span> <span class="fu">label_number</span>(<span class="at">suffix =</span> <span class="st">"x"</span>)) <span class="sc">+</span></span>
<span id="cb17-176"><a href="#cb17-176" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">"rls"</span> <span class="ot">=</span> <span class="st">"#56B4E9"</span>,</span>
<span id="cb17-177"><a href="#cb17-177" aria-hidden="true" tabindex="-1"></a>                                <span class="st">"cbf"</span> <span class="ot">=</span> <span class="st">"#E69F00"</span>),</span>
<span id="cb17-178"><a href="#cb17-178" aria-hidden="true" tabindex="-1"></a>                     <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"rls"</span> <span class="ot">=</span> <span class="st">"Visual census"</span>,</span>
<span id="cb17-179"><a href="#cb17-179" aria-hidden="true" tabindex="-1"></a>                                <span class="st">"cbf"</span> <span class="ot">=</span> <span class="st">"Cryptobenthic specimen collection"</span>)) <span class="sc">+</span></span>
<span id="cb17-180"><a href="#cb17-180" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_cowplot</span>(<span class="dv">20</span>) <span class="sc">+</span></span>
<span id="cb17-181"><a href="#cb17-181" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">1</span>), </span>
<span id="cb17-182"><a href="#cb17-182" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.justification =</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">1</span>),</span>
<span id="cb17-183"><a href="#cb17-183" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.title =</span> <span class="fu">element_blank</span>()) <span class="sc">+</span></span>
<span id="cb17-184"><a href="#cb17-184" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb17-185"><a href="#cb17-185" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> <span class="st">"Body size relative to mean size"</span>,</span>
<span id="cb17-186"><a href="#cb17-186" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span> <span class="st">"Abundance relative to max"</span></span>
<span id="cb17-187"><a href="#cb17-187" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb17-188"><a href="#cb17-188" aria-hidden="true" tabindex="-1"></a>  <span class="fu">guides</span>(<span class="at">col =</span> <span class="fu">guide_legend</span>(<span class="at">label.position =</span> <span class="st">"left"</span>))</span>
<span id="cb17-189"><a href="#cb17-189" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-190"><a href="#cb17-190" aria-hidden="true" tabindex="-1"></a>fig1 <span class="ot">&lt;-</span> </span>
<span id="cb17-191"><a href="#cb17-191" aria-hidden="true" tabindex="-1"></a>  fig1a <span class="sc">+</span> </span>
<span id="cb17-192"><a href="#cb17-192" aria-hidden="true" tabindex="-1"></a>  fig1b <span class="sc">+</span> </span>
<span id="cb17-193"><a href="#cb17-193" aria-hidden="true" tabindex="-1"></a>  <span class="fu">plot_layout</span>(<span class="at">ncol =</span> <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb17-194"><a href="#cb17-194" aria-hidden="true" tabindex="-1"></a>  <span class="fu">plot_annotation</span>(<span class="at">tag_levels =</span> <span class="st">'A'</span>)</span>
<span id="cb17-195"><a href="#cb17-195" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-196"><a href="#cb17-196" aria-hidden="true" tabindex="-1"></a><span class="fu">ggsave</span>(<span class="at">filename =</span> <span class="st">"ms_figs/scaling_distributions.png"</span>,</span>
<span id="cb17-197"><a href="#cb17-197" aria-hidden="true" tabindex="-1"></a>       <span class="at">plot =</span> fig1,</span>
<span id="cb17-198"><a href="#cb17-198" aria-hidden="true" tabindex="-1"></a>       <span class="at">height =</span> <span class="dv">25</span>,</span>
<span id="cb17-199"><a href="#cb17-199" aria-hidden="true" tabindex="-1"></a>       <span class="at">width =</span> <span class="dv">30</span>,</span>
<span id="cb17-200"><a href="#cb17-200" aria-hidden="true" tabindex="-1"></a>       <span class="at">units =</span> <span class="st">"cm"</span>, </span>
<span id="cb17-201"><a href="#cb17-201" aria-hidden="true" tabindex="-1"></a>       <span class="at">create.dir =</span> <span class="cn">TRUE</span>)</span>
<span id="cb17-202"><a href="#cb17-202" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-203"><a href="#cb17-203" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-204"><a href="#cb17-204" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb17-205"><a href="#cb17-205" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-206"><a href="#cb17-206" aria-hidden="true" tabindex="-1"></a>![Observed body length distributions across 3,228 fish populations show a similar unimodal shape. A) Observed individual body length distributions shown in thin solid lines with the median parameter estimates from normal-preferred and lognormal-preferred model fits shown as thick yellow and dark blue lines, respectively. Dashed lines in (A) show scaled body size (cell diameter) distributions of 13 freshwater protist species extracted from Giometto et al. (2013). B) A random selection of 12 populations for visualisation purposes; three species have been highlighted (thicker lines) to indicate that each line represents a population-level body length distribution. Binned body length data were normalized to the bin width to allow comparison with continuous body length data. Abundance density (y-axis) is scaled to the maximum abundance density of the population, and body size (x-axis) is scaled to the mean body size of the population.</span>
<span id="cb17-207"><a href="#cb17-207" aria-hidden="true" tabindex="-1"></a>The estimated CV values for fish length were consistent across three different spatial scales: population-level (Fig. 2), metapopulation or ecoregion-level20 (Extended Data Fig. 3), and the entire species-level (Fig. 2). The results were also similar when species that may be targeted by recreational or commercial fisheries (12% of total, n = 97 species) were removed from the analysis (Extended Data Fig. 4). Naturally, over short temporal and fine spatial scales, local recruitment and mortality events might increase the variability of size distributions and produce multimodal size frequencies, such as sometimes seen in fisheries samples, especially from highly seasonal species21,22. Multi-modality is likely to be rarer when body size data encompasses multiple sampling events and when seasonality is weaker, as is the case for our data. Only about 2% of coral reef and temperate rocky reef populations in our dataset revealed multiple peaks in body length frequencies (Extended Data Figs. 5).](ms_figs/scaling_distributions.png)</span>
<span id="cb17-208"><a href="#cb17-208" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-209"><a href="#cb17-209" aria-hidden="true" tabindex="-1"></a><span class="fu"># Figure 2</span></span>
<span id="cb17-210"><a href="#cb17-210" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-211"><a href="#cb17-211" aria-hidden="true" tabindex="-1"></a><span class="in">```{r fig2}</span></span>
<span id="cb17-212"><a href="#cb17-212" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-213"><a href="#cb17-213" aria-hidden="true" tabindex="-1"></a>inc_bimodal <span class="ot">&lt;-</span> <span class="cn">FALSE</span></span>
<span id="cb17-214"><a href="#cb17-214" aria-hidden="true" tabindex="-1"></a>inc_fished <span class="ot">&lt;-</span> <span class="cn">TRUE</span></span>
<span id="cb17-215"><a href="#cb17-215" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-216"><a href="#cb17-216" aria-hidden="true" tabindex="-1"></a>main_plot <span class="ot">&lt;-</span> <span class="cf">function</span>(.data) {</span>
<span id="cb17-217"><a href="#cb17-217" aria-hidden="true" tabindex="-1"></a>  .data <span class="sc">%&gt;%</span> </span>
<span id="cb17-218"><a href="#cb17-218" aria-hidden="true" tabindex="-1"></a>    <span class="fu">ggplot</span>() <span class="sc">+</span> </span>
<span id="cb17-219"><a href="#cb17-219" aria-hidden="true" tabindex="-1"></a>    <span class="fu">aes</span>(</span>
<span id="cb17-220"><a href="#cb17-220" aria-hidden="true" tabindex="-1"></a>      <span class="at">x =</span> mean_size, </span>
<span id="cb17-221"><a href="#cb17-221" aria-hidden="true" tabindex="-1"></a>      <span class="at">y =</span> cov_pref, </span>
<span id="cb17-222"><a href="#cb17-222" aria-hidden="true" tabindex="-1"></a>      <span class="at">pch =</span> col</span>
<span id="cb17-223"><a href="#cb17-223" aria-hidden="true" tabindex="-1"></a>    ) <span class="sc">+</span></span>
<span id="cb17-224"><a href="#cb17-224" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> <span class="fl">0.30</span>, <span class="at">lty =</span> <span class="dv">2</span>, <span class="at">col =</span> <span class="st">"black"</span>, <span class="at">alpha =</span> <span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb17-225"><a href="#cb17-225" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> <span class="fl">0.34</span>, <span class="at">lty =</span> <span class="dv">1</span>, <span class="at">col =</span> <span class="st">"#56B4E9"</span>, <span class="at">alpha =</span> <span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb17-226"><a href="#cb17-226" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> <span class="fl">0.37</span>, <span class="at">lty =</span> <span class="dv">1</span>, <span class="at">col =</span> <span class="st">"#CC79A7"</span>, <span class="at">alpha =</span> <span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb17-227"><a href="#cb17-227" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> <span class="fl">0.23</span>, <span class="at">lty =</span> <span class="dv">1</span>, <span class="at">col =</span> <span class="st">"#E69F00"</span>, <span class="at">alpha =</span> <span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb17-228"><a href="#cb17-228" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> <span class="fl">0.33</span>, <span class="at">lty =</span> <span class="dv">1</span>, <span class="at">col =</span> <span class="st">"#000000"</span>, <span class="at">alpha =</span> <span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb17-229"><a href="#cb17-229" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_point</span>(<span class="at">alpha =</span> <span class="dv">1</span>, </span>
<span id="cb17-230"><a href="#cb17-230" aria-hidden="true" tabindex="-1"></a>               <span class="fu">aes</span>(<span class="at">col =</span> col, </span>
<span id="cb17-231"><a href="#cb17-231" aria-hidden="true" tabindex="-1"></a>                   <span class="at">size =</span> (population_n <span class="sc">%&gt;%</span> <span class="fu">log10</span>()))) <span class="sc">+</span></span>
<span id="cb17-232"><a href="#cb17-232" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_point</span>(<span class="at">col =</span> <span class="st">"red"</span>,</span>
<span id="cb17-233"><a href="#cb17-233" aria-hidden="true" tabindex="-1"></a>               <span class="at">pch =</span> <span class="dv">4</span>, </span>
<span id="cb17-234"><a href="#cb17-234" aria-hidden="true" tabindex="-1"></a>               <span class="at">size =</span> <span class="dv">2</span>,</span>
<span id="cb17-235"><a href="#cb17-235" aria-hidden="true" tabindex="-1"></a>               <span class="at">data =</span> .data <span class="sc">%&gt;%</span> <span class="fu">filter</span>(bimodal)) <span class="sc">+</span></span>
<span id="cb17-236"><a href="#cb17-236" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_size_continuous</span>(<span class="at">range =</span> <span class="fu">c</span>(<span class="fl">0.1</span>,<span class="dv">5</span>),</span>
<span id="cb17-237"><a href="#cb17-237" aria-hidden="true" tabindex="-1"></a>                          <span class="at">breaks =</span> <span class="fu">c</span>(<span class="dv">2</span>,<span class="dv">3</span>,<span class="dv">5</span>),</span>
<span id="cb17-238"><a href="#cb17-238" aria-hidden="true" tabindex="-1"></a>                          <span class="at">labels =</span>  <span class="fu">c</span>(<span class="st">"100"</span>, <span class="st">"1K"</span>, <span class="st">"100K"</span>),</span>
<span id="cb17-239"><a href="#cb17-239" aria-hidden="true" tabindex="-1"></a>                          <span class="at">transform =</span> <span class="st">"log10"</span>, </span>
<span id="cb17-240"><a href="#cb17-240" aria-hidden="true" tabindex="-1"></a>                          <span class="at">name =</span> <span class="st">"Sample size"</span>) <span class="sc">+</span> </span>
<span id="cb17-241"><a href="#cb17-241" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_x_continuous</span>(<span class="at">transform =</span> <span class="st">"log10"</span>, </span>
<span id="cb17-242"><a href="#cb17-242" aria-hidden="true" tabindex="-1"></a>                       <span class="at">labels =</span> <span class="fu">label_number</span>(<span class="at">suffix=</span><span class="st">"cm"</span>), </span>
<span id="cb17-243"><a href="#cb17-243" aria-hidden="true" tabindex="-1"></a>                       <span class="at">limits =</span> <span class="fu">range</span>(.data<span class="sc">$</span>mean_size)) <span class="sc">+</span></span>
<span id="cb17-244"><a href="#cb17-244" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_shape_manual</span>(</span>
<span id="cb17-245"><a href="#cb17-245" aria-hidden="true" tabindex="-1"></a>      <span class="at">values =</span> <span class="fu">c</span>(</span>
<span id="cb17-246"><a href="#cb17-246" aria-hidden="true" tabindex="-1"></a>        <span class="st">"rls_norm"</span> <span class="ot">=</span> <span class="dv">21</span>, </span>
<span id="cb17-247"><a href="#cb17-247" aria-hidden="true" tabindex="-1"></a>        <span class="st">"rls_lnorm"</span> <span class="ot">=</span> <span class="dv">21</span>, </span>
<span id="cb17-248"><a href="#cb17-248" aria-hidden="true" tabindex="-1"></a>        <span class="st">"cbf_norm"</span> <span class="ot">=</span> <span class="dv">24</span>, </span>
<span id="cb17-249"><a href="#cb17-249" aria-hidden="true" tabindex="-1"></a>        <span class="st">"cbf_lnorm"</span> <span class="ot">=</span> <span class="dv">24</span>),</span>
<span id="cb17-250"><a href="#cb17-250" aria-hidden="true" tabindex="-1"></a>      <span class="at">label =</span> <span class="fu">c</span>(</span>
<span id="cb17-251"><a href="#cb17-251" aria-hidden="true" tabindex="-1"></a>        <span class="st">"rls_norm"</span> <span class="ot">=</span> <span class="st">"Visual census (normal preferred)"</span>, </span>
<span id="cb17-252"><a href="#cb17-252" aria-hidden="true" tabindex="-1"></a>        <span class="st">"rls_lnorm"</span> <span class="ot">=</span> <span class="st">"Visual census (lognormal preferred)"</span>, </span>
<span id="cb17-253"><a href="#cb17-253" aria-hidden="true" tabindex="-1"></a>        <span class="st">"cbf_norm"</span> <span class="ot">=</span> <span class="st">"Cryptobenthic (normal preferred)"</span>, </span>
<span id="cb17-254"><a href="#cb17-254" aria-hidden="true" tabindex="-1"></a>        <span class="st">"cbf_lnorm"</span> <span class="ot">=</span> <span class="st">"Cryptobenthic (lognormal preferred)"</span>)) <span class="sc">+</span></span>
<span id="cb17-255"><a href="#cb17-255" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_color_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(</span>
<span id="cb17-256"><a href="#cb17-256" aria-hidden="true" tabindex="-1"></a>      <span class="st">"rls_norm"</span> <span class="ot">=</span> <span class="st">"#56B4E9"</span>, </span>
<span id="cb17-257"><a href="#cb17-257" aria-hidden="true" tabindex="-1"></a>      <span class="st">"rls_lnorm"</span> <span class="ot">=</span> <span class="st">"#CC79A7"</span>, </span>
<span id="cb17-258"><a href="#cb17-258" aria-hidden="true" tabindex="-1"></a>      <span class="st">"cbf_norm"</span> <span class="ot">=</span> <span class="st">"#E69F00"</span>, </span>
<span id="cb17-259"><a href="#cb17-259" aria-hidden="true" tabindex="-1"></a>      <span class="st">"cbf_lnorm"</span> <span class="ot">=</span> <span class="st">"#000000"</span>),</span>
<span id="cb17-260"><a href="#cb17-260" aria-hidden="true" tabindex="-1"></a>      <span class="at">label =</span> <span class="fu">c</span>(</span>
<span id="cb17-261"><a href="#cb17-261" aria-hidden="true" tabindex="-1"></a>        <span class="st">"rls_norm"</span> <span class="ot">=</span> <span class="st">"Visual census (normal preferred)"</span>, </span>
<span id="cb17-262"><a href="#cb17-262" aria-hidden="true" tabindex="-1"></a>        <span class="st">"rls_lnorm"</span> <span class="ot">=</span> <span class="st">"Visual census (lognormal preferred)"</span>, </span>
<span id="cb17-263"><a href="#cb17-263" aria-hidden="true" tabindex="-1"></a>        <span class="st">"cbf_norm"</span> <span class="ot">=</span> <span class="st">"Cryptobenthic (normal preferred)"</span>, </span>
<span id="cb17-264"><a href="#cb17-264" aria-hidden="true" tabindex="-1"></a>        <span class="st">"cbf_lnorm"</span> <span class="ot">=</span> <span class="st">"Cryptobenthic (lognormal preferred)"</span>)) <span class="sc">+</span></span>
<span id="cb17-265"><a href="#cb17-265" aria-hidden="true" tabindex="-1"></a>    <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"Mean body length (log)"</span>, </span>
<span id="cb17-266"><a href="#cb17-266" aria-hidden="true" tabindex="-1"></a>         <span class="at">y =</span> <span class="st">"Coefficient of variation in body size"</span>) <span class="sc">+</span></span>
<span id="cb17-267"><a href="#cb17-267" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb17-268"><a href="#cb17-268" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme_cowplot</span>(<span class="dv">20</span>) <span class="sc">+</span></span>
<span id="cb17-269"><a href="#cb17-269" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"none"</span>, </span>
<span id="cb17-270"><a href="#cb17-270" aria-hidden="true" tabindex="-1"></a>          <span class="at">axis.title.y =</span> <span class="fu">element_blank</span>()</span>
<span id="cb17-271"><a href="#cb17-271" aria-hidden="true" tabindex="-1"></a>    ) </span>
<span id="cb17-272"><a href="#cb17-272" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb17-273"><a href="#cb17-273" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-274"><a href="#cb17-274" aria-hidden="true" tabindex="-1"></a>side_plot <span class="ot">&lt;-</span> <span class="cf">function</span>(.data, ylim){</span>
<span id="cb17-275"><a href="#cb17-275" aria-hidden="true" tabindex="-1"></a>  .data <span class="sc">%&gt;%</span> </span>
<span id="cb17-276"><a href="#cb17-276" aria-hidden="true" tabindex="-1"></a>    <span class="fu">ggplot</span>() <span class="sc">+</span></span>
<span id="cb17-277"><a href="#cb17-277" aria-hidden="true" tabindex="-1"></a>    <span class="fu">aes</span>(</span>
<span id="cb17-278"><a href="#cb17-278" aria-hidden="true" tabindex="-1"></a>      <span class="at">x =</span> cov_pref,</span>
<span id="cb17-279"><a href="#cb17-279" aria-hidden="true" tabindex="-1"></a>      <span class="at">fill =</span> col,</span>
<span id="cb17-280"><a href="#cb17-280" aria-hidden="true" tabindex="-1"></a>    ) <span class="sc">+</span></span>
<span id="cb17-281"><a href="#cb17-281" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_fill_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(</span>
<span id="cb17-282"><a href="#cb17-282" aria-hidden="true" tabindex="-1"></a>      <span class="st">"rls_norm"</span> <span class="ot">=</span> <span class="st">"#56B4E9"</span>, </span>
<span id="cb17-283"><a href="#cb17-283" aria-hidden="true" tabindex="-1"></a>      <span class="st">"rls_lnorm"</span> <span class="ot">=</span> <span class="st">"#CC79A7"</span>, </span>
<span id="cb17-284"><a href="#cb17-284" aria-hidden="true" tabindex="-1"></a>      <span class="st">"cbf_norm"</span> <span class="ot">=</span> <span class="st">"#E69F00"</span>, </span>
<span id="cb17-285"><a href="#cb17-285" aria-hidden="true" tabindex="-1"></a>      <span class="st">"cbf_lnorm"</span> <span class="ot">=</span> <span class="st">"#000000"</span>),</span>
<span id="cb17-286"><a href="#cb17-286" aria-hidden="true" tabindex="-1"></a>      <span class="at">label =</span> <span class="fu">c</span>(</span>
<span id="cb17-287"><a href="#cb17-287" aria-hidden="true" tabindex="-1"></a>        <span class="st">"rls_norm"</span> <span class="ot">=</span> <span class="st">"Visual census (normal preferred)"</span>, </span>
<span id="cb17-288"><a href="#cb17-288" aria-hidden="true" tabindex="-1"></a>        <span class="st">"rls_lnorm"</span> <span class="ot">=</span> <span class="st">"Visual census (lognormal preferred)"</span>, </span>
<span id="cb17-289"><a href="#cb17-289" aria-hidden="true" tabindex="-1"></a>        <span class="st">"cbf_norm"</span> <span class="ot">=</span> <span class="st">"Cryptobenthic (normal preferred)"</span>, </span>
<span id="cb17-290"><a href="#cb17-290" aria-hidden="true" tabindex="-1"></a>        <span class="st">"cbf_lnorm"</span> <span class="ot">=</span> <span class="st">"Cryptobenthic (lognormal preferred)"</span>))<span class="sc">+</span></span>
<span id="cb17-291"><a href="#cb17-291" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_density</span>(<span class="at">alpha =</span> <span class="fl">0.3</span>, <span class="at">col =</span> <span class="st">"black"</span>) <span class="sc">+</span></span>
<span id="cb17-292"><a href="#cb17-292" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_x_continuous</span>(<span class="at">position =</span> <span class="st">"top"</span>, </span>
<span id="cb17-293"><a href="#cb17-293" aria-hidden="true" tabindex="-1"></a>                       <span class="at">limits =</span> <span class="fu">c</span>(<span class="dv">0</span>, ylim)) <span class="sc">+</span></span>
<span id="cb17-294"><a href="#cb17-294" aria-hidden="true" tabindex="-1"></a>    <span class="fu">coord_flip</span>() <span class="sc">+</span></span>
<span id="cb17-295"><a href="#cb17-295" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"none"</span>, </span>
<span id="cb17-296"><a href="#cb17-296" aria-hidden="true" tabindex="-1"></a>          <span class="at">plot.background =</span> <span class="fu">element_rect</span>(<span class="at">fill =</span> <span class="st">"white"</span>),</span>
<span id="cb17-297"><a href="#cb17-297" aria-hidden="true" tabindex="-1"></a>          <span class="at">panel.background =</span> <span class="fu">element_rect</span>(<span class="at">fill =</span> <span class="st">"white"</span>),</span>
<span id="cb17-298"><a href="#cb17-298" aria-hidden="true" tabindex="-1"></a>          <span class="at">axis.line.x =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb17-299"><a href="#cb17-299" aria-hidden="true" tabindex="-1"></a>          <span class="at">axis.text.x =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb17-300"><a href="#cb17-300" aria-hidden="true" tabindex="-1"></a>          <span class="at">axis.title.x =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb17-301"><a href="#cb17-301" aria-hidden="true" tabindex="-1"></a>          <span class="at">axis.ticks.x =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb17-302"><a href="#cb17-302" aria-hidden="true" tabindex="-1"></a>          <span class="at">axis.line.y =</span> <span class="fu">element_line</span>(), </span>
<span id="cb17-303"><a href="#cb17-303" aria-hidden="true" tabindex="-1"></a>          <span class="at">axis.title.y =</span> <span class="fu">element_blank</span>(), </span>
<span id="cb17-304"><a href="#cb17-304" aria-hidden="true" tabindex="-1"></a>          <span class="at">axis.text.y =</span> <span class="fu">element_text</span>(<span class="at">margin =</span> <span class="fu">margin</span>(<span class="at">t =</span> <span class="dv">0</span>, </span>
<span id="cb17-305"><a href="#cb17-305" aria-hidden="true" tabindex="-1"></a>                                                     <span class="at">r =</span> <span class="dv">0</span>, </span>
<span id="cb17-306"><a href="#cb17-306" aria-hidden="true" tabindex="-1"></a>                                                     <span class="at">b =</span> <span class="dv">0</span>, </span>
<span id="cb17-307"><a href="#cb17-307" aria-hidden="true" tabindex="-1"></a>                                                     <span class="at">l =</span> <span class="dv">10</span>), </span>
<span id="cb17-308"><a href="#cb17-308" aria-hidden="true" tabindex="-1"></a>                                     <span class="at">size =</span> <span class="dv">15</span>), </span>
<span id="cb17-309"><a href="#cb17-309" aria-hidden="true" tabindex="-1"></a>          <span class="at">axis.ticks =</span> <span class="fu">element_line</span>(<span class="at">linewidth =</span> <span class="dv">1</span>, <span class="at">colour =</span> <span class="st">"black"</span>))</span>
<span id="cb17-310"><a href="#cb17-310" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb17-311"><a href="#cb17-311" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-312"><a href="#cb17-312" aria-hidden="true" tabindex="-1"></a>pop_data <span class="ot">&lt;-</span> </span>
<span id="cb17-313"><a href="#cb17-313" aria-hidden="true" tabindex="-1"></a>  fig2_data_pop <span class="sc">%&gt;%</span></span>
<span id="cb17-314"><a href="#cb17-314" aria-hidden="true" tabindex="-1"></a>  {<span class="cf">if</span>(inc_fished) . <span class="cf">else</span> <span class="fu">filter</span>(., <span class="sc">!</span>fished)} <span class="sc">%&gt;%</span> </span>
<span id="cb17-315"><a href="#cb17-315" aria-hidden="true" tabindex="-1"></a>  {<span class="cf">if</span>(inc_bimodal) . <span class="cf">else</span> <span class="fu">filter</span>(., <span class="sc">!</span>bimodal)} </span>
<span id="cb17-316"><a href="#cb17-316" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-317"><a href="#cb17-317" aria-hidden="true" tabindex="-1"></a>spp_data <span class="ot">&lt;-</span> </span>
<span id="cb17-318"><a href="#cb17-318" aria-hidden="true" tabindex="-1"></a>  fig2_data_spp <span class="sc">%&gt;%</span> </span>
<span id="cb17-319"><a href="#cb17-319" aria-hidden="true" tabindex="-1"></a>  {<span class="cf">if</span>(inc_fished) . <span class="cf">else</span> <span class="fu">filter</span>(., <span class="sc">!</span>fished)} <span class="sc">%&gt;%</span> </span>
<span id="cb17-320"><a href="#cb17-320" aria-hidden="true" tabindex="-1"></a>  {<span class="cf">if</span>(inc_bimodal) . <span class="cf">else</span> <span class="fu">filter</span>(., <span class="sc">!</span>bimodal)}</span>
<span id="cb17-321"><a href="#cb17-321" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-322"><a href="#cb17-322" aria-hidden="true" tabindex="-1"></a>plot_ylim <span class="ot">&lt;-</span> </span>
<span id="cb17-323"><a href="#cb17-323" aria-hidden="true" tabindex="-1"></a>  <span class="fu">max</span>(<span class="fu">layer_scales</span>(</span>
<span id="cb17-324"><a href="#cb17-324" aria-hidden="true" tabindex="-1"></a>    <span class="fu">main_plot</span>(pop_data))<span class="sc">$</span>y<span class="sc">$</span>range<span class="sc">$</span>range,</span>
<span id="cb17-325"><a href="#cb17-325" aria-hidden="true" tabindex="-1"></a>    <span class="fu">layer_scales</span>(</span>
<span id="cb17-326"><a href="#cb17-326" aria-hidden="true" tabindex="-1"></a>      <span class="fu">main_plot</span>(spp_data))<span class="sc">$</span>y<span class="sc">$</span>range<span class="sc">$</span>range)</span>
<span id="cb17-327"><a href="#cb17-327" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-328"><a href="#cb17-328" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-329"><a href="#cb17-329" aria-hidden="true" tabindex="-1"></a>fig2_main <span class="ot">&lt;-</span> </span>
<span id="cb17-330"><a href="#cb17-330" aria-hidden="true" tabindex="-1"></a>  <span class="fu">main_plot</span>(pop_data) <span class="sc">+</span> </span>
<span id="cb17-331"><a href="#cb17-331" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.title.x =</span> <span class="fu">element_blank</span>()) <span class="sc">+</span></span>
<span id="cb17-332"><a href="#cb17-332" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylim</span>(<span class="dv">0</span>, plot_ylim) <span class="sc">+</span></span>
<span id="cb17-333"><a href="#cb17-333" aria-hidden="true" tabindex="-1"></a>  <span class="fu">annotate</span>(<span class="st">"text"</span>,</span>
<span id="cb17-334"><a href="#cb17-334" aria-hidden="true" tabindex="-1"></a>           <span class="at">x =</span> <span class="dv">1</span>, </span>
<span id="cb17-335"><a href="#cb17-335" aria-hidden="true" tabindex="-1"></a>           <span class="at">hjust =</span> <span class="dv">0</span>, </span>
<span id="cb17-336"><a href="#cb17-336" aria-hidden="true" tabindex="-1"></a>           <span class="at">y =</span> plot_ylim<span class="sc">*</span><span class="fl">0.95</span>,</span>
<span id="cb17-337"><a href="#cb17-337" aria-hidden="true" tabindex="-1"></a>           <span class="at">label =</span> <span class="st">"Population-level"</span>,</span>
<span id="cb17-338"><a href="#cb17-338" aria-hidden="true" tabindex="-1"></a>           <span class="at">size =</span> <span class="dv">10</span>) <span class="sc">+</span></span>
<span id="cb17-339"><a href="#cb17-339" aria-hidden="true" tabindex="-1"></a>  <span class="fu">side_plot</span>(pop_data <span class="sc">%&gt;%</span> </span>
<span id="cb17-340"><a href="#cb17-340" aria-hidden="true" tabindex="-1"></a>              <span class="fu">filter</span>(col <span class="sc">!=</span> <span class="st">"cbf_lnorm"</span>), </span>
<span id="cb17-341"><a href="#cb17-341" aria-hidden="true" tabindex="-1"></a>            plot_ylim) <span class="sc">+</span> </span>
<span id="cb17-342"><a href="#cb17-342" aria-hidden="true" tabindex="-1"></a>  <span class="fu">main_plot</span>(spp_data) <span class="sc">+</span> <span class="fu">ylim</span>(<span class="dv">0</span>, plot_ylim) <span class="sc">+</span></span>
<span id="cb17-343"><a href="#cb17-343" aria-hidden="true" tabindex="-1"></a>  <span class="fu">annotate</span>(<span class="st">"text"</span>, </span>
<span id="cb17-344"><a href="#cb17-344" aria-hidden="true" tabindex="-1"></a>           <span class="at">x =</span> <span class="dv">1</span>, </span>
<span id="cb17-345"><a href="#cb17-345" aria-hidden="true" tabindex="-1"></a>           <span class="at">hjust =</span> <span class="dv">0</span>, </span>
<span id="cb17-346"><a href="#cb17-346" aria-hidden="true" tabindex="-1"></a>           <span class="at">y =</span> plot_ylim<span class="sc">*</span><span class="fl">0.95</span>,</span>
<span id="cb17-347"><a href="#cb17-347" aria-hidden="true" tabindex="-1"></a>           <span class="at">label =</span> <span class="st">"Species-level"</span>,</span>
<span id="cb17-348"><a href="#cb17-348" aria-hidden="true" tabindex="-1"></a>           <span class="at">size =</span> <span class="dv">10</span>) <span class="sc">+</span></span>
<span id="cb17-349"><a href="#cb17-349" aria-hidden="true" tabindex="-1"></a>  <span class="fu">side_plot</span>(spp_data <span class="sc">%&gt;%</span> <span class="fu">filter</span>(col <span class="sc">!=</span> <span class="st">"cbf_lnorm"</span>), </span>
<span id="cb17-350"><a href="#cb17-350" aria-hidden="true" tabindex="-1"></a>            plot_ylim)  <span class="sc">+</span></span>
<span id="cb17-351"><a href="#cb17-351" aria-hidden="true" tabindex="-1"></a>  <span class="fu">plot_layout</span>(<span class="at">design =</span> {<span class="st">"</span></span>
<span id="cb17-352"><a href="#cb17-352" aria-hidden="true" tabindex="-1"></a><span class="st">      AAAAAAB</span></span>
<span id="cb17-353"><a href="#cb17-353" aria-hidden="true" tabindex="-1"></a><span class="st">      AAAAAAB</span></span>
<span id="cb17-354"><a href="#cb17-354" aria-hidden="true" tabindex="-1"></a><span class="st">      CCCCCCD</span></span>
<span id="cb17-355"><a href="#cb17-355" aria-hidden="true" tabindex="-1"></a><span class="st">      CCCCCCD"</span></span>
<span id="cb17-356"><a href="#cb17-356" aria-hidden="true" tabindex="-1"></a>  })</span>
<span id="cb17-357"><a href="#cb17-357" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-358"><a href="#cb17-358" aria-hidden="true" tabindex="-1"></a>fig2_legend <span class="ot">&lt;-</span></span>
<span id="cb17-359"><a href="#cb17-359" aria-hidden="true" tabindex="-1"></a>  ggpubr<span class="sc">::</span><span class="fu">as_ggplot</span>(</span>
<span id="cb17-360"><a href="#cb17-360" aria-hidden="true" tabindex="-1"></a>    ggpubr<span class="sc">::</span><span class="fu">get_legend</span>(</span>
<span id="cb17-361"><a href="#cb17-361" aria-hidden="true" tabindex="-1"></a>      <span class="fu">main_plot</span>(pop_data) <span class="sc">+</span></span>
<span id="cb17-362"><a href="#cb17-362" aria-hidden="true" tabindex="-1"></a>        <span class="fu">theme</span>(<span class="at">axis.title =</span> <span class="fu">element_text</span>(), </span>
<span id="cb17-363"><a href="#cb17-363" aria-hidden="true" tabindex="-1"></a>              <span class="at">axis.text =</span> <span class="fu">element_text</span>()) <span class="sc">+</span></span>
<span id="cb17-364"><a href="#cb17-364" aria-hidden="true" tabindex="-1"></a>        <span class="fu">guides</span>(<span class="at">colour =</span> <span class="fu">guide_legend</span>(<span class="at">override.aes =</span> <span class="fu">list</span>(<span class="at">size=</span><span class="dv">5</span>, <span class="at">stroke =</span> <span class="dv">2</span>),</span>
<span id="cb17-365"><a href="#cb17-365" aria-hidden="true" tabindex="-1"></a>                                     <span class="at">nrow =</span> <span class="dv">2</span>,</span>
<span id="cb17-366"><a href="#cb17-366" aria-hidden="true" tabindex="-1"></a>                                     <span class="at">byrow =</span> <span class="cn">TRUE</span>,</span>
<span id="cb17-367"><a href="#cb17-367" aria-hidden="true" tabindex="-1"></a>                                     <span class="at">title =</span> <span class="fu">element_blank</span>()), </span>
<span id="cb17-368"><a href="#cb17-368" aria-hidden="true" tabindex="-1"></a>               <span class="at">pch =</span> <span class="fu">guide_legend</span>(<span class="at">nrow =</span> <span class="dv">2</span>,</span>
<span id="cb17-369"><a href="#cb17-369" aria-hidden="true" tabindex="-1"></a>                                  <span class="at">byrow =</span> <span class="cn">TRUE</span>,</span>
<span id="cb17-370"><a href="#cb17-370" aria-hidden="true" tabindex="-1"></a>                                  <span class="at">title =</span> <span class="fu">element_blank</span>())) <span class="sc">+</span></span>
<span id="cb17-371"><a href="#cb17-371" aria-hidden="true" tabindex="-1"></a>        <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"bottom"</span>, </span>
<span id="cb17-372"><a href="#cb17-372" aria-hidden="true" tabindex="-1"></a>              <span class="at">legend.box =</span> <span class="st">"vertical"</span>,</span>
<span id="cb17-373"><a href="#cb17-373" aria-hidden="true" tabindex="-1"></a>              <span class="at">legend.justification =</span> <span class="fu">c</span>(<span class="fl">0.5</span>,<span class="fl">0.5</span>),</span>
<span id="cb17-374"><a href="#cb17-374" aria-hidden="true" tabindex="-1"></a>              <span class="at">legend.background =</span> <span class="fu">element_rect</span>(<span class="at">color =</span> <span class="st">"black"</span>),</span>
<span id="cb17-375"><a href="#cb17-375" aria-hidden="true" tabindex="-1"></a>              <span class="at">legend.margin=</span><span class="fu">margin</span>(<span class="dv">5</span>,<span class="dv">5</span>,<span class="dv">5</span>,<span class="dv">6</span>),</span>
<span id="cb17-376"><a href="#cb17-376" aria-hidden="true" tabindex="-1"></a>              <span class="at">legend.title =</span> <span class="fu">element_text</span>()), </span>
<span id="cb17-377"><a href="#cb17-377" aria-hidden="true" tabindex="-1"></a>      </span>
<span id="cb17-378"><a href="#cb17-378" aria-hidden="true" tabindex="-1"></a>    )) </span>
<span id="cb17-379"><a href="#cb17-379" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-380"><a href="#cb17-380" aria-hidden="true" tabindex="-1"></a>fig2_yaxis <span class="ot">&lt;-</span> </span>
<span id="cb17-381"><a href="#cb17-381" aria-hidden="true" tabindex="-1"></a>  <span class="fu">wrap_elements</span>(fig2_main) <span class="sc">+</span></span>
<span id="cb17-382"><a href="#cb17-382" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">tag =</span> <span class="st">"Coeffient of variation in body size"</span>) <span class="sc">+</span></span>
<span id="cb17-383"><a href="#cb17-383" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(</span>
<span id="cb17-384"><a href="#cb17-384" aria-hidden="true" tabindex="-1"></a>    <span class="at">plot.tag =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">20</span>, <span class="at">angle =</span> <span class="dv">90</span>),</span>
<span id="cb17-385"><a href="#cb17-385" aria-hidden="true" tabindex="-1"></a>    <span class="at">plot.tag.position =</span> <span class="st">"left"</span></span>
<span id="cb17-386"><a href="#cb17-386" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb17-387"><a href="#cb17-387" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-388"><a href="#cb17-388" aria-hidden="true" tabindex="-1"></a>fig2 <span class="ot">&lt;-</span> </span>
<span id="cb17-389"><a href="#cb17-389" aria-hidden="true" tabindex="-1"></a>  fig2_yaxis <span class="sc">+</span> </span>
<span id="cb17-390"><a href="#cb17-390" aria-hidden="true" tabindex="-1"></a>  fig2_legend <span class="sc">+</span></span>
<span id="cb17-391"><a href="#cb17-391" aria-hidden="true" tabindex="-1"></a>  <span class="fu">plot_layout</span>(<span class="at">design =</span> {<span class="st">"</span></span>
<span id="cb17-392"><a href="#cb17-392" aria-hidden="true" tabindex="-1"></a><span class="st">      AAAAAAA</span></span>
<span id="cb17-393"><a href="#cb17-393" aria-hidden="true" tabindex="-1"></a><span class="st">      AAAAAAA</span></span>
<span id="cb17-394"><a href="#cb17-394" aria-hidden="true" tabindex="-1"></a><span class="st">      AAAAAAA</span></span>
<span id="cb17-395"><a href="#cb17-395" aria-hidden="true" tabindex="-1"></a><span class="st">      AAAAAAA</span></span>
<span id="cb17-396"><a href="#cb17-396" aria-hidden="true" tabindex="-1"></a><span class="st">            #BBBBB#"</span></span>
<span id="cb17-397"><a href="#cb17-397" aria-hidden="true" tabindex="-1"></a>  })</span>
<span id="cb17-398"><a href="#cb17-398" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-399"><a href="#cb17-399" aria-hidden="true" tabindex="-1"></a><span class="fu">ggsave</span>(<span class="at">filename =</span> <span class="st">"ms_figs/cv_meansize.png"</span>,</span>
<span id="cb17-400"><a href="#cb17-400" aria-hidden="true" tabindex="-1"></a>       <span class="at">plot =</span> fig2,</span>
<span id="cb17-401"><a href="#cb17-401" aria-hidden="true" tabindex="-1"></a>       <span class="at">height =</span> <span class="dv">20</span>,</span>
<span id="cb17-402"><a href="#cb17-402" aria-hidden="true" tabindex="-1"></a>       <span class="at">width =</span> <span class="dv">20</span><span class="sc">*</span><span class="fl">1.618</span>,</span>
<span id="cb17-403"><a href="#cb17-403" aria-hidden="true" tabindex="-1"></a>       <span class="at">units =</span> <span class="st">"cm"</span>, </span>
<span id="cb17-404"><a href="#cb17-404" aria-hidden="true" tabindex="-1"></a>       <span class="at">create.dir =</span> <span class="cn">TRUE</span>)</span>
<span id="cb17-405"><a href="#cb17-405" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb17-406"><a href="#cb17-406" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-407"><a href="#cb17-407" aria-hidden="true" tabindex="-1"></a><span class="al">![Coefficient of variation (CV) of body length distributions of ca 3000 fish populations of larger bodied species (visual census and largest cryptobenthic fish) is approximately 0.34, regardless of the mean body length of the population and the assumed statistical distribution. Each symbol shows the CV value of a single fish population (grid cell, see Methods) or species. The color and shape of the symbol indicates the better-fitting statistical distribution and the sampling method. CV (y-axis) is calculated as the median of the posterior parameters associated with the better-fit distribution. Colored horizonal lines represent the median CV values, dashed line shows the estimated CV value of protists from Giometto et al.13. Margin density plots show the distribution of CV values across populations; for cryptobenthic lognormal preferred (black triangles), marginal plots are not shown due to small sample sizes (n = 9 populations). Symbol size is relative to the sample size (log scale).](ms_figs/cv_meansize.png)</span></span>
<span id="cb17-408"><a href="#cb17-408" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-409"><a href="#cb17-409" aria-hidden="true" tabindex="-1"></a><span class="fu"># Figure 3</span></span>
<span id="cb17-410"><a href="#cb17-410" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-411"><a href="#cb17-411" aria-hidden="true" tabindex="-1"></a><span class="in">```{r fig3}</span></span>
<span id="cb17-412"><a href="#cb17-412" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-413"><a href="#cb17-413" aria-hidden="true" tabindex="-1"></a>make_plot <span class="ot">&lt;-</span> <span class="cf">function</span>(data, title){</span>
<span id="cb17-414"><a href="#cb17-414" aria-hidden="true" tabindex="-1"></a>  data <span class="sc">%&gt;%</span> </span>
<span id="cb17-415"><a href="#cb17-415" aria-hidden="true" tabindex="-1"></a>    <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> size_class,</span>
<span id="cb17-416"><a href="#cb17-416" aria-hidden="true" tabindex="-1"></a>               <span class="at">y =</span> p_obs, </span>
<span id="cb17-417"><a href="#cb17-417" aria-hidden="true" tabindex="-1"></a>               <span class="at">width =</span> size_max<span class="sc">-</span>size_min)) <span class="sc">+</span></span>
<span id="cb17-418"><a href="#cb17-418" aria-hidden="true" tabindex="-1"></a>    <span class="fu">facet_wrap</span>(<span class="sc">~</span>species, <span class="at">ncol =</span> <span class="dv">2</span>, <span class="at">scales =</span> <span class="st">"free"</span>) <span class="sc">+</span></span>
<span id="cb17-419"><a href="#cb17-419" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_vline</span>(<span class="fu">aes</span>(<span class="at">xintercept =</span> mean_size), <span class="at">lty =</span> <span class="dv">2</span>, <span class="at">linewidth =</span> <span class="fl">1.5</span>) <span class="sc">+</span></span>
<span id="cb17-420"><a href="#cb17-420" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_rect</span>(<span class="fu">aes</span>(<span class="at">xmin =</span> size_min, <span class="at">xmax =</span> size_max, <span class="at">ymin =</span> <span class="dv">0</span>, <span class="at">ymax =</span> p_obs), </span>
<span id="cb17-421"><a href="#cb17-421" aria-hidden="true" tabindex="-1"></a>              <span class="at">alpha =</span> <span class="fl">0.2</span>, </span>
<span id="cb17-422"><a href="#cb17-422" aria-hidden="true" tabindex="-1"></a>              <span class="at">col =</span> <span class="st">"black"</span>,</span>
<span id="cb17-423"><a href="#cb17-423" aria-hidden="true" tabindex="-1"></a>              <span class="at">fill =</span> <span class="st">"grey70"</span>) <span class="sc">+</span> </span>
<span id="cb17-424"><a href="#cb17-424" aria-hidden="true" tabindex="-1"></a>    <span class="co"># geom_point(aes(col = name, y = value, alpha = alp)) +</span></span>
<span id="cb17-425"><a href="#cb17-425" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_path</span>(<span class="fu">aes</span>(<span class="at">col =</span> name, <span class="at">y =</span> value, <span class="at">alpha =</span> alp, <span class="at">lty=</span>lty), <span class="at">linewidth =</span> <span class="dv">2</span>) <span class="sc">+</span></span>
<span id="cb17-426"><a href="#cb17-426" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_alpha_identity</span>()<span class="sc">+</span></span>
<span id="cb17-427"><a href="#cb17-427" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_linetype_identity</span>() <span class="sc">+</span></span>
<span id="cb17-428"><a href="#cb17-428" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_colour_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">"p_norm"</span> <span class="ot">=</span> <span class="fu">rgb</span>(<span class="dv">181</span>, <span class="dv">144</span>, <span class="dv">19</span>, <span class="at">maxColorValue=</span><span class="dv">255</span>), </span>
<span id="cb17-429"><a href="#cb17-429" aria-hidden="true" tabindex="-1"></a>                                   <span class="st">"p_lnorm"</span> <span class="ot">=</span> <span class="fu">rgb</span>(<span class="dv">29</span>, <span class="dv">84</span>, <span class="dv">128</span>, <span class="at">maxColorValue=</span><span class="dv">255</span>)))<span class="sc">+</span></span>
<span id="cb17-430"><a href="#cb17-430" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme_cowplot</span>(<span class="dv">20</span>) <span class="sc">+</span></span>
<span id="cb17-431"><a href="#cb17-431" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_y_continuous</span>(<span class="at">label =</span> <span class="fu">label_percent</span>())<span class="sc">+</span></span>
<span id="cb17-432"><a href="#cb17-432" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_x_continuous</span>(<span class="at">label =</span> <span class="fu">label_number</span>()) <span class="sc">+</span></span>
<span id="cb17-433"><a href="#cb17-433" aria-hidden="true" tabindex="-1"></a>    <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"Length class (cm)"</span>, </span>
<span id="cb17-434"><a href="#cb17-434" aria-hidden="true" tabindex="-1"></a>         <span class="at">y =</span> <span class="st">"Proportion in length class"</span>) <span class="sc">+</span></span>
<span id="cb17-435"><a href="#cb17-435" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"none"</span>,</span>
<span id="cb17-436"><a href="#cb17-436" aria-hidden="true" tabindex="-1"></a>          <span class="at">strip.background =</span> <span class="fu">element_rect</span>(</span>
<span id="cb17-437"><a href="#cb17-437" aria-hidden="true" tabindex="-1"></a>            <span class="at">colour =</span> <span class="st">"black"</span>,</span>
<span id="cb17-438"><a href="#cb17-438" aria-hidden="true" tabindex="-1"></a>            <span class="at">fill =</span> <span class="st">"white"</span>), </span>
<span id="cb17-439"><a href="#cb17-439" aria-hidden="true" tabindex="-1"></a>          <span class="at">strip.text =</span> <span class="fu">element_text</span>(<span class="at">face =</span> <span class="st">"italic"</span>), </span>
<span id="cb17-440"><a href="#cb17-440" aria-hidden="true" tabindex="-1"></a>          <span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">hjust =</span> <span class="fl">0.5</span>)) <span class="sc">+</span></span>
<span id="cb17-441"><a href="#cb17-441" aria-hidden="true" tabindex="-1"></a>    <span class="fu">ggtitle</span>(<span class="at">label =</span> title)</span>
<span id="cb17-442"><a href="#cb17-442" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb17-443"><a href="#cb17-443" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-444"><a href="#cb17-444" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-445"><a href="#cb17-445" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-446"><a href="#cb17-446" aria-hidden="true" tabindex="-1"></a>fig3a <span class="ot">&lt;-</span> </span>
<span id="cb17-447"><a href="#cb17-447" aria-hidden="true" tabindex="-1"></a>  fig3_data <span class="sc">%&gt;%</span> </span>
<span id="cb17-448"><a href="#cb17-448" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(pref <span class="sc">==</span> <span class="st">"lnorm_pref"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb17-449"><a href="#cb17-449" aria-hidden="true" tabindex="-1"></a>  <span class="fu">make_plot</span>(<span class="st">"Strong preference for lognormal"</span>)</span>
<span id="cb17-450"><a href="#cb17-450" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-451"><a href="#cb17-451" aria-hidden="true" tabindex="-1"></a>fig3b <span class="ot">&lt;-</span> </span>
<span id="cb17-452"><a href="#cb17-452" aria-hidden="true" tabindex="-1"></a>  fig3_data <span class="sc">%&gt;%</span> </span>
<span id="cb17-453"><a href="#cb17-453" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(pref <span class="sc">==</span> <span class="st">"no_pref"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb17-454"><a href="#cb17-454" aria-hidden="true" tabindex="-1"></a>  <span class="fu">make_plot</span>(<span class="st">"No preference for normal or lognormal"</span>)</span>
<span id="cb17-455"><a href="#cb17-455" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-456"><a href="#cb17-456" aria-hidden="true" tabindex="-1"></a>fig3c <span class="ot">&lt;-</span> </span>
<span id="cb17-457"><a href="#cb17-457" aria-hidden="true" tabindex="-1"></a>  fig3_data <span class="sc">%&gt;%</span> </span>
<span id="cb17-458"><a href="#cb17-458" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(pref <span class="sc">==</span> <span class="st">"norm_pref"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb17-459"><a href="#cb17-459" aria-hidden="true" tabindex="-1"></a>  <span class="fu">make_plot</span>(<span class="st">"Strong preference for normal"</span>)</span>
<span id="cb17-460"><a href="#cb17-460" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-461"><a href="#cb17-461" aria-hidden="true" tabindex="-1"></a>ks_curve <span class="ot">&lt;-</span> </span>
<span id="cb17-462"><a href="#cb17-462" aria-hidden="true" tabindex="-1"></a>  fig3_data_ks <span class="sc">%&gt;%</span> </span>
<span id="cb17-463"><a href="#cb17-463" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(<span class="at">cols =</span> <span class="fu">contains</span>(<span class="st">"ks"</span>), </span>
<span id="cb17-464"><a href="#cb17-464" aria-hidden="true" tabindex="-1"></a>               <span class="at">values_to =</span> <span class="st">"ks"</span>,</span>
<span id="cb17-465"><a href="#cb17-465" aria-hidden="true" tabindex="-1"></a>               <span class="at">names_to =</span> <span class="st">"dist"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb17-466"><a href="#cb17-466" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">mean_ks =</span> <span class="fu">mean</span>(ks), </span>
<span id="cb17-467"><a href="#cb17-467" aria-hidden="true" tabindex="-1"></a>            <span class="at">median_ks =</span> <span class="fu">median</span>(ks), </span>
<span id="cb17-468"><a href="#cb17-468" aria-hidden="true" tabindex="-1"></a>            <span class="at">lwr_ks =</span> <span class="fu">quantile</span>(ks, <span class="fl">0.025</span>), </span>
<span id="cb17-469"><a href="#cb17-469" aria-hidden="true" tabindex="-1"></a>            <span class="at">upr_ks =</span> <span class="fu">quantile</span>(ks, <span class="fl">0.875</span>), </span>
<span id="cb17-470"><a href="#cb17-470" aria-hidden="true" tabindex="-1"></a>            <span class="at">.by =</span> <span class="fu">c</span>(c, dist)) <span class="sc">%&gt;%</span> </span>
<span id="cb17-471"><a href="#cb17-471" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> c, </span>
<span id="cb17-472"><a href="#cb17-472" aria-hidden="true" tabindex="-1"></a>             <span class="at">y =</span> mean_ks, </span>
<span id="cb17-473"><a href="#cb17-473" aria-hidden="true" tabindex="-1"></a>             <span class="at">color =</span> dist)) <span class="sc">+</span></span>
<span id="cb17-474"><a href="#cb17-474" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">linewidth =</span> <span class="dv">2</span>, <span class="at">alpha =</span> <span class="fl">0.8</span>) <span class="sc">+</span></span>
<span id="cb17-475"><a href="#cb17-475" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">"norm_ks"</span> <span class="ot">=</span> <span class="fu">rgb</span>(<span class="dv">181</span>, <span class="dv">144</span>, <span class="dv">19</span>, <span class="at">maxColorValue=</span><span class="dv">255</span>),</span>
<span id="cb17-476"><a href="#cb17-476" aria-hidden="true" tabindex="-1"></a>                                <span class="st">"lnorm_ks"</span> <span class="ot">=</span> <span class="fu">rgb</span>(<span class="dv">29</span>, <span class="dv">84</span>, <span class="dv">128</span>, <span class="at">maxColorValue=</span><span class="dv">255</span>), </span>
<span id="cb17-477"><a href="#cb17-477" aria-hidden="true" tabindex="-1"></a>                                <span class="st">"pref_ks"</span> <span class="ot">=</span> <span class="st">"pink"</span>),</span>
<span id="cb17-478"><a href="#cb17-478" aria-hidden="true" tabindex="-1"></a>                     <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"norm_ks"</span> <span class="ot">=</span> <span class="st">"Normal"</span>,</span>
<span id="cb17-479"><a href="#cb17-479" aria-hidden="true" tabindex="-1"></a>                                <span class="st">"lnorm_ks"</span> <span class="ot">=</span> <span class="st">"Lognormal"</span>,                                 <span class="st">"pref_ks"</span> <span class="ot">=</span> <span class="st">"Preferred"</span>)) <span class="sc">+</span></span>
<span id="cb17-480"><a href="#cb17-480" aria-hidden="true" tabindex="-1"></a>  <span class="fu">guides</span>(<span class="at">color =</span> <span class="fu">guide_legend</span>(<span class="at">override.aes =</span> <span class="fu">list</span>(<span class="at">alpha =</span> <span class="dv">1</span>) ) ) <span class="sc">+</span></span>
<span id="cb17-481"><a href="#cb17-481" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>() <span class="sc">+</span></span>
<span id="cb17-482"><a href="#cb17-482" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"Assumed Coefficient of Variation"</span>, </span>
<span id="cb17-483"><a href="#cb17-483" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">"Dissimilarity (K-S statistic)"</span>) <span class="sc">+</span></span>
<span id="cb17-484"><a href="#cb17-484" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_cowplot</span>(<span class="dv">20</span>) <span class="sc">+</span></span>
<span id="cb17-485"><a href="#cb17-485" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="fu">c</span>(<span class="fl">0.95</span>,<span class="fl">0.05</span>), </span>
<span id="cb17-486"><a href="#cb17-486" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.justification =</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">0</span>),</span>
<span id="cb17-487"><a href="#cb17-487" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.title =</span> <span class="fu">element_blank</span>(), </span>
<span id="cb17-488"><a href="#cb17-488" aria-hidden="true" tabindex="-1"></a>        <span class="at">plot.background =</span> <span class="fu">element_rect</span>(<span class="at">color =</span> <span class="st">"transparent"</span>)) </span>
<span id="cb17-489"><a href="#cb17-489" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-490"><a href="#cb17-490" aria-hidden="true" tabindex="-1"></a>fig3 <span class="ot">&lt;-</span>  </span>
<span id="cb17-491"><a href="#cb17-491" aria-hidden="true" tabindex="-1"></a>  fig3a <span class="sc">+</span> </span>
<span id="cb17-492"><a href="#cb17-492" aria-hidden="true" tabindex="-1"></a>  fig3b <span class="sc">+</span> </span>
<span id="cb17-493"><a href="#cb17-493" aria-hidden="true" tabindex="-1"></a>  fig3c <span class="sc">+</span> </span>
<span id="cb17-494"><a href="#cb17-494" aria-hidden="true" tabindex="-1"></a>  ks_curve <span class="sc">+</span></span>
<span id="cb17-495"><a href="#cb17-495" aria-hidden="true" tabindex="-1"></a>  <span class="fu">plot_annotation</span>(<span class="at">tag_levels =</span> <span class="st">'A'</span>)</span>
<span id="cb17-496"><a href="#cb17-496" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-497"><a href="#cb17-497" aria-hidden="true" tabindex="-1"></a><span class="fu">ggsave</span>(<span class="at">filename =</span> <span class="st">"ms_figs/ks_curve.png"</span>,</span>
<span id="cb17-498"><a href="#cb17-498" aria-hidden="true" tabindex="-1"></a>       <span class="at">plot =</span> fig3,</span>
<span id="cb17-499"><a href="#cb17-499" aria-hidden="true" tabindex="-1"></a>       <span class="at">height =</span> <span class="dv">25</span>,</span>
<span id="cb17-500"><a href="#cb17-500" aria-hidden="true" tabindex="-1"></a>       <span class="at">width =</span> <span class="dv">25</span><span class="sc">*</span><span class="fl">1.618</span>,</span>
<span id="cb17-501"><a href="#cb17-501" aria-hidden="true" tabindex="-1"></a>       <span class="at">units =</span> <span class="st">"cm"</span>)</span>
<span id="cb17-502"><a href="#cb17-502" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-503"><a href="#cb17-503" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb17-504"><a href="#cb17-504" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-505"><a href="#cb17-505" aria-hidden="true" tabindex="-1"></a><span class="al">![Empirical body size distributions (grey bars) can be reconstructed from the mean body size of the population (vertical black dashed line) and assumed CV of 0.34. Panels A-C show randomly selected populations from one of three population groups for which body size distributions were best described by lognormal, normal or either of the two statistical distributions. Grey bars show observed data and lines show predicted distributions assuming either truncated normal or lognormal statistical distribution and CV of 0.34. Panel D shows that assuming CV of 0.34 provides the best fitting distributions with lowest median Kolmogorov-Smirnov (K-S) statistic across all populations regardless of the assumed statistical distribution (lognormal for all 3000 populations, truncated normal for all, or estimated using the best fitting distribution). Lower or higher CV values quickly reduced the predictive power, shown by higher K-S values.](ms_figs/ks_curve.png)</span></span>
<span id="cb17-506"><a href="#cb17-506" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-507"><a href="#cb17-507" aria-hidden="true" tabindex="-1"></a><span class="fu"># Figure 4</span></span>
<span id="cb17-508"><a href="#cb17-508" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-509"><a href="#cb17-509" aria-hidden="true" tabindex="-1"></a><span class="in">```{r fig4}</span></span>
<span id="cb17-510"><a href="#cb17-510" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-511"><a href="#cb17-511" aria-hidden="true" tabindex="-1"></a>make_fig4 <span class="ot">&lt;-</span> <span class="cf">function</span>(data, spp_select){</span>
<span id="cb17-512"><a href="#cb17-512" aria-hidden="true" tabindex="-1"></a>  dat1 <span class="ot">&lt;-</span> </span>
<span id="cb17-513"><a href="#cb17-513" aria-hidden="true" tabindex="-1"></a>    data <span class="sc">%&gt;%</span> </span>
<span id="cb17-514"><a href="#cb17-514" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(species <span class="sc">==</span> spp_select) </span>
<span id="cb17-515"><a href="#cb17-515" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb17-516"><a href="#cb17-516" aria-hidden="true" tabindex="-1"></a>  dat1 <span class="sc">%&gt;%</span> </span>
<span id="cb17-517"><a href="#cb17-517" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(name <span class="sc">!=</span> <span class="st">"p_lnorm"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb17-518"><a href="#cb17-518" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(name <span class="sc">!=</span> <span class="st">"rls_obs"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb17-519"><a href="#cb17-519" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">species =</span> <span class="fu">fct_reorder</span>(species, std_mk)) <span class="sc">%&gt;%</span> </span>
<span id="cb17-520"><a href="#cb17-520" aria-hidden="true" tabindex="-1"></a>    <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> size_class, </span>
<span id="cb17-521"><a href="#cb17-521" aria-hidden="true" tabindex="-1"></a>               <span class="at">y =</span> value)) <span class="sc">+</span></span>
<span id="cb17-522"><a href="#cb17-522" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_rect</span>(<span class="fu">aes</span>(<span class="at">xmin =</span> size_min, </span>
<span id="cb17-523"><a href="#cb17-523" aria-hidden="true" tabindex="-1"></a>                  <span class="at">xmax =</span> size_max, </span>
<span id="cb17-524"><a href="#cb17-524" aria-hidden="true" tabindex="-1"></a>                  <span class="at">ymin =</span> <span class="dv">0</span>, </span>
<span id="cb17-525"><a href="#cb17-525" aria-hidden="true" tabindex="-1"></a>                  <span class="at">ymax =</span> value, </span>
<span id="cb17-526"><a href="#cb17-526" aria-hidden="true" tabindex="-1"></a>                  <span class="at">fill =</span> size_10), </span>
<span id="cb17-527"><a href="#cb17-527" aria-hidden="true" tabindex="-1"></a>              <span class="at">col =</span> <span class="st">"black"</span>,</span>
<span id="cb17-528"><a href="#cb17-528" aria-hidden="true" tabindex="-1"></a>              <span class="at">data =</span> dat1 <span class="sc">%&gt;%</span> </span>
<span id="cb17-529"><a href="#cb17-529" aria-hidden="true" tabindex="-1"></a>                <span class="fu">filter</span>(name <span class="sc">==</span> <span class="st">"rls_obs"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb17-530"><a href="#cb17-530" aria-hidden="true" tabindex="-1"></a>                <span class="fu">mutate</span>(<span class="at">size_10 =</span> <span class="fu">case_when</span>(size_class <span class="sc">&gt;=</span> <span class="dv">10</span> <span class="sc">~</span> <span class="st">"large"</span>, </span>
<span id="cb17-531"><a href="#cb17-531" aria-hidden="true" tabindex="-1"></a>                                           <span class="cn">TRUE</span> <span class="sc">~</span> <span class="st">"small"</span>))) <span class="sc">+</span></span>
<span id="cb17-532"><a href="#cb17-532" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_fill_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">"large"</span> <span class="ot">=</span> <span class="st">"grey70"</span>, </span>
<span id="cb17-533"><a href="#cb17-533" aria-hidden="true" tabindex="-1"></a>                                 <span class="st">"small"</span> <span class="ot">=</span> <span class="st">"grey90"</span>),</span>
<span id="cb17-534"><a href="#cb17-534" aria-hidden="true" tabindex="-1"></a>                      <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"large"</span> <span class="ot">=</span> <span class="st">"Observed (Length \U2265 10cm)"</span>, </span>
<span id="cb17-535"><a href="#cb17-535" aria-hidden="true" tabindex="-1"></a>                                 <span class="st">"small"</span> <span class="ot">=</span> <span class="st">"Observed (Length \U003C 10cm)"</span>)) <span class="sc">+</span></span>
<span id="cb17-536"><a href="#cb17-536" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_color_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">"p_norm"</span> <span class="ot">=</span> <span class="fu">rgb</span>(<span class="dv">181</span>, <span class="dv">144</span>, <span class="dv">19</span>, <span class="at">maxColorValue=</span><span class="dv">255</span>), </span>
<span id="cb17-537"><a href="#cb17-537" aria-hidden="true" tabindex="-1"></a>                                  <span class="st">"lbspr"</span> <span class="ot">=</span> <span class="fu">rgb</span>(<span class="dv">148</span>, <span class="dv">31</span>, <span class="dv">36</span>, <span class="at">maxColorValue=</span><span class="dv">255</span>), </span>
<span id="cb17-538"><a href="#cb17-538" aria-hidden="true" tabindex="-1"></a>                                  <span class="st">"lbspr_mk15"</span> <span class="ot">=</span> <span class="fu">rgb</span>(<span class="dv">70</span>, <span class="dv">172</span>, <span class="dv">200</span>, <span class="at">maxColorValue=</span><span class="dv">255</span>)),</span>
<span id="cb17-539"><a href="#cb17-539" aria-hidden="true" tabindex="-1"></a>                       <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"lbspr"</span> <span class="ot">=</span> <span class="st">"LBSPR (estimate)"</span>, </span>
<span id="cb17-540"><a href="#cb17-540" aria-hidden="true" tabindex="-1"></a>                                  <span class="st">"lbspr_mk15"</span> <span class="ot">=</span> <span class="st">"LBSPR (M/k = 1.5, estimate)"</span>,</span>
<span id="cb17-541"><a href="#cb17-541" aria-hidden="true" tabindex="-1"></a>                                  <span class="st">"p_norm"</span> <span class="ot">=</span> <span class="st">"Normal (estimate)"</span>)) <span class="sc">+</span></span>
<span id="cb17-542"><a href="#cb17-542" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_vline</span>(<span class="at">xintercept =</span> <span class="fl">8.75</span>, <span class="at">lty =</span> <span class="dv">2</span>) <span class="sc">+</span></span>
<span id="cb17-543"><a href="#cb17-543" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_path</span>(<span class="fu">aes</span>(<span class="at">col =</span> name), <span class="at">linewidth =</span> <span class="dv">2</span>, <span class="at">alpha =</span> <span class="fl">0.8</span>) <span class="sc">+</span></span>
<span id="cb17-544"><a href="#cb17-544" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_text</span>(<span class="fu">aes</span>(<span class="at">x =</span> <span class="cn">Inf</span>, <span class="at">y =</span> <span class="cn">Inf</span>, <span class="at">label =</span> <span class="fu">paste</span>(<span class="st">"M/k ="</span>, std_mk, <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>, </span>
<span id="cb17-545"><a href="#cb17-545" aria-hidden="true" tabindex="-1"></a>                                                  <span class="st">"L\U221E ="</span>, std_linf, <span class="st">"cm"</span>)),</span>
<span id="cb17-546"><a href="#cb17-546" aria-hidden="true" tabindex="-1"></a>              <span class="at">hjust =</span> <span class="dv">1</span>,</span>
<span id="cb17-547"><a href="#cb17-547" aria-hidden="true" tabindex="-1"></a>              <span class="at">vjust =</span> <span class="fl">1.2</span>,</span>
<span id="cb17-548"><a href="#cb17-548" aria-hidden="true" tabindex="-1"></a>              <span class="at">data =</span> mk_text <span class="sc">%&gt;%</span> <span class="fu">filter</span>(species <span class="sc">==</span> spp_select)) <span class="sc">+</span></span>
<span id="cb17-549"><a href="#cb17-549" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_x_continuous</span>(<span class="at">limits =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="cn">NA</span>), <span class="at">label =</span> <span class="fu">label_number</span>()) <span class="sc">+</span></span>
<span id="cb17-550"><a href="#cb17-550" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_y_continuous</span>(<span class="at">label =</span> <span class="fu">label_percent</span>()) <span class="sc">+</span></span>
<span id="cb17-551"><a href="#cb17-551" aria-hidden="true" tabindex="-1"></a>    <span class="fu">facet_wrap</span>(<span class="sc">~</span><span class="fu">fct_reorder</span>(species, std_mk), <span class="at">scales =</span> <span class="st">"free"</span>) <span class="sc">+</span></span>
<span id="cb17-552"><a href="#cb17-552" aria-hidden="true" tabindex="-1"></a>    <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"Length class (cm)"</span>, </span>
<span id="cb17-553"><a href="#cb17-553" aria-hidden="true" tabindex="-1"></a>         <span class="at">y =</span> <span class="st">"Proportion"</span>) <span class="sc">+</span></span>
<span id="cb17-554"><a href="#cb17-554" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme_cowplot</span>() <span class="sc">+</span></span>
<span id="cb17-555"><a href="#cb17-555" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"none"</span>, </span>
<span id="cb17-556"><a href="#cb17-556" aria-hidden="true" tabindex="-1"></a>          <span class="at">strip.background =</span> <span class="fu">element_rect</span>(<span class="at">fill =</span> <span class="st">"transparent"</span>), </span>
<span id="cb17-557"><a href="#cb17-557" aria-hidden="true" tabindex="-1"></a>          <span class="at">strip.text =</span> <span class="fu">element_text</span>(<span class="at">face =</span> <span class="st">"italic"</span>), </span>
<span id="cb17-558"><a href="#cb17-558" aria-hidden="true" tabindex="-1"></a>          <span class="at">axis.title.y =</span> <span class="fu">element_blank</span>(), </span>
<span id="cb17-559"><a href="#cb17-559" aria-hidden="true" tabindex="-1"></a>          <span class="at">axis.title.x =</span> <span class="fu">element_blank</span>())</span>
<span id="cb17-560"><a href="#cb17-560" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb17-561"><a href="#cb17-561" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-562"><a href="#cb17-562" aria-hidden="true" tabindex="-1"></a>ks_data <span class="ot">&lt;-</span> </span>
<span id="cb17-563"><a href="#cb17-563" aria-hidden="true" tabindex="-1"></a>  fig4_data <span class="sc">%&gt;%</span> </span>
<span id="cb17-564"><a href="#cb17-564" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_wider</span>(<span class="at">names_from =</span> name, <span class="at">values_from =</span> value)</span>
<span id="cb17-565"><a href="#cb17-565" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-566"><a href="#cb17-566" aria-hidden="true" tabindex="-1"></a>ks_fig_data <span class="ot">&lt;-</span> </span>
<span id="cb17-567"><a href="#cb17-567" aria-hidden="true" tabindex="-1"></a>  ks_data <span class="sc">%&gt;%</span> </span>
<span id="cb17-568"><a href="#cb17-568" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">ks_norm =</span> <span class="fu">ks.test</span>(<span class="at">x =</span> rls_obs, </span>
<span id="cb17-569"><a href="#cb17-569" aria-hidden="true" tabindex="-1"></a>                              <span class="at">y =</span> p_norm)<span class="sc">$</span>statistic,</span>
<span id="cb17-570"><a href="#cb17-570" aria-hidden="true" tabindex="-1"></a>            <span class="at">ks_lnorm =</span> <span class="fu">ks.test</span>(<span class="at">x =</span> rls_obs, </span>
<span id="cb17-571"><a href="#cb17-571" aria-hidden="true" tabindex="-1"></a>                               <span class="at">y =</span> p_lnorm)<span class="sc">$</span>statistic,</span>
<span id="cb17-572"><a href="#cb17-572" aria-hidden="true" tabindex="-1"></a>            <span class="at">ks_lbspr =</span> <span class="fu">ks.test</span>(<span class="at">x =</span> rls_obs, </span>
<span id="cb17-573"><a href="#cb17-573" aria-hidden="true" tabindex="-1"></a>                               <span class="at">y =</span> lbspr)<span class="sc">$</span>statistic,</span>
<span id="cb17-574"><a href="#cb17-574" aria-hidden="true" tabindex="-1"></a>            <span class="at">ks_lbspr_mk15 =</span> <span class="fu">ks.test</span>(<span class="at">x =</span> rls_obs, </span>
<span id="cb17-575"><a href="#cb17-575" aria-hidden="true" tabindex="-1"></a>                                    <span class="at">y =</span> lbspr_mk15)<span class="sc">$</span>statistic,</span>
<span id="cb17-576"><a href="#cb17-576" aria-hidden="true" tabindex="-1"></a>            <span class="at">.by =</span> species) <span class="sc">%&gt;%</span> </span>
<span id="cb17-577"><a href="#cb17-577" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(<span class="at">cols =</span> <span class="fu">contains</span>(<span class="st">"ks_"</span>))</span>
<span id="cb17-578"><a href="#cb17-578" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-579"><a href="#cb17-579" aria-hidden="true" tabindex="-1"></a>ks_fig_data_rmsmall <span class="ot">&lt;-</span> </span>
<span id="cb17-580"><a href="#cb17-580" aria-hidden="true" tabindex="-1"></a>  ks_data <span class="sc">%&gt;%</span> </span>
<span id="cb17-581"><a href="#cb17-581" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(size_class <span class="sc">&gt;=</span> <span class="dv">10</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb17-582"><a href="#cb17-582" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">ks_norm =</span> <span class="fu">ks.test</span>(<span class="at">x =</span> p_norm, </span>
<span id="cb17-583"><a href="#cb17-583" aria-hidden="true" tabindex="-1"></a>                              <span class="at">y =</span> rls_obs)<span class="sc">$</span>statistic,</span>
<span id="cb17-584"><a href="#cb17-584" aria-hidden="true" tabindex="-1"></a>            <span class="at">ks_lnorm =</span> <span class="fu">ks.test</span>(<span class="at">x =</span> p_lnorm, </span>
<span id="cb17-585"><a href="#cb17-585" aria-hidden="true" tabindex="-1"></a>                               <span class="at">y =</span> rls_obs)<span class="sc">$</span>statistic,</span>
<span id="cb17-586"><a href="#cb17-586" aria-hidden="true" tabindex="-1"></a>            <span class="at">ks_lbspr =</span> <span class="fu">ks.test</span>(<span class="at">x =</span> lbspr, </span>
<span id="cb17-587"><a href="#cb17-587" aria-hidden="true" tabindex="-1"></a>                               <span class="at">y =</span> rls_obs)<span class="sc">$</span>statistic,</span>
<span id="cb17-588"><a href="#cb17-588" aria-hidden="true" tabindex="-1"></a>            <span class="at">ks_lbspr_mk15 =</span> <span class="fu">ks.test</span>(<span class="at">x =</span> rls_obs, </span>
<span id="cb17-589"><a href="#cb17-589" aria-hidden="true" tabindex="-1"></a>                                    <span class="at">y =</span> lbspr_mk15)<span class="sc">$</span>statistic,</span>
<span id="cb17-590"><a href="#cb17-590" aria-hidden="true" tabindex="-1"></a>            <span class="at">.by =</span> species) <span class="sc">%&gt;%</span> </span>
<span id="cb17-591"><a href="#cb17-591" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(<span class="at">cols =</span> <span class="fu">contains</span>(<span class="st">"ks_"</span>))</span>
<span id="cb17-592"><a href="#cb17-592" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-593"><a href="#cb17-593" aria-hidden="true" tabindex="-1"></a>fig4_violins <span class="ot">&lt;-</span></span>
<span id="cb17-594"><a href="#cb17-594" aria-hidden="true" tabindex="-1"></a>  ks_fig_data_rmsmall <span class="sc">%&gt;%</span></span>
<span id="cb17-595"><a href="#cb17-595" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="at">rmsmall =</span> value) <span class="sc">%&gt;%</span></span>
<span id="cb17-596"><a href="#cb17-596" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span>(ks_fig_data <span class="sc">%&gt;%</span></span>
<span id="cb17-597"><a href="#cb17-597" aria-hidden="true" tabindex="-1"></a>              <span class="fu">rename</span>(<span class="at">withsmall =</span> value)) <span class="sc">%&gt;%</span></span>
<span id="cb17-598"><a href="#cb17-598" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(<span class="at">cols =</span> <span class="fu">contains</span>(<span class="st">"small"</span>),</span>
<span id="cb17-599"><a href="#cb17-599" aria-hidden="true" tabindex="-1"></a>               <span class="at">names_to =</span> <span class="st">"inc_small"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb17-600"><a href="#cb17-600" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">inc_small =</span> <span class="fu">case_when</span>(inc_small <span class="sc">==</span> <span class="st">"rmsmall"</span> <span class="sc">~</span> <span class="st">"Exluding sizes &lt; 10cm"</span>,</span>
<span id="cb17-601"><a href="#cb17-601" aria-hidden="true" tabindex="-1"></a>                               inc_small <span class="sc">==</span> <span class="st">"withsmall"</span> <span class="sc">~</span> <span class="st">"All size classes"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb17-602"><a href="#cb17-602" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(name <span class="sc">!=</span> <span class="st">"ks_lnorm"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb17-603"><a href="#cb17-603" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">y =</span> value, <span class="at">x =</span> name)) <span class="sc">+</span></span>
<span id="cb17-604"><a href="#cb17-604" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_violin</span>()<span class="sc">+</span></span>
<span id="cb17-605"><a href="#cb17-605" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>(<span class="at">width =</span> <span class="fl">0.1</span>) <span class="sc">+</span></span>
<span id="cb17-606"><a href="#cb17-606" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span>inc_small, <span class="at">nrow=</span><span class="dv">2</span>) <span class="sc">+</span></span>
<span id="cb17-607"><a href="#cb17-607" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_discrete</span>(<span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"ks_lbspr"</span> <span class="ot">=</span> <span class="st">"LBSPR"</span>,</span>
<span id="cb17-608"><a href="#cb17-608" aria-hidden="true" tabindex="-1"></a>                              <span class="st">"ks_lbspr_mk15"</span> <span class="ot">=</span> <span class="st">"LBSPR </span><span class="sc">\n</span><span class="st"> (M/k = 1.5)"</span>,</span>
<span id="cb17-609"><a href="#cb17-609" aria-hidden="true" tabindex="-1"></a>                              <span class="st">"ks_norm"</span> <span class="ot">=</span> <span class="st">"CV = 0.34"</span>)) <span class="sc">+</span></span>
<span id="cb17-610"><a href="#cb17-610" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">y =</span> <span class="st">"Dissimilarity to observed"</span>) <span class="sc">+</span></span>
<span id="cb17-611"><a href="#cb17-611" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_cowplot</span>(<span class="dv">17</span>) <span class="sc">+</span></span>
<span id="cb17-612"><a href="#cb17-612" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"none"</span>,</span>
<span id="cb17-613"><a href="#cb17-613" aria-hidden="true" tabindex="-1"></a>        <span class="at">panel.grid.major.y =</span> <span class="fu">element_line</span>(<span class="at">colour =</span> <span class="st">"grey80"</span>),</span>
<span id="cb17-614"><a href="#cb17-614" aria-hidden="true" tabindex="-1"></a>        <span class="at">strip.background =</span> <span class="fu">element_rect</span>(<span class="at">fill =</span> <span class="st">"transparent"</span>, <span class="at">colour =</span> <span class="st">"black"</span>),</span>
<span id="cb17-615"><a href="#cb17-615" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.title.x =</span> <span class="fu">element_blank</span>())</span>
<span id="cb17-616"><a href="#cb17-616" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-617"><a href="#cb17-617" aria-hidden="true" tabindex="-1"></a>arranged_species <span class="ot">&lt;-</span> fig4_data_sample <span class="sc">%&gt;%</span> <span class="fu">arrange</span>(std_mk) <span class="sc">%&gt;%</span> <span class="fu">pull</span>(species)  <span class="sc">%&gt;%</span> <span class="fu">unique</span>()</span>
<span id="cb17-618"><a href="#cb17-618" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-619"><a href="#cb17-619" aria-hidden="true" tabindex="-1"></a>mk_text <span class="ot">&lt;-</span> </span>
<span id="cb17-620"><a href="#cb17-620" aria-hidden="true" tabindex="-1"></a>  fig4_data_sample <span class="sc">%&gt;%</span> </span>
<span id="cb17-621"><a href="#cb17-621" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(p_obs <span class="sc">!=</span> <span class="dv">0</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb17-622"><a href="#cb17-622" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">max_x =</span> <span class="fu">max</span>(size_class, <span class="at">na.rm =</span> <span class="cn">TRUE</span>), </span>
<span id="cb17-623"><a href="#cb17-623" aria-hidden="true" tabindex="-1"></a>            <span class="at">max_y =</span> <span class="fu">max</span>(<span class="fu">c</span>(p_obs, p_lbspr), <span class="at">na.rm =</span> <span class="cn">TRUE</span>), </span>
<span id="cb17-624"><a href="#cb17-624" aria-hidden="true" tabindex="-1"></a>            <span class="at">std_mk =</span> <span class="fu">round</span>(<span class="fu">unique</span>(std_mk), <span class="dv">2</span>), </span>
<span id="cb17-625"><a href="#cb17-625" aria-hidden="true" tabindex="-1"></a>            <span class="at">std_linf =</span> <span class="fu">round</span>(<span class="fu">unique</span>(std_linf),<span class="dv">0</span>), </span>
<span id="cb17-626"><a href="#cb17-626" aria-hidden="true" tabindex="-1"></a>            <span class="at">.by =</span> species) </span>
<span id="cb17-627"><a href="#cb17-627" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-628"><a href="#cb17-628" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(arranged_species)){</span>
<span id="cb17-629"><a href="#cb17-629" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb17-630"><a href="#cb17-630" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span>(i<span class="sc">==</span><span class="dv">1</span>) {</span>
<span id="cb17-631"><a href="#cb17-631" aria-hidden="true" tabindex="-1"></a>    fig4_main <span class="ot">&lt;-</span> <span class="fu">make_fig4</span>(fig4_data, </span>
<span id="cb17-632"><a href="#cb17-632" aria-hidden="true" tabindex="-1"></a>                           <span class="at">spp_select =</span> arranged_species[i]) <span class="sc">+</span> </span>
<span id="cb17-633"><a href="#cb17-633" aria-hidden="true" tabindex="-1"></a>      <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"none"</span>)</span>
<span id="cb17-634"><a href="#cb17-634" aria-hidden="true" tabindex="-1"></a>  } <span class="cf">else</span> <span class="cf">if</span>(i <span class="sc">%in%</span> <span class="fu">c</span>(<span class="dv">6</span>,<span class="dv">7</span>)) {</span>
<span id="cb17-635"><a href="#cb17-635" aria-hidden="true" tabindex="-1"></a>    fig4_main <span class="ot">&lt;-</span> </span>
<span id="cb17-636"><a href="#cb17-636" aria-hidden="true" tabindex="-1"></a>      fig4_main <span class="sc">+</span> </span>
<span id="cb17-637"><a href="#cb17-637" aria-hidden="true" tabindex="-1"></a>      <span class="fu">make_fig4</span>(fig4_data, </span>
<span id="cb17-638"><a href="#cb17-638" aria-hidden="true" tabindex="-1"></a>                <span class="at">spp_select =</span> arranged_species[i]) <span class="sc">+</span> </span>
<span id="cb17-639"><a href="#cb17-639" aria-hidden="true" tabindex="-1"></a>      <span class="fu">theme</span>(<span class="at">axis.title.x =</span> <span class="fu">element_text</span>())</span>
<span id="cb17-640"><a href="#cb17-640" aria-hidden="true" tabindex="-1"></a>  } <span class="cf">else</span> <span class="cf">if</span>(i <span class="sc">==</span> <span class="fu">max</span>(<span class="fu">length</span>(arranged_species))) {</span>
<span id="cb17-641"><a href="#cb17-641" aria-hidden="true" tabindex="-1"></a>    fig4_main <span class="ot">&lt;-</span> </span>
<span id="cb17-642"><a href="#cb17-642" aria-hidden="true" tabindex="-1"></a>      fig4_main <span class="sc">+</span></span>
<span id="cb17-643"><a href="#cb17-643" aria-hidden="true" tabindex="-1"></a>      <span class="fu">make_fig4</span>(fig4_data, <span class="at">spp_select =</span> arranged_species[i]) <span class="sc">+</span> </span>
<span id="cb17-644"><a href="#cb17-644" aria-hidden="true" tabindex="-1"></a>      <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"bottom"</span>)</span>
<span id="cb17-645"><a href="#cb17-645" aria-hidden="true" tabindex="-1"></a>  } <span class="cf">else</span> {</span>
<span id="cb17-646"><a href="#cb17-646" aria-hidden="true" tabindex="-1"></a>    fig4_main <span class="ot">&lt;-</span> </span>
<span id="cb17-647"><a href="#cb17-647" aria-hidden="true" tabindex="-1"></a>      fig4_main <span class="sc">+</span> </span>
<span id="cb17-648"><a href="#cb17-648" aria-hidden="true" tabindex="-1"></a>      <span class="fu">make_fig4</span>(fig4_data, <span class="at">spp_select =</span> arranged_species[i]) <span class="sc">+</span> </span>
<span id="cb17-649"><a href="#cb17-649" aria-hidden="true" tabindex="-1"></a>      <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"none"</span>)</span>
<span id="cb17-650"><a href="#cb17-650" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb17-651"><a href="#cb17-651" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb17-652"><a href="#cb17-652" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb17-653"><a href="#cb17-653" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-654"><a href="#cb17-654" aria-hidden="true" tabindex="-1"></a>fig4_legend <span class="ot">&lt;-</span> </span>
<span id="cb17-655"><a href="#cb17-655" aria-hidden="true" tabindex="-1"></a>  {{<span class="fu">make_fig4</span>(fig4_data, </span>
<span id="cb17-656"><a href="#cb17-656" aria-hidden="true" tabindex="-1"></a>              <span class="at">spp_select =</span> arranged_species[i]) <span class="sc">+</span> </span>
<span id="cb17-657"><a href="#cb17-657" aria-hidden="true" tabindex="-1"></a>      <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"bottom"</span>, <span class="at">legend.title =</span> <span class="fu">element_blank</span>(), <span class="at">legend.justification =</span> <span class="fl">0.5</span>) } <span class="sc">%&gt;%</span> </span>
<span id="cb17-658"><a href="#cb17-658" aria-hidden="true" tabindex="-1"></a>      <span class="fu">get_legend</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb17-659"><a href="#cb17-659" aria-hidden="true" tabindex="-1"></a>      <span class="fu">as_ggplot</span>()}</span>
<span id="cb17-660"><a href="#cb17-660" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-661"><a href="#cb17-661" aria-hidden="true" tabindex="-1"></a>fig4 <span class="ot">&lt;-</span> </span>
<span id="cb17-662"><a href="#cb17-662" aria-hidden="true" tabindex="-1"></a>  fig4_main <span class="sc">+</span> </span>
<span id="cb17-663"><a href="#cb17-663" aria-hidden="true" tabindex="-1"></a>  fig4_violins <span class="sc">+</span> </span>
<span id="cb17-664"><a href="#cb17-664" aria-hidden="true" tabindex="-1"></a>  fig4_legend <span class="sc">+</span></span>
<span id="cb17-665"><a href="#cb17-665" aria-hidden="true" tabindex="-1"></a>  <span class="fu">plot_layout</span>(<span class="at">design =</span> </span>
<span id="cb17-666"><a href="#cb17-666" aria-hidden="true" tabindex="-1"></a>                <span class="st">"abc</span></span>
<span id="cb17-667"><a href="#cb17-667" aria-hidden="true" tabindex="-1"></a><span class="st">              deh</span></span>
<span id="cb17-668"><a href="#cb17-668" aria-hidden="true" tabindex="-1"></a><span class="st">              fgh</span></span>
<span id="cb17-669"><a href="#cb17-669" aria-hidden="true" tabindex="-1"></a><span class="st">              iii</span></span>
<span id="cb17-670"><a href="#cb17-670" aria-hidden="true" tabindex="-1"></a><span class="st">              "</span>, <span class="at">heights =</span> <span class="fu">c</span>(<span class="dv">4</span>,<span class="dv">4</span>,<span class="dv">4</span>,<span class="dv">1</span>)) <span class="sc">+</span></span>
<span id="cb17-671"><a href="#cb17-671" aria-hidden="true" tabindex="-1"></a>  <span class="fu">plot_annotation</span>(<span class="at">tag_levels =</span> <span class="st">"A"</span>)</span>
<span id="cb17-672"><a href="#cb17-672" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-673"><a href="#cb17-673" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-674"><a href="#cb17-674" aria-hidden="true" tabindex="-1"></a><span class="fu">ggsave</span>(<span class="at">filename =</span> <span class="st">"ms_figs/lbspr_comparison.png"</span>,</span>
<span id="cb17-675"><a href="#cb17-675" aria-hidden="true" tabindex="-1"></a>       <span class="at">plot =</span> fig4,</span>
<span id="cb17-676"><a href="#cb17-676" aria-hidden="true" tabindex="-1"></a>       <span class="at">height =</span> <span class="dv">20</span>,</span>
<span id="cb17-677"><a href="#cb17-677" aria-hidden="true" tabindex="-1"></a>       <span class="at">width =</span> <span class="dv">20</span><span class="sc">*</span><span class="fl">1.618</span>,</span>
<span id="cb17-678"><a href="#cb17-678" aria-hidden="true" tabindex="-1"></a>       <span class="at">units =</span> <span class="st">"cm"</span>)</span>
<span id="cb17-679"><a href="#cb17-679" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-680"><a href="#cb17-680" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb17-681"><a href="#cb17-681" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-682"><a href="#cb17-682" aria-hidden="true" tabindex="-1"></a><span class="al">![Simple one parameter model that assumes truncated normal distribution and CV = 0.34 matches observations similarly well or better than commonly used size-based methods with more parameters (LBSPR). Panels A-G shows observations (grey bars) and predictions (solid lines) for seven randomly selected (from 68 species with available life-history parameters). Predictions are shown for a simple method using truncated normal distribution (yellow) with a CV = 0.34 and from LBSPR using either empirically estimate M and k values from Prince et al.17 (red) or assuming a generic M/k ratio of 1.516. Panel H shows the dissimilarity (Kolmogorov-Smirnov statistic) between the prediction and the observed body size distribution for all 68 species using all size classes or removing individuals that may have observational sampling bias (less than 10cm in body length).](ms_figs/lbspr_comparison.png)</span></span>
<span id="cb17-683"><a href="#cb17-683" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-684"><a href="#cb17-684" aria-hidden="true" tabindex="-1"></a><span class="fu"># SI Figures</span></span>
<span id="cb17-685"><a href="#cb17-685" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-686"><a href="#cb17-686" aria-hidden="true" tabindex="-1"></a><span class="fu">## ED Fig. 1</span></span>
<span id="cb17-687"><a href="#cb17-687" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-688"><a href="#cb17-688" aria-hidden="true" tabindex="-1"></a><span class="in">```{r ed-fig1}</span></span>
<span id="cb17-689"><a href="#cb17-689" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-690"><a href="#cb17-690" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-691"><a href="#cb17-691" aria-hidden="true" tabindex="-1"></a>logit_mod <span class="ot">&lt;-</span></span>
<span id="cb17-692"><a href="#cb17-692" aria-hidden="true" tabindex="-1"></a>  ED_fig1_data <span class="sc">%&gt;%</span> </span>
<span id="cb17-693"><a href="#cb17-693" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">normal_better =</span> <span class="fu">as.numeric</span>(normal_better)) <span class="sc">%&gt;%</span> </span>
<span id="cb17-694"><a href="#cb17-694" aria-hidden="true" tabindex="-1"></a>  <span class="fu">glm</span>(normal_better <span class="sc">~</span> pop_mean_size, <span class="at">data =</span> ., <span class="at">family =</span> <span class="st">"binomial"</span>)</span>
<span id="cb17-695"><a href="#cb17-695" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-696"><a href="#cb17-696" aria-hidden="true" tabindex="-1"></a>logit_plot <span class="ot">&lt;-</span> </span>
<span id="cb17-697"><a href="#cb17-697" aria-hidden="true" tabindex="-1"></a>  ED_fig1_data <span class="sc">%&gt;%</span> </span>
<span id="cb17-698"><a href="#cb17-698" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(</span>
<span id="cb17-699"><a href="#cb17-699" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> pop_mean_size,</span>
<span id="cb17-700"><a href="#cb17-700" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span> normal_better <span class="sc">%&gt;%</span> as.numeric)) <span class="sc">+</span></span>
<span id="cb17-701"><a href="#cb17-701" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">alpha =</span> <span class="fl">0.3</span>, <span class="at">pch =</span> <span class="dv">3</span>, <span class="at">size =</span> <span class="dv">3</span>) <span class="sc">+</span></span>
<span id="cb17-702"><a href="#cb17-702" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">method =</span> <span class="st">"glm"</span>,</span>
<span id="cb17-703"><a href="#cb17-703" aria-hidden="true" tabindex="-1"></a>              <span class="at">method.args =</span> <span class="fu">list</span>(<span class="at">family =</span> <span class="st">"binomial"</span>),</span>
<span id="cb17-704"><a href="#cb17-704" aria-hidden="true" tabindex="-1"></a>              <span class="at">col =</span> <span class="st">"darkblue"</span>, <span class="at">fill =</span> <span class="st">"darkblue"</span>) <span class="sc">+</span></span>
<span id="cb17-705"><a href="#cb17-705" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">label =</span> <span class="fu">label_number</span>(<span class="at">suffix =</span> <span class="st">"cm"</span>)) <span class="sc">+</span></span>
<span id="cb17-706"><a href="#cb17-706" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_cowplot</span>(<span class="dv">20</span>) <span class="sc">+</span></span>
<span id="cb17-707"><a href="#cb17-707" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb17-708"><a href="#cb17-708" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> <span class="st">"Mean body length"</span>, </span>
<span id="cb17-709"><a href="#cb17-709" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span> <span class="st">"Probability Normal preferred"</span></span>
<span id="cb17-710"><a href="#cb17-710" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb17-711"><a href="#cb17-711" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-712"><a href="#cb17-712" aria-hidden="true" tabindex="-1"></a><span class="fu">ggsave</span>(<span class="at">filename =</span> <span class="st">"ms_figs/logistic.png"</span>,</span>
<span id="cb17-713"><a href="#cb17-713" aria-hidden="true" tabindex="-1"></a>       <span class="at">plot =</span> logit_plot,</span>
<span id="cb17-714"><a href="#cb17-714" aria-hidden="true" tabindex="-1"></a>       <span class="at">height =</span> <span class="dv">15</span>,</span>
<span id="cb17-715"><a href="#cb17-715" aria-hidden="true" tabindex="-1"></a>       <span class="at">width =</span> <span class="dv">15</span><span class="sc">*</span><span class="fl">1.618</span>,</span>
<span id="cb17-716"><a href="#cb17-716" aria-hidden="true" tabindex="-1"></a>       <span class="at">units =</span> <span class="st">"cm"</span>)</span>
<span id="cb17-717"><a href="#cb17-717" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb17-718"><a href="#cb17-718" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-719"><a href="#cb17-719" aria-hidden="true" tabindex="-1"></a><span class="al">![Populations with larger mean body lengths are usually better described by a truncated normal than a lognormal distribution. The blue line shows the logistic regression fit to the data. The populations include both visual census and cryptobenthic data.](ms_figs/logistic.png)</span></span>
<span id="cb17-720"><a href="#cb17-720" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-721"><a href="#cb17-721" aria-hidden="true" tabindex="-1"></a><span class="fu">## ED Fig. 2</span></span>
<span id="cb17-722"><a href="#cb17-722" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-723"><a href="#cb17-723" aria-hidden="true" tabindex="-1"></a><span class="in">```{r ed-fig2}</span></span>
<span id="cb17-724"><a href="#cb17-724" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-725"><a href="#cb17-725" aria-hidden="true" tabindex="-1"></a>p_binning <span class="ot">&lt;-</span> </span>
<span id="cb17-726"><a href="#cb17-726" aria-hidden="true" tabindex="-1"></a>  ED_fig2_data <span class="sc">%&gt;%</span></span>
<span id="cb17-727"><a href="#cb17-727" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>() <span class="sc">+</span></span>
<span id="cb17-728"><a href="#cb17-728" aria-hidden="true" tabindex="-1"></a>  <span class="fu">aes</span>(</span>
<span id="cb17-729"><a href="#cb17-729" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> mean_size,</span>
<span id="cb17-730"><a href="#cb17-730" aria-hidden="true" tabindex="-1"></a>    <span class="at">xend =</span> mean_size,</span>
<span id="cb17-731"><a href="#cb17-731" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span> cont,</span>
<span id="cb17-732"><a href="#cb17-732" aria-hidden="true" tabindex="-1"></a>    <span class="at">yend =</span> binned</span>
<span id="cb17-733"><a href="#cb17-733" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb17-734"><a href="#cb17-734" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> <span class="fu">median</span>(ED_fig2_data<span class="sc">$</span>binned, <span class="at">na.rm =</span> <span class="cn">TRUE</span>), <span class="at">lty =</span> <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb17-735"><a href="#cb17-735" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> <span class="fu">median</span>(ED_fig2_data<span class="sc">$</span>cont, <span class="at">na.rm =</span> <span class="cn">TRUE</span>), <span class="at">lty =</span> <span class="st">"35"</span>) <span class="sc">+</span></span>
<span id="cb17-736"><a href="#cb17-736" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_segment</span>(<span class="at">arrow =</span> <span class="fu">arrow</span>(<span class="at">length =</span> <span class="fu">unit</span>(<span class="fl">0.3</span>, <span class="st">"cm"</span>))) <span class="sc">+</span></span>
<span id="cb17-737"><a href="#cb17-737" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_log10</span>(<span class="at">label =</span> <span class="fu">label_number</span>(<span class="at">suffix =</span> <span class="st">"cm"</span>)) <span class="sc">+</span></span>
<span id="cb17-738"><a href="#cb17-738" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_cowplot</span>(<span class="dv">20</span>) <span class="sc">+</span></span>
<span id="cb17-739"><a href="#cb17-739" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"Mean body length (log)"</span>, </span>
<span id="cb17-740"><a href="#cb17-740" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">"CV value (before and after binning)"</span>)</span>
<span id="cb17-741"><a href="#cb17-741" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-742"><a href="#cb17-742" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-743"><a href="#cb17-743" aria-hidden="true" tabindex="-1"></a><span class="fu">ggsave</span>(<span class="at">filename =</span> <span class="st">"ms_figs/binning_effect.png"</span>,</span>
<span id="cb17-744"><a href="#cb17-744" aria-hidden="true" tabindex="-1"></a>       <span class="at">plot =</span> p_binning,</span>
<span id="cb17-745"><a href="#cb17-745" aria-hidden="true" tabindex="-1"></a>       <span class="at">height =</span> <span class="dv">15</span>,</span>
<span id="cb17-746"><a href="#cb17-746" aria-hidden="true" tabindex="-1"></a>       <span class="at">width =</span> <span class="dv">15</span><span class="sc">*</span><span class="fl">1.618</span>,</span>
<span id="cb17-747"><a href="#cb17-747" aria-hidden="true" tabindex="-1"></a>       <span class="at">units =</span> <span class="st">"cm"</span>)</span>
<span id="cb17-748"><a href="#cb17-748" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-749"><a href="#cb17-749" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb17-750"><a href="#cb17-750" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-751"><a href="#cb17-751" aria-hidden="true" tabindex="-1"></a><span class="al">![Binning the cryptobenthic data (median CV = 0.23, dotted horizontal line) into visual census bins results in a greater median CV value (median CV = 0.28, solid horizontal line). Arrows represent the change from the CV value (either normal or lognormal) of the continuous data to the CV value of the binned data. Note: To be binned into the same visual census bins (2.5cm, 5cm, 7.5cm etc.), cryptobenthic body lengths were multiplied by a constant (constant = 3) before binning.](ms_figs/binning_effect.png)</span></span>
<span id="cb17-752"><a href="#cb17-752" aria-hidden="true" tabindex="-1"></a><span class="fu">## ED Fig. 3</span></span>
<span id="cb17-753"><a href="#cb17-753" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-754"><a href="#cb17-754" aria-hidden="true" tabindex="-1"></a><span class="in">```{r ed-fig3}</span></span>
<span id="cb17-755"><a href="#cb17-755" aria-hidden="true" tabindex="-1"></a><span class="co"># Must have run the functions in Figure 2</span></span>
<span id="cb17-756"><a href="#cb17-756" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-757"><a href="#cb17-757" aria-hidden="true" tabindex="-1"></a>plot_ylim <span class="ot">&lt;-</span> </span>
<span id="cb17-758"><a href="#cb17-758" aria-hidden="true" tabindex="-1"></a>  <span class="fu">max</span>(<span class="fu">layer_scales</span>(</span>
<span id="cb17-759"><a href="#cb17-759" aria-hidden="true" tabindex="-1"></a>    <span class="fu">main_plot</span>(ED_fig3_data))<span class="sc">$</span>y<span class="sc">$</span>range<span class="sc">$</span>range)</span>
<span id="cb17-760"><a href="#cb17-760" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-761"><a href="#cb17-761" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-762"><a href="#cb17-762" aria-hidden="true" tabindex="-1"></a>ppp <span class="ot">&lt;-</span> </span>
<span id="cb17-763"><a href="#cb17-763" aria-hidden="true" tabindex="-1"></a>  <span class="fu">main_plot</span>(ED_fig3_data) <span class="sc">+</span> </span>
<span id="cb17-764"><a href="#cb17-764" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.title.x =</span> <span class="fu">element_blank</span>()) <span class="sc">+</span></span>
<span id="cb17-765"><a href="#cb17-765" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylim</span>(<span class="dv">0</span>, plot_ylim) <span class="sc">+</span></span>
<span id="cb17-766"><a href="#cb17-766" aria-hidden="true" tabindex="-1"></a>  <span class="fu">annotate</span>(<span class="st">"text"</span>,</span>
<span id="cb17-767"><a href="#cb17-767" aria-hidden="true" tabindex="-1"></a>           <span class="at">x =</span> <span class="dv">1</span>, </span>
<span id="cb17-768"><a href="#cb17-768" aria-hidden="true" tabindex="-1"></a>           <span class="at">hjust =</span> <span class="dv">0</span>, </span>
<span id="cb17-769"><a href="#cb17-769" aria-hidden="true" tabindex="-1"></a>           <span class="at">y =</span> plot_ylim<span class="sc">*</span><span class="fl">0.95</span>,</span>
<span id="cb17-770"><a href="#cb17-770" aria-hidden="true" tabindex="-1"></a>           <span class="at">label =</span> <span class="st">"Ecoregion-level"</span>,</span>
<span id="cb17-771"><a href="#cb17-771" aria-hidden="true" tabindex="-1"></a>           <span class="at">size =</span> <span class="dv">10</span>) <span class="sc">+</span></span>
<span id="cb17-772"><a href="#cb17-772" aria-hidden="true" tabindex="-1"></a>  <span class="fu">side_plot</span>(ED_fig3_data <span class="sc">%&gt;%</span> <span class="fu">filter</span>(col <span class="sc">!=</span> <span class="st">"cbf_lnorm"</span>), </span>
<span id="cb17-773"><a href="#cb17-773" aria-hidden="true" tabindex="-1"></a>            plot_ylim)  <span class="sc">+</span></span>
<span id="cb17-774"><a href="#cb17-774" aria-hidden="true" tabindex="-1"></a>  <span class="fu">plot_layout</span>(<span class="at">design =</span> {<span class="st">"</span></span>
<span id="cb17-775"><a href="#cb17-775" aria-hidden="true" tabindex="-1"></a><span class="st">      AAAAAAB</span></span>
<span id="cb17-776"><a href="#cb17-776" aria-hidden="true" tabindex="-1"></a><span class="st">      AAAAAAB"</span></span>
<span id="cb17-777"><a href="#cb17-777" aria-hidden="true" tabindex="-1"></a>  })</span>
<span id="cb17-778"><a href="#cb17-778" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-779"><a href="#cb17-779" aria-hidden="true" tabindex="-1"></a>leg <span class="ot">&lt;-</span> </span>
<span id="cb17-780"><a href="#cb17-780" aria-hidden="true" tabindex="-1"></a>  ggpubr<span class="sc">::</span><span class="fu">as_ggplot</span>(</span>
<span id="cb17-781"><a href="#cb17-781" aria-hidden="true" tabindex="-1"></a>    <span class="fu">get_legend</span>(</span>
<span id="cb17-782"><a href="#cb17-782" aria-hidden="true" tabindex="-1"></a>      <span class="fu">main_plot</span>(ED_fig3_data) <span class="sc">+</span></span>
<span id="cb17-783"><a href="#cb17-783" aria-hidden="true" tabindex="-1"></a>        <span class="fu">theme</span>(<span class="at">axis.title =</span> <span class="fu">element_text</span>(), </span>
<span id="cb17-784"><a href="#cb17-784" aria-hidden="true" tabindex="-1"></a>              <span class="at">axis.text =</span> <span class="fu">element_text</span>()) <span class="sc">+</span></span>
<span id="cb17-785"><a href="#cb17-785" aria-hidden="true" tabindex="-1"></a>        <span class="fu">guides</span>(<span class="at">colour =</span> <span class="fu">guide_legend</span>(<span class="at">override.aes =</span> <span class="fu">list</span>(<span class="at">size=</span><span class="dv">5</span>, <span class="at">stroke =</span> <span class="dv">2</span>),</span>
<span id="cb17-786"><a href="#cb17-786" aria-hidden="true" tabindex="-1"></a>                                     <span class="at">nrow =</span> <span class="dv">2</span>,</span>
<span id="cb17-787"><a href="#cb17-787" aria-hidden="true" tabindex="-1"></a>                                     <span class="at">byrow =</span> <span class="cn">TRUE</span>,</span>
<span id="cb17-788"><a href="#cb17-788" aria-hidden="true" tabindex="-1"></a>                                     <span class="at">title =</span> <span class="fu">element_blank</span>()), </span>
<span id="cb17-789"><a href="#cb17-789" aria-hidden="true" tabindex="-1"></a>               <span class="at">pch =</span> <span class="fu">guide_legend</span>(<span class="at">nrow =</span> <span class="dv">2</span>,</span>
<span id="cb17-790"><a href="#cb17-790" aria-hidden="true" tabindex="-1"></a>                                  <span class="at">byrow =</span> <span class="cn">TRUE</span>,</span>
<span id="cb17-791"><a href="#cb17-791" aria-hidden="true" tabindex="-1"></a>                                  <span class="at">title =</span> <span class="fu">element_blank</span>())) <span class="sc">+</span></span>
<span id="cb17-792"><a href="#cb17-792" aria-hidden="true" tabindex="-1"></a>        <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"bottom"</span>, </span>
<span id="cb17-793"><a href="#cb17-793" aria-hidden="true" tabindex="-1"></a>              <span class="at">legend.box =</span> <span class="st">"vertical"</span>,</span>
<span id="cb17-794"><a href="#cb17-794" aria-hidden="true" tabindex="-1"></a>              <span class="at">legend.justification =</span> <span class="fu">c</span>(<span class="fl">0.5</span>,<span class="fl">0.5</span>),</span>
<span id="cb17-795"><a href="#cb17-795" aria-hidden="true" tabindex="-1"></a>              <span class="at">legend.background =</span> <span class="fu">element_rect</span>(<span class="at">color =</span> <span class="st">"black"</span>),</span>
<span id="cb17-796"><a href="#cb17-796" aria-hidden="true" tabindex="-1"></a>              <span class="at">legend.margin=</span><span class="fu">margin</span>(<span class="dv">5</span>,<span class="dv">5</span>,<span class="dv">5</span>,<span class="dv">6</span>),</span>
<span id="cb17-797"><a href="#cb17-797" aria-hidden="true" tabindex="-1"></a>              <span class="at">legend.title =</span> <span class="fu">element_text</span>()))) </span>
<span id="cb17-798"><a href="#cb17-798" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-799"><a href="#cb17-799" aria-hidden="true" tabindex="-1"></a>cc <span class="ot">&lt;-</span> </span>
<span id="cb17-800"><a href="#cb17-800" aria-hidden="true" tabindex="-1"></a>  <span class="fu">wrap_elements</span>(ppp) <span class="sc">+</span></span>
<span id="cb17-801"><a href="#cb17-801" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">tag =</span> <span class="st">"Coeffient of variation in body size"</span>) <span class="sc">+</span></span>
<span id="cb17-802"><a href="#cb17-802" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(</span>
<span id="cb17-803"><a href="#cb17-803" aria-hidden="true" tabindex="-1"></a>    <span class="at">plot.tag =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">20</span>, <span class="at">angle =</span> <span class="dv">90</span>),</span>
<span id="cb17-804"><a href="#cb17-804" aria-hidden="true" tabindex="-1"></a>    <span class="at">plot.tag.position =</span> <span class="st">"left"</span></span>
<span id="cb17-805"><a href="#cb17-805" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb17-806"><a href="#cb17-806" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-807"><a href="#cb17-807" aria-hidden="true" tabindex="-1"></a>p_simple <span class="ot">&lt;-</span> </span>
<span id="cb17-808"><a href="#cb17-808" aria-hidden="true" tabindex="-1"></a>  cc <span class="sc">+</span> </span>
<span id="cb17-809"><a href="#cb17-809" aria-hidden="true" tabindex="-1"></a>  leg <span class="sc">+</span></span>
<span id="cb17-810"><a href="#cb17-810" aria-hidden="true" tabindex="-1"></a>  <span class="fu">plot_layout</span>(<span class="at">design =</span> {<span class="st">"</span></span>
<span id="cb17-811"><a href="#cb17-811" aria-hidden="true" tabindex="-1"></a><span class="st">      AAAAAAA</span></span>
<span id="cb17-812"><a href="#cb17-812" aria-hidden="true" tabindex="-1"></a><span class="st">      AAAAAAA</span></span>
<span id="cb17-813"><a href="#cb17-813" aria-hidden="true" tabindex="-1"></a><span class="st">            #BBBBB#"</span></span>
<span id="cb17-814"><a href="#cb17-814" aria-hidden="true" tabindex="-1"></a>  })</span>
<span id="cb17-815"><a href="#cb17-815" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-816"><a href="#cb17-816" aria-hidden="true" tabindex="-1"></a><span class="fu">ggsave</span>(<span class="at">filename =</span> <span class="st">"ms_figs/meansize_cv_ecoregion.png"</span>,</span>
<span id="cb17-817"><a href="#cb17-817" aria-hidden="true" tabindex="-1"></a>       <span class="at">plot =</span> p_simple,</span>
<span id="cb17-818"><a href="#cb17-818" aria-hidden="true" tabindex="-1"></a>       <span class="at">height =</span> <span class="dv">15</span>,</span>
<span id="cb17-819"><a href="#cb17-819" aria-hidden="true" tabindex="-1"></a>       <span class="at">width =</span> <span class="dv">20</span><span class="sc">*</span><span class="fl">1.618</span>,</span>
<span id="cb17-820"><a href="#cb17-820" aria-hidden="true" tabindex="-1"></a>       <span class="at">units =</span> <span class="st">"cm"</span>)</span>
<span id="cb17-821"><a href="#cb17-821" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-822"><a href="#cb17-822" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb17-823"><a href="#cb17-823" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-824"><a href="#cb17-824" aria-hidden="true" tabindex="-1"></a><span class="al">![Relationship between population mean body length and CV at the ecoregion-level in the visual census data and location level in the cryptobenthic data. Fisheries-targeted species and distributions deemed to be bimodal have been excluded. The median CV value is 0.35, 80% of CV values fall in the range of 0.23 to 0.51 and 95% of the CV values fall in the range of 0.19 and 0.56.](ms_figs/meansize_cv_ecoregion.png)</span></span>
<span id="cb17-825"><a href="#cb17-825" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-826"><a href="#cb17-826" aria-hidden="true" tabindex="-1"></a><span class="fu">## ED Fig. 4</span></span>
<span id="cb17-827"><a href="#cb17-827" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-828"><a href="#cb17-828" aria-hidden="true" tabindex="-1"></a><span class="in">```{r ed-fig4}</span></span>
<span id="cb17-829"><a href="#cb17-829" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-830"><a href="#cb17-830" aria-hidden="true" tabindex="-1"></a>inc_fished <span class="ot">&lt;-</span> <span class="cn">FALSE</span></span>
<span id="cb17-831"><a href="#cb17-831" aria-hidden="true" tabindex="-1"></a>inc_bimodal <span class="ot">&lt;-</span> <span class="cn">FALSE</span></span>
<span id="cb17-832"><a href="#cb17-832" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-833"><a href="#cb17-833" aria-hidden="true" tabindex="-1"></a>pop_data <span class="ot">&lt;-</span> </span>
<span id="cb17-834"><a href="#cb17-834" aria-hidden="true" tabindex="-1"></a>  fig2_data_pop <span class="sc">%&gt;%</span></span>
<span id="cb17-835"><a href="#cb17-835" aria-hidden="true" tabindex="-1"></a>  {<span class="cf">if</span>(inc_fished) . <span class="cf">else</span> <span class="fu">filter</span>(., <span class="sc">!</span>fished)} <span class="sc">%&gt;%</span> </span>
<span id="cb17-836"><a href="#cb17-836" aria-hidden="true" tabindex="-1"></a>  {<span class="cf">if</span>(inc_bimodal) . <span class="cf">else</span> <span class="fu">filter</span>(., <span class="sc">!</span>bimodal)} </span>
<span id="cb17-837"><a href="#cb17-837" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-838"><a href="#cb17-838" aria-hidden="true" tabindex="-1"></a>spp_data <span class="ot">&lt;-</span> </span>
<span id="cb17-839"><a href="#cb17-839" aria-hidden="true" tabindex="-1"></a>  fig2_data_spp <span class="sc">%&gt;%</span> </span>
<span id="cb17-840"><a href="#cb17-840" aria-hidden="true" tabindex="-1"></a>  {<span class="cf">if</span>(inc_fished) . <span class="cf">else</span> <span class="fu">filter</span>(., <span class="sc">!</span>fished)} <span class="sc">%&gt;%</span> </span>
<span id="cb17-841"><a href="#cb17-841" aria-hidden="true" tabindex="-1"></a>  {<span class="cf">if</span>(inc_bimodal) . <span class="cf">else</span> <span class="fu">filter</span>(., <span class="sc">!</span>bimodal)}</span>
<span id="cb17-842"><a href="#cb17-842" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-843"><a href="#cb17-843" aria-hidden="true" tabindex="-1"></a>plot_ylim <span class="ot">&lt;-</span> </span>
<span id="cb17-844"><a href="#cb17-844" aria-hidden="true" tabindex="-1"></a>  <span class="fu">max</span>(<span class="fu">layer_scales</span>(</span>
<span id="cb17-845"><a href="#cb17-845" aria-hidden="true" tabindex="-1"></a>    <span class="fu">main_plot</span>(pop_data))<span class="sc">$</span>y<span class="sc">$</span>range<span class="sc">$</span>range,</span>
<span id="cb17-846"><a href="#cb17-846" aria-hidden="true" tabindex="-1"></a>    <span class="fu">layer_scales</span>(</span>
<span id="cb17-847"><a href="#cb17-847" aria-hidden="true" tabindex="-1"></a>      <span class="fu">main_plot</span>(spp_data))<span class="sc">$</span>y<span class="sc">$</span>range<span class="sc">$</span>range)</span>
<span id="cb17-848"><a href="#cb17-848" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-849"><a href="#cb17-849" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-850"><a href="#cb17-850" aria-hidden="true" tabindex="-1"></a>ED_fig4_main <span class="ot">&lt;-</span> </span>
<span id="cb17-851"><a href="#cb17-851" aria-hidden="true" tabindex="-1"></a>  <span class="fu">main_plot</span>(pop_data) <span class="sc">+</span> </span>
<span id="cb17-852"><a href="#cb17-852" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.title.x =</span> <span class="fu">element_blank</span>()) <span class="sc">+</span></span>
<span id="cb17-853"><a href="#cb17-853" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylim</span>(<span class="dv">0</span>, plot_ylim) <span class="sc">+</span></span>
<span id="cb17-854"><a href="#cb17-854" aria-hidden="true" tabindex="-1"></a>  <span class="fu">annotate</span>(<span class="st">"text"</span>,</span>
<span id="cb17-855"><a href="#cb17-855" aria-hidden="true" tabindex="-1"></a>           <span class="at">x =</span> <span class="dv">1</span>, </span>
<span id="cb17-856"><a href="#cb17-856" aria-hidden="true" tabindex="-1"></a>           <span class="at">hjust =</span> <span class="dv">0</span>, </span>
<span id="cb17-857"><a href="#cb17-857" aria-hidden="true" tabindex="-1"></a>           <span class="at">y =</span> plot_ylim<span class="sc">*</span><span class="fl">0.95</span>,</span>
<span id="cb17-858"><a href="#cb17-858" aria-hidden="true" tabindex="-1"></a>           <span class="at">label =</span> <span class="st">"Population-level"</span>,</span>
<span id="cb17-859"><a href="#cb17-859" aria-hidden="true" tabindex="-1"></a>           <span class="at">size =</span> <span class="dv">10</span>) <span class="sc">+</span></span>
<span id="cb17-860"><a href="#cb17-860" aria-hidden="true" tabindex="-1"></a>  <span class="fu">side_plot</span>(pop_data <span class="sc">%&gt;%</span> </span>
<span id="cb17-861"><a href="#cb17-861" aria-hidden="true" tabindex="-1"></a>              <span class="fu">filter</span>(col <span class="sc">!=</span> <span class="st">"cbf_lnorm"</span>), </span>
<span id="cb17-862"><a href="#cb17-862" aria-hidden="true" tabindex="-1"></a>            plot_ylim) <span class="sc">+</span> </span>
<span id="cb17-863"><a href="#cb17-863" aria-hidden="true" tabindex="-1"></a>  <span class="fu">main_plot</span>(spp_data) <span class="sc">+</span> <span class="fu">ylim</span>(<span class="dv">0</span>, plot_ylim) <span class="sc">+</span></span>
<span id="cb17-864"><a href="#cb17-864" aria-hidden="true" tabindex="-1"></a>  <span class="fu">annotate</span>(<span class="st">"text"</span>, </span>
<span id="cb17-865"><a href="#cb17-865" aria-hidden="true" tabindex="-1"></a>           <span class="at">x =</span> <span class="dv">1</span>, </span>
<span id="cb17-866"><a href="#cb17-866" aria-hidden="true" tabindex="-1"></a>           <span class="at">hjust =</span> <span class="dv">0</span>, </span>
<span id="cb17-867"><a href="#cb17-867" aria-hidden="true" tabindex="-1"></a>           <span class="at">y =</span> plot_ylim<span class="sc">*</span><span class="fl">0.95</span>,</span>
<span id="cb17-868"><a href="#cb17-868" aria-hidden="true" tabindex="-1"></a>           <span class="at">label =</span> <span class="st">"Species-level"</span>,</span>
<span id="cb17-869"><a href="#cb17-869" aria-hidden="true" tabindex="-1"></a>           <span class="at">size =</span> <span class="dv">10</span>) <span class="sc">+</span></span>
<span id="cb17-870"><a href="#cb17-870" aria-hidden="true" tabindex="-1"></a>  <span class="fu">side_plot</span>(spp_data <span class="sc">%&gt;%</span> <span class="fu">filter</span>(col <span class="sc">!=</span> <span class="st">"cbf_lnorm"</span>), </span>
<span id="cb17-871"><a href="#cb17-871" aria-hidden="true" tabindex="-1"></a>            plot_ylim)  <span class="sc">+</span></span>
<span id="cb17-872"><a href="#cb17-872" aria-hidden="true" tabindex="-1"></a>  <span class="fu">plot_layout</span>(<span class="at">design =</span> {<span class="st">"</span></span>
<span id="cb17-873"><a href="#cb17-873" aria-hidden="true" tabindex="-1"></a><span class="st">      AAAAAAB</span></span>
<span id="cb17-874"><a href="#cb17-874" aria-hidden="true" tabindex="-1"></a><span class="st">      AAAAAAB</span></span>
<span id="cb17-875"><a href="#cb17-875" aria-hidden="true" tabindex="-1"></a><span class="st">      CCCCCCD</span></span>
<span id="cb17-876"><a href="#cb17-876" aria-hidden="true" tabindex="-1"></a><span class="st">      CCCCCCD"</span></span>
<span id="cb17-877"><a href="#cb17-877" aria-hidden="true" tabindex="-1"></a>  })</span>
<span id="cb17-878"><a href="#cb17-878" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-879"><a href="#cb17-879" aria-hidden="true" tabindex="-1"></a>ED_fig4_legend <span class="ot">&lt;-</span></span>
<span id="cb17-880"><a href="#cb17-880" aria-hidden="true" tabindex="-1"></a>  ggpubr<span class="sc">::</span><span class="fu">as_ggplot</span>(</span>
<span id="cb17-881"><a href="#cb17-881" aria-hidden="true" tabindex="-1"></a>    ggpubr<span class="sc">::</span><span class="fu">get_legend</span>(</span>
<span id="cb17-882"><a href="#cb17-882" aria-hidden="true" tabindex="-1"></a>      <span class="fu">main_plot</span>(pop_data) <span class="sc">+</span></span>
<span id="cb17-883"><a href="#cb17-883" aria-hidden="true" tabindex="-1"></a>        <span class="fu">theme</span>(<span class="at">axis.title =</span> <span class="fu">element_text</span>(), </span>
<span id="cb17-884"><a href="#cb17-884" aria-hidden="true" tabindex="-1"></a>              <span class="at">axis.text =</span> <span class="fu">element_text</span>()) <span class="sc">+</span></span>
<span id="cb17-885"><a href="#cb17-885" aria-hidden="true" tabindex="-1"></a>        <span class="fu">guides</span>(<span class="at">colour =</span> <span class="fu">guide_legend</span>(<span class="at">override.aes =</span> <span class="fu">list</span>(<span class="at">size=</span><span class="dv">5</span>, <span class="at">stroke =</span> <span class="dv">2</span>),</span>
<span id="cb17-886"><a href="#cb17-886" aria-hidden="true" tabindex="-1"></a>                                     <span class="at">nrow =</span> <span class="dv">2</span>,</span>
<span id="cb17-887"><a href="#cb17-887" aria-hidden="true" tabindex="-1"></a>                                     <span class="at">byrow =</span> <span class="cn">TRUE</span>,</span>
<span id="cb17-888"><a href="#cb17-888" aria-hidden="true" tabindex="-1"></a>                                     <span class="at">title =</span> <span class="fu">element_blank</span>()), </span>
<span id="cb17-889"><a href="#cb17-889" aria-hidden="true" tabindex="-1"></a>               <span class="at">pch =</span> <span class="fu">guide_legend</span>(<span class="at">nrow =</span> <span class="dv">2</span>,</span>
<span id="cb17-890"><a href="#cb17-890" aria-hidden="true" tabindex="-1"></a>                                  <span class="at">byrow =</span> <span class="cn">TRUE</span>,</span>
<span id="cb17-891"><a href="#cb17-891" aria-hidden="true" tabindex="-1"></a>                                  <span class="at">title =</span> <span class="fu">element_blank</span>())) <span class="sc">+</span></span>
<span id="cb17-892"><a href="#cb17-892" aria-hidden="true" tabindex="-1"></a>        <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"bottom"</span>, </span>
<span id="cb17-893"><a href="#cb17-893" aria-hidden="true" tabindex="-1"></a>              <span class="at">legend.box =</span> <span class="st">"vertical"</span>,</span>
<span id="cb17-894"><a href="#cb17-894" aria-hidden="true" tabindex="-1"></a>              <span class="at">legend.justification =</span> <span class="fu">c</span>(<span class="fl">0.5</span>,<span class="fl">0.5</span>),</span>
<span id="cb17-895"><a href="#cb17-895" aria-hidden="true" tabindex="-1"></a>              <span class="at">legend.background =</span> <span class="fu">element_rect</span>(<span class="at">color =</span> <span class="st">"black"</span>),</span>
<span id="cb17-896"><a href="#cb17-896" aria-hidden="true" tabindex="-1"></a>              <span class="at">legend.margin=</span><span class="fu">margin</span>(<span class="dv">5</span>,<span class="dv">5</span>,<span class="dv">5</span>,<span class="dv">6</span>),</span>
<span id="cb17-897"><a href="#cb17-897" aria-hidden="true" tabindex="-1"></a>              <span class="at">legend.title =</span> <span class="fu">element_text</span>()), </span>
<span id="cb17-898"><a href="#cb17-898" aria-hidden="true" tabindex="-1"></a>      </span>
<span id="cb17-899"><a href="#cb17-899" aria-hidden="true" tabindex="-1"></a>    )) </span>
<span id="cb17-900"><a href="#cb17-900" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-901"><a href="#cb17-901" aria-hidden="true" tabindex="-1"></a>ED_fig4_yaxis <span class="ot">&lt;-</span> </span>
<span id="cb17-902"><a href="#cb17-902" aria-hidden="true" tabindex="-1"></a>  <span class="fu">wrap_elements</span>(ED_fig4_main) <span class="sc">+</span></span>
<span id="cb17-903"><a href="#cb17-903" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">tag =</span> <span class="st">"Coeffient of variation in body size"</span>) <span class="sc">+</span></span>
<span id="cb17-904"><a href="#cb17-904" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(</span>
<span id="cb17-905"><a href="#cb17-905" aria-hidden="true" tabindex="-1"></a>    <span class="at">plot.tag =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">20</span>, <span class="at">angle =</span> <span class="dv">90</span>),</span>
<span id="cb17-906"><a href="#cb17-906" aria-hidden="true" tabindex="-1"></a>    <span class="at">plot.tag.position =</span> <span class="st">"left"</span></span>
<span id="cb17-907"><a href="#cb17-907" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb17-908"><a href="#cb17-908" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-909"><a href="#cb17-909" aria-hidden="true" tabindex="-1"></a>ED_fig4 <span class="ot">&lt;-</span> </span>
<span id="cb17-910"><a href="#cb17-910" aria-hidden="true" tabindex="-1"></a>  ED_fig4_yaxis <span class="sc">+</span> </span>
<span id="cb17-911"><a href="#cb17-911" aria-hidden="true" tabindex="-1"></a>  ED_fig4_legend <span class="sc">+</span></span>
<span id="cb17-912"><a href="#cb17-912" aria-hidden="true" tabindex="-1"></a>  <span class="fu">plot_layout</span>(<span class="at">design =</span> {<span class="st">"</span></span>
<span id="cb17-913"><a href="#cb17-913" aria-hidden="true" tabindex="-1"></a><span class="st">      AAAAAAA</span></span>
<span id="cb17-914"><a href="#cb17-914" aria-hidden="true" tabindex="-1"></a><span class="st">      AAAAAAA</span></span>
<span id="cb17-915"><a href="#cb17-915" aria-hidden="true" tabindex="-1"></a><span class="st">      AAAAAAA</span></span>
<span id="cb17-916"><a href="#cb17-916" aria-hidden="true" tabindex="-1"></a><span class="st">      AAAAAAA</span></span>
<span id="cb17-917"><a href="#cb17-917" aria-hidden="true" tabindex="-1"></a><span class="st">            #BBBBB#"</span></span>
<span id="cb17-918"><a href="#cb17-918" aria-hidden="true" tabindex="-1"></a>  })</span>
<span id="cb17-919"><a href="#cb17-919" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-920"><a href="#cb17-920" aria-hidden="true" tabindex="-1"></a><span class="fu">ggsave</span>(<span class="at">filename =</span> <span class="st">"ms_figs/cv_meansize_rmfished.png"</span>,</span>
<span id="cb17-921"><a href="#cb17-921" aria-hidden="true" tabindex="-1"></a>       <span class="at">plot =</span> ED_fig4,</span>
<span id="cb17-922"><a href="#cb17-922" aria-hidden="true" tabindex="-1"></a>       <span class="at">height =</span> <span class="dv">20</span>,</span>
<span id="cb17-923"><a href="#cb17-923" aria-hidden="true" tabindex="-1"></a>       <span class="at">width =</span> <span class="dv">20</span><span class="sc">*</span><span class="fl">1.618</span>,</span>
<span id="cb17-924"><a href="#cb17-924" aria-hidden="true" tabindex="-1"></a>       <span class="at">units =</span> <span class="st">"cm"</span>, </span>
<span id="cb17-925"><a href="#cb17-925" aria-hidden="true" tabindex="-1"></a>       <span class="at">create.dir =</span> <span class="cn">TRUE</span>)</span>
<span id="cb17-926"><a href="#cb17-926" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-927"><a href="#cb17-927" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb17-928"><a href="#cb17-928" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-929"><a href="#cb17-929" aria-hidden="true" tabindex="-1"></a><span class="al">![Reconstruction of Fig. 2 of the main text but excluding species and genera that are potentially targeted by fishing. Excluding these species has almost no influence on the estimate of CV. At the population level the median CV value is 0.34, 80% of CV values fall in the range of 0.22 to 0.51 and 95% of the CV values fall in the range of 0.19 and 0.55. At the species-level the median CV value is 0.35, 80% of CV values fall in the range of 0.22 to 0.50 and 95% of the CV values fall in the range of 0.17 and 0.56.](ms_figs/cv_meansize_rmfished.png)</span></span>
<span id="cb17-930"><a href="#cb17-930" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-931"><a href="#cb17-931" aria-hidden="true" tabindex="-1"></a><span class="fu">## ED Fig. 5</span></span>
<span id="cb17-932"><a href="#cb17-932" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-933"><a href="#cb17-933" aria-hidden="true" tabindex="-1"></a><span class="in">```{r ed-fig5}</span></span>
<span id="cb17-934"><a href="#cb17-934" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-935"><a href="#cb17-935" aria-hidden="true" tabindex="-1"></a>bimod_plot <span class="ot">&lt;-</span> <span class="cf">function</span>(data, nrow, fill_col){</span>
<span id="cb17-936"><a href="#cb17-936" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(data) <span class="sc">+</span></span>
<span id="cb17-937"><a href="#cb17-937" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_rect</span>(<span class="fu">aes</span>(</span>
<span id="cb17-938"><a href="#cb17-938" aria-hidden="true" tabindex="-1"></a>      <span class="at">xmin =</span> size_min,</span>
<span id="cb17-939"><a href="#cb17-939" aria-hidden="true" tabindex="-1"></a>      <span class="at">xmax =</span> size_max,</span>
<span id="cb17-940"><a href="#cb17-940" aria-hidden="true" tabindex="-1"></a>      <span class="at">ymax =</span> n, </span>
<span id="cb17-941"><a href="#cb17-941" aria-hidden="true" tabindex="-1"></a>      <span class="at">ymin =</span> <span class="dv">0</span></span>
<span id="cb17-942"><a href="#cb17-942" aria-hidden="true" tabindex="-1"></a>    ), <span class="at">fill =</span> fill_col, </span>
<span id="cb17-943"><a href="#cb17-943" aria-hidden="true" tabindex="-1"></a>    <span class="at">col =</span> <span class="st">"black"</span>) <span class="sc">+</span></span>
<span id="cb17-944"><a href="#cb17-944" aria-hidden="true" tabindex="-1"></a>    <span class="fu">facet_wrap</span>(<span class="sc">~</span>pop_label, </span>
<span id="cb17-945"><a href="#cb17-945" aria-hidden="true" tabindex="-1"></a>               <span class="at">nrow =</span> nrow,</span>
<span id="cb17-946"><a href="#cb17-946" aria-hidden="true" tabindex="-1"></a>               <span class="at">scales =</span> <span class="st">"free_y"</span>) <span class="sc">+</span> </span>
<span id="cb17-947"><a href="#cb17-947" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_x_continuous</span>(<span class="at">labels =</span> <span class="fu">label_number</span>(<span class="at">suffix =</span> <span class="st">"cm"</span>)) <span class="sc">+</span></span>
<span id="cb17-948"><a href="#cb17-948" aria-hidden="true" tabindex="-1"></a>    <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"Body length class"</span>, </span>
<span id="cb17-949"><a href="#cb17-949" aria-hidden="true" tabindex="-1"></a>         <span class="at">y =</span> <span class="st">"Count"</span>) <span class="sc">+</span></span>
<span id="cb17-950"><a href="#cb17-950" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme_cowplot</span>() <span class="sc">+</span></span>
<span id="cb17-951"><a href="#cb17-951" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme</span>(<span class="at">strip.background =</span> <span class="fu">element_rect</span>(<span class="at">fill =</span> <span class="st">"white"</span>, <span class="at">colour =</span> <span class="st">"black"</span>), </span>
<span id="cb17-952"><a href="#cb17-952" aria-hidden="true" tabindex="-1"></a>          <span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">hjust =</span> <span class="fl">0.5</span>)) </span>
<span id="cb17-953"><a href="#cb17-953" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb17-954"><a href="#cb17-954" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-955"><a href="#cb17-955" aria-hidden="true" tabindex="-1"></a>p1 <span class="ot">&lt;-</span> </span>
<span id="cb17-956"><a href="#cb17-956" aria-hidden="true" tabindex="-1"></a>  ED_fig5_data <span class="sc">%&gt;%</span> </span>
<span id="cb17-957"><a href="#cb17-957" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(data <span class="sc">==</span> <span class="st">"rls"</span>, <span class="sc">!</span>is_bimodal) <span class="sc">%&gt;%</span> </span>
<span id="cb17-958"><a href="#cb17-958" aria-hidden="true" tabindex="-1"></a>  <span class="fu">bimod_plot</span>(<span class="at">nrow =</span> <span class="dv">4</span>, </span>
<span id="cb17-959"><a href="#cb17-959" aria-hidden="true" tabindex="-1"></a>             <span class="at">fill_col =</span> <span class="st">"#56B4E9"</span>) <span class="sc">+</span> </span>
<span id="cb17-960"><a href="#cb17-960" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">"Unimodal examples (n = 4 of 3,169)"</span>)</span>
<span id="cb17-961"><a href="#cb17-961" aria-hidden="true" tabindex="-1"></a>p2 <span class="ot">&lt;-</span> </span>
<span id="cb17-962"><a href="#cb17-962" aria-hidden="true" tabindex="-1"></a>  ED_fig5_data <span class="sc">%&gt;%</span> </span>
<span id="cb17-963"><a href="#cb17-963" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(data <span class="sc">==</span> <span class="st">"rls"</span>, is_bimodal) <span class="sc">%&gt;%</span> </span>
<span id="cb17-964"><a href="#cb17-964" aria-hidden="true" tabindex="-1"></a>  <span class="fu">bimod_plot</span>(<span class="at">nrow =</span> <span class="dv">4</span>, </span>
<span id="cb17-965"><a href="#cb17-965" aria-hidden="true" tabindex="-1"></a>             <span class="at">fill_col =</span> <span class="st">"#56B4E9"</span>)  <span class="sc">+</span> </span>
<span id="cb17-966"><a href="#cb17-966" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">"Bimodal examples (n = 4 of 59)"</span>)</span>
<span id="cb17-967"><a href="#cb17-967" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-968"><a href="#cb17-968" aria-hidden="true" tabindex="-1"></a>p3 <span class="ot">&lt;-</span> </span>
<span id="cb17-969"><a href="#cb17-969" aria-hidden="true" tabindex="-1"></a>  ED_fig5_data <span class="sc">%&gt;%</span> </span>
<span id="cb17-970"><a href="#cb17-970" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(data <span class="sc">==</span> <span class="st">"cbf"</span>, <span class="sc">!</span>is_bimodal) <span class="sc">%&gt;%</span> </span>
<span id="cb17-971"><a href="#cb17-971" aria-hidden="true" tabindex="-1"></a>  <span class="fu">bimod_plot</span>(<span class="at">nrow =</span> <span class="dv">3</span>, </span>
<span id="cb17-972"><a href="#cb17-972" aria-hidden="true" tabindex="-1"></a>             <span class="at">fill_col =</span> <span class="st">"#E69F00"</span>) <span class="sc">+</span></span>
<span id="cb17-973"><a href="#cb17-973" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">"Unimodal examples (n = 3 of 133)"</span>)</span>
<span id="cb17-974"><a href="#cb17-974" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-975"><a href="#cb17-975" aria-hidden="true" tabindex="-1"></a>p4 <span class="ot">&lt;-</span>   ED_fig5_data <span class="sc">%&gt;%</span> </span>
<span id="cb17-976"><a href="#cb17-976" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(data <span class="sc">==</span> <span class="st">"cbf"</span>, is_bimodal) <span class="sc">%&gt;%</span> </span>
<span id="cb17-977"><a href="#cb17-977" aria-hidden="true" tabindex="-1"></a>  <span class="fu">bimod_plot</span>(<span class="at">nrow =</span> <span class="dv">3</span>, </span>
<span id="cb17-978"><a href="#cb17-978" aria-hidden="true" tabindex="-1"></a>             <span class="at">fill_col =</span> <span class="st">"#E69F00"</span>)  <span class="sc">+</span></span>
<span id="cb17-979"><a href="#cb17-979" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">"Bimodal distributions (n = 3 of 3)"</span>)</span>
<span id="cb17-980"><a href="#cb17-980" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-981"><a href="#cb17-981" aria-hidden="true" tabindex="-1"></a>bimod_dists <span class="ot">&lt;-</span> </span>
<span id="cb17-982"><a href="#cb17-982" aria-hidden="true" tabindex="-1"></a>  p1 <span class="sc">+</span></span>
<span id="cb17-983"><a href="#cb17-983" aria-hidden="true" tabindex="-1"></a>  p2 <span class="sc">+</span> </span>
<span id="cb17-984"><a href="#cb17-984" aria-hidden="true" tabindex="-1"></a>  p3 <span class="sc">+</span> </span>
<span id="cb17-985"><a href="#cb17-985" aria-hidden="true" tabindex="-1"></a>  p4 <span class="sc">+</span> </span>
<span id="cb17-986"><a href="#cb17-986" aria-hidden="true" tabindex="-1"></a>  <span class="fu">plot_layout</span>(<span class="at">ncol=</span> <span class="dv">2</span>) <span class="sc">+</span></span>
<span id="cb17-987"><a href="#cb17-987" aria-hidden="true" tabindex="-1"></a>  <span class="fu">plot_annotation</span>(<span class="at">tag_levels =</span> <span class="st">"A"</span>)</span>
<span id="cb17-988"><a href="#cb17-988" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-989"><a href="#cb17-989" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-990"><a href="#cb17-990" aria-hidden="true" tabindex="-1"></a><span class="fu">ggsave</span>(<span class="at">filename =</span> <span class="st">"ms_figs/bimodal.png"</span>, </span>
<span id="cb17-991"><a href="#cb17-991" aria-hidden="true" tabindex="-1"></a>       <span class="at">plot =</span> bimod_dists, </span>
<span id="cb17-992"><a href="#cb17-992" aria-hidden="true" tabindex="-1"></a>       <span class="at">height =</span> <span class="dv">20</span>, </span>
<span id="cb17-993"><a href="#cb17-993" aria-hidden="true" tabindex="-1"></a>       <span class="at">width =</span> <span class="dv">15</span>)</span>
<span id="cb17-994"><a href="#cb17-994" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb17-995"><a href="#cb17-995" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-996"><a href="#cb17-996" aria-hidden="true" tabindex="-1"></a><span class="al">![Randomly selected examples of approximately unimodal (A, C) and bimodal (B, D) observed body length distributions in visual census sampling (blue, A, B) and cryptobenthic sampling (orange, C, D). Approximately bimodal shapes were found in 59 out of 3,089 (2%) of visual census, and 3 of 136 (2%) cryptobenthic population-level datasets. Bimodal distributions were removed from distribution-fitting analyses.](ms_figs/bimodal.png)</span></span>
<span id="cb17-997"><a href="#cb17-997" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-998"><a href="#cb17-998" aria-hidden="true" tabindex="-1"></a><span class="fu">## ED Fig. 6</span></span>
<span id="cb17-999"><a href="#cb17-999" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-1000"><a href="#cb17-1000" aria-hidden="true" tabindex="-1"></a><span class="in">```{r ed-fig6}</span></span>
<span id="cb17-1001"><a href="#cb17-1001" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-1002"><a href="#cb17-1002" aria-hidden="true" tabindex="-1"></a>ED_fig6 <span class="ot">&lt;-</span> </span>
<span id="cb17-1003"><a href="#cb17-1003" aria-hidden="true" tabindex="-1"></a>  fig2_data_spp <span class="sc">%&gt;%</span> </span>
<span id="cb17-1004"><a href="#cb17-1004" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span>bimodal) <span class="sc">%&gt;%</span> </span>
<span id="cb17-1005"><a href="#cb17-1005" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>() <span class="sc">+</span> </span>
<span id="cb17-1006"><a href="#cb17-1006" aria-hidden="true" tabindex="-1"></a>  <span class="fu">aes</span>(</span>
<span id="cb17-1007"><a href="#cb17-1007" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> mean_size, </span>
<span id="cb17-1008"><a href="#cb17-1008" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span> cov_pref, </span>
<span id="cb17-1009"><a href="#cb17-1009" aria-hidden="true" tabindex="-1"></a>    <span class="at">pch =</span> dat,</span>
<span id="cb17-1010"><a href="#cb17-1010" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb17-1011"><a href="#cb17-1011" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">alpha =</span> <span class="dv">1</span>, <span class="at">size =</span> <span class="dv">2</span>, <span class="at">col =</span> <span class="st">"grey80"</span>) <span class="sc">+</span></span>
<span id="cb17-1012"><a href="#cb17-1012" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">alpha =</span> <span class="dv">1</span>, <span class="at">size =</span> <span class="dv">2</span>, <span class="at">col=</span><span class="st">"black"</span>,</span>
<span id="cb17-1013"><a href="#cb17-1013" aria-hidden="true" tabindex="-1"></a>             <span class="at">data =</span> fig2_data_spp <span class="sc">%&gt;%</span> </span>
<span id="cb17-1014"><a href="#cb17-1014" aria-hidden="true" tabindex="-1"></a>               <span class="fu">filter</span>(species <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">"Scorpis aequipinnis"</span>, </span>
<span id="cb17-1015"><a href="#cb17-1015" aria-hidden="true" tabindex="-1"></a>                                     <span class="st">"Cheilodactylus spectabilis"</span>))) <span class="sc">+</span></span>
<span id="cb17-1016"><a href="#cb17-1016" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">alpha =</span> <span class="fl">0.4</span>, <span class="at">size =</span> <span class="dv">2</span>, <span class="at">col=</span><span class="st">"red"</span>, </span>
<span id="cb17-1017"><a href="#cb17-1017" aria-hidden="true" tabindex="-1"></a>             <span class="at">data =</span> fig2_data_spp <span class="sc">%&gt;%</span> </span>
<span id="cb17-1018"><a href="#cb17-1018" aria-hidden="true" tabindex="-1"></a>               <span class="fu">filter</span>(<span class="fu">str_detect</span>(species, <span class="st">"Eviota"</span>))) <span class="sc">+</span></span>
<span id="cb17-1019"><a href="#cb17-1019" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">alpha =</span> <span class="dv">1</span>, <span class="at">size =</span> <span class="dv">2</span>, <span class="at">col=</span><span class="st">"red"</span>,</span>
<span id="cb17-1020"><a href="#cb17-1020" aria-hidden="true" tabindex="-1"></a>             <span class="at">data =</span> fig2_data_spp <span class="sc">%&gt;%</span> </span>
<span id="cb17-1021"><a href="#cb17-1021" aria-hidden="true" tabindex="-1"></a>               <span class="fu">filter</span>(<span class="fu">str_detect</span>(species, <span class="st">"Eviota queenslandica"</span>))) <span class="sc">+</span></span>
<span id="cb17-1022"><a href="#cb17-1022" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">trans =</span> <span class="st">"log10"</span>, </span>
<span id="cb17-1023"><a href="#cb17-1023" aria-hidden="true" tabindex="-1"></a>                     <span class="at">labels =</span> <span class="fu">label_number</span>(<span class="at">suffix=</span><span class="st">"cm"</span>)) <span class="sc">+</span></span>
<span id="cb17-1024"><a href="#cb17-1024" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_shape_manual</span>(</span>
<span id="cb17-1025"><a href="#cb17-1025" aria-hidden="true" tabindex="-1"></a>    <span class="at">values =</span> <span class="fu">c</span>(<span class="st">"rls"</span> <span class="ot">=</span> <span class="dv">21</span>, <span class="st">"cbf"</span> <span class="ot">=</span> <span class="dv">24</span>), </span>
<span id="cb17-1026"><a href="#cb17-1026" aria-hidden="true" tabindex="-1"></a>    <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"rls"</span> <span class="ot">=</span> <span class="st">"Visual census"</span>,</span>
<span id="cb17-1027"><a href="#cb17-1027" aria-hidden="true" tabindex="-1"></a>               <span class="st">"cbf"</span> <span class="ot">=</span> <span class="st">"Cryptobenthic (exhaustive)"</span>)) <span class="sc">+</span></span>
<span id="cb17-1028"><a href="#cb17-1028" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(</span>
<span id="cb17-1029"><a href="#cb17-1029" aria-hidden="true" tabindex="-1"></a>    <span class="at">values =</span> <span class="fu">c</span>(<span class="st">"normal"</span> <span class="ot">=</span> <span class="fu">rgb</span>(<span class="dv">181</span>, <span class="dv">144</span>, <span class="dv">19</span>, <span class="at">maxColorValue=</span><span class="dv">255</span>),</span>
<span id="cb17-1030"><a href="#cb17-1030" aria-hidden="true" tabindex="-1"></a>               <span class="st">"lognormal"</span> <span class="ot">=</span> <span class="fu">rgb</span>(<span class="dv">29</span>, <span class="dv">84</span>, <span class="dv">128</span>, <span class="at">maxColorValue=</span><span class="dv">255</span>)),</span>
<span id="cb17-1031"><a href="#cb17-1031" aria-hidden="true" tabindex="-1"></a>    <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"normal"</span> <span class="ot">=</span> <span class="st">"Normal preferred"</span>,</span>
<span id="cb17-1032"><a href="#cb17-1032" aria-hidden="true" tabindex="-1"></a>               <span class="st">"lognormal"</span> <span class="ot">=</span> <span class="st">"Lognormal preferred"</span>)) <span class="sc">+</span></span>
<span id="cb17-1033"><a href="#cb17-1033" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"Mean body size (log)"</span>, </span>
<span id="cb17-1034"><a href="#cb17-1034" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">"Coefficient of variation in body size"</span>) <span class="sc">+</span></span>
<span id="cb17-1035"><a href="#cb17-1035" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb17-1036"><a href="#cb17-1036" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_cowplot</span>(<span class="dv">20</span>) <span class="sc">+</span></span>
<span id="cb17-1037"><a href="#cb17-1037" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"none"</span>) </span>
<span id="cb17-1038"><a href="#cb17-1038" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-1039"><a href="#cb17-1039" aria-hidden="true" tabindex="-1"></a><span class="fu">ggsave</span>(<span class="at">filename =</span> <span class="st">"ms_figs/cv_meansize_spphighlight.png"</span>,</span>
<span id="cb17-1040"><a href="#cb17-1040" aria-hidden="true" tabindex="-1"></a>       <span class="at">plot =</span> ED_fig6,</span>
<span id="cb17-1041"><a href="#cb17-1041" aria-hidden="true" tabindex="-1"></a>       <span class="at">height =</span> <span class="dv">20</span>,</span>
<span id="cb17-1042"><a href="#cb17-1042" aria-hidden="true" tabindex="-1"></a>       <span class="at">width =</span> <span class="dv">20</span><span class="sc">*</span><span class="fl">1.618</span>,</span>
<span id="cb17-1043"><a href="#cb17-1043" aria-hidden="true" tabindex="-1"></a>       <span class="at">units =</span> <span class="st">"cm"</span>)</span>
<span id="cb17-1044"><a href="#cb17-1044" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-1045"><a href="#cb17-1045" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb17-1046"><a href="#cb17-1046" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-1047"><a href="#cb17-1047" aria-hidden="true" tabindex="-1"></a><span class="al">![Relationship between mean body length and coefficient of variation (CV), highlighting three species with known extreme life-histories. The two species in black text are known to be long-lived, slow growing species (*Scorpis aequipinus* and *Chirodactylus spectabilis*), yet their CV values fall in the center of the of the distribution of CV values. On the other hand, *Eviota* spp. and in particular, *E. queenslandica*, are known to be fast-growing and short-lived. *Eviota* spp. are on the lower end of the range of CV estimates.](ms_figs/cv_meansize_spphighlight.png)</span></span>
<span id="cb17-1048"><a href="#cb17-1048" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-1049"><a href="#cb17-1049" aria-hidden="true" tabindex="-1"></a><span class="fu">## ED Fig. 7</span></span>
<span id="cb17-1050"><a href="#cb17-1050" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-1051"><a href="#cb17-1051" aria-hidden="true" tabindex="-1"></a><span class="in">```{r ed-fig7}</span></span>
<span id="cb17-1052"><a href="#cb17-1052" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-1053"><a href="#cb17-1053" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-1054"><a href="#cb17-1054" aria-hidden="true" tabindex="-1"></a>ED_fig7_eq <span class="ot">&lt;-</span> <span class="fu">lm</span>(<span class="fu">log</span>(mean_size) <span class="sc">~</span> <span class="fu">log</span>(std_linf), <span class="at">data =</span> ED_fig7_data)</span>
<span id="cb17-1055"><a href="#cb17-1055" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-1056"><a href="#cb17-1056" aria-hidden="true" tabindex="-1"></a>ED_fig7 <span class="ot">&lt;-</span></span>
<span id="cb17-1057"><a href="#cb17-1057" aria-hidden="true" tabindex="-1"></a>  ED_fig7_data <span class="sc">%&gt;%</span> </span>
<span id="cb17-1058"><a href="#cb17-1058" aria-hidden="true" tabindex="-1"></a>  <span class="fu">add_predictions</span>(ED_fig7_eq) <span class="sc">%&gt;%</span> </span>
<span id="cb17-1059"><a href="#cb17-1059" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> std_linf, </span>
<span id="cb17-1060"><a href="#cb17-1060" aria-hidden="true" tabindex="-1"></a>             <span class="at">y =</span> mean_size)) <span class="sc">+</span></span>
<span id="cb17-1061"><a href="#cb17-1061" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb17-1062"><a href="#cb17-1062" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">y =</span> <span class="fu">exp</span>(pred)), <span class="at">col =</span> <span class="st">"red"</span>) <span class="sc">+</span></span>
<span id="cb17-1063"><a href="#cb17-1063" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_cowplot</span>() <span class="sc">+</span></span>
<span id="cb17-1064"><a href="#cb17-1064" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">label =</span> <span class="fu">label_number</span>(<span class="at">suffix =</span> <span class="st">"cm"</span>)) <span class="sc">+</span></span>
<span id="cb17-1065"><a href="#cb17-1065" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">label =</span> <span class="fu">label_number</span>(<span class="at">suffix =</span> <span class="st">"cm"</span>)) <span class="sc">+</span></span>
<span id="cb17-1066"><a href="#cb17-1066" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"Asymptotic length (literature)"</span>, </span>
<span id="cb17-1067"><a href="#cb17-1067" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">"Mean length (observed)"</span>)</span>
<span id="cb17-1068"><a href="#cb17-1068" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-1069"><a href="#cb17-1069" aria-hidden="true" tabindex="-1"></a><span class="fu">ggsave</span>(<span class="at">filename =</span> <span class="st">"ms_figs/linf_lmu.png"</span>,</span>
<span id="cb17-1070"><a href="#cb17-1070" aria-hidden="true" tabindex="-1"></a>       <span class="at">plot =</span> ED_fig7,</span>
<span id="cb17-1071"><a href="#cb17-1071" aria-hidden="true" tabindex="-1"></a>       <span class="at">height =</span> <span class="dv">10</span>,</span>
<span id="cb17-1072"><a href="#cb17-1072" aria-hidden="true" tabindex="-1"></a>       <span class="at">width =</span> <span class="dv">10</span><span class="sc">*</span><span class="fl">1.618</span>,</span>
<span id="cb17-1073"><a href="#cb17-1073" aria-hidden="true" tabindex="-1"></a>       <span class="at">units =</span> <span class="st">"cm"</span>)</span>
<span id="cb17-1074"><a href="#cb17-1074" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-1075"><a href="#cb17-1075" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb17-1076"><a href="#cb17-1076" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-1077"><a href="#cb17-1077" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-1078"><a href="#cb17-1078" aria-hidden="true" tabindex="-1"></a><span class="al">![A fitted linear model to predict mean population body length (from empirical body length distributions) from asymptotic body length (available from Prince et al.17). This fitted model was used to reconstruct the body length distribution when only asymptotic body length is known, which is often the case for many species or populations. Fitted model (red line): log(mean_length) = 0.37 + 0.78*log(asymptotic_length).](ms_figs/linf_lmu.png)</span></span>
<span id="cb17-1079"><a href="#cb17-1079" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-1080"><a href="#cb17-1080" aria-hidden="true" tabindex="-1"></a><span class="fu">## ED Fig. 8</span></span>
<span id="cb17-1081"><a href="#cb17-1081" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-1082"><a href="#cb17-1082" aria-hidden="true" tabindex="-1"></a><span class="in">```{r ed-fig8}</span></span>
<span id="cb17-1083"><a href="#cb17-1083" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-1084"><a href="#cb17-1084" aria-hidden="true" tabindex="-1"></a>difference_plots_all_40cm <span class="ot">&lt;-</span></span>
<span id="cb17-1085"><a href="#cb17-1085" aria-hidden="true" tabindex="-1"></a>  ED_fig8_data <span class="sc">%&gt;%</span> </span>
<span id="cb17-1086"><a href="#cb17-1086" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">obs_minus_exp =</span> p_obs<span class="sc">-</span>p_lbspr) <span class="sc">%&gt;%</span> </span>
<span id="cb17-1087"><a href="#cb17-1087" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> size_class, </span>
<span id="cb17-1088"><a href="#cb17-1088" aria-hidden="true" tabindex="-1"></a>             <span class="at">y =</span> obs_minus_exp)) <span class="sc">+</span></span>
<span id="cb17-1089"><a href="#cb17-1089" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> <span class="dv">0</span>, <span class="at">col =</span> <span class="st">"red"</span>) <span class="sc">+</span></span>
<span id="cb17-1090"><a href="#cb17-1090" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_path</span>(<span class="at">alpha =</span> <span class="fl">0.1</span>, <span class="fu">aes</span>(<span class="at">group =</span> species)) <span class="sc">+</span> </span>
<span id="cb17-1091"><a href="#cb17-1091" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">alpha =</span> <span class="fl">0.1</span>) <span class="sc">+</span></span>
<span id="cb17-1092"><a href="#cb17-1092" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_smooth</span>() <span class="sc">+</span></span>
<span id="cb17-1093"><a href="#cb17-1093" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">breaks =</span> <span class="fu">c</span>(fig4_data<span class="sc">$</span>size_class), </span>
<span id="cb17-1094"><a href="#cb17-1094" aria-hidden="true" tabindex="-1"></a>                     <span class="at">limits =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">40</span>)) <span class="sc">+</span></span>
<span id="cb17-1095"><a href="#cb17-1095" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">label =</span> <span class="fu">label_number</span>())<span class="sc">+</span></span>
<span id="cb17-1096"><a href="#cb17-1096" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"Visual census length classes (cm)"</span>, </span>
<span id="cb17-1097"><a href="#cb17-1097" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">"Observed minus LBSPR"</span>) <span class="sc">+</span></span>
<span id="cb17-1098"><a href="#cb17-1098" aria-hidden="true" tabindex="-1"></a>  <span class="fu">annotate</span>(<span class="at">geom =</span> <span class="st">"text"</span>, <span class="at">x =</span> <span class="cn">Inf</span>, </span>
<span id="cb17-1099"><a href="#cb17-1099" aria-hidden="true" tabindex="-1"></a>           <span class="at">y =</span> <span class="sc">-</span><span class="cn">Inf</span>, </span>
<span id="cb17-1100"><a href="#cb17-1100" aria-hidden="true" tabindex="-1"></a>           <span class="at">label =</span> <span class="st">"Observed &lt; LBSPR"</span>, </span>
<span id="cb17-1101"><a href="#cb17-1101" aria-hidden="true" tabindex="-1"></a>           <span class="at">hjust =</span> <span class="fl">1.1</span>, </span>
<span id="cb17-1102"><a href="#cb17-1102" aria-hidden="true" tabindex="-1"></a>           <span class="at">vjust =</span> <span class="sc">-</span><span class="fl">0.5</span>, </span>
<span id="cb17-1103"><a href="#cb17-1103" aria-hidden="true" tabindex="-1"></a>           <span class="at">size =</span> <span class="dv">8</span>) <span class="sc">+</span></span>
<span id="cb17-1104"><a href="#cb17-1104" aria-hidden="true" tabindex="-1"></a>  <span class="fu">annotate</span>(<span class="at">geom =</span> <span class="st">"text"</span>, </span>
<span id="cb17-1105"><a href="#cb17-1105" aria-hidden="true" tabindex="-1"></a>           <span class="at">x =</span> <span class="cn">Inf</span>, </span>
<span id="cb17-1106"><a href="#cb17-1106" aria-hidden="true" tabindex="-1"></a>           <span class="at">y =</span> <span class="cn">Inf</span>, </span>
<span id="cb17-1107"><a href="#cb17-1107" aria-hidden="true" tabindex="-1"></a>           <span class="at">label =</span> <span class="st">"Observed &gt; LBSPR"</span>, </span>
<span id="cb17-1108"><a href="#cb17-1108" aria-hidden="true" tabindex="-1"></a>           <span class="at">hjust =</span> <span class="fl">1.1</span>, </span>
<span id="cb17-1109"><a href="#cb17-1109" aria-hidden="true" tabindex="-1"></a>           <span class="at">vjust =</span> <span class="fl">1.5</span>, </span>
<span id="cb17-1110"><a href="#cb17-1110" aria-hidden="true" tabindex="-1"></a>           <span class="at">size =</span> <span class="dv">8</span>) <span class="sc">+</span></span>
<span id="cb17-1111"><a href="#cb17-1111" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_cowplot</span>()</span>
<span id="cb17-1112"><a href="#cb17-1112" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-1113"><a href="#cb17-1113" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-1114"><a href="#cb17-1114" aria-hidden="true" tabindex="-1"></a><span class="fu">ggsave</span>(<span class="at">filename =</span> <span class="st">"ms_figs/obs_minus_lbspr.png"</span>,</span>
<span id="cb17-1115"><a href="#cb17-1115" aria-hidden="true" tabindex="-1"></a>       <span class="at">plot =</span> difference_plots_all_40cm,</span>
<span id="cb17-1116"><a href="#cb17-1116" aria-hidden="true" tabindex="-1"></a>       <span class="at">height =</span> <span class="dv">15</span>,</span>
<span id="cb17-1117"><a href="#cb17-1117" aria-hidden="true" tabindex="-1"></a>       <span class="at">width =</span> <span class="dv">15</span><span class="sc">*</span><span class="fl">1.618</span>,</span>
<span id="cb17-1118"><a href="#cb17-1118" aria-hidden="true" tabindex="-1"></a>       <span class="at">units =</span> <span class="st">"cm"</span>)</span>
<span id="cb17-1119"><a href="#cb17-1119" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-1120"><a href="#cb17-1120" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb17-1121"><a href="#cb17-1121" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-1122"><a href="#cb17-1122" aria-hidden="true" tabindex="-1"></a><span class="al">![Observed proportion within a length bin minus expected proportion as predicted by the theoretical model LBSPR. LBSPR is parameterized by asymptotic length, mortality (M) and growth rate (k). Points below the red horizontal line indicate there is a lower observed proportion of individuals in the size bin than predicted by LBSPR. The x-axis has been truncated to 40cm to emphasize this region where observational sampling bias is most likely to occur.](ms_figs/obs_minus_lbspr.png)</span></span>
<span id="cb17-1123"><a href="#cb17-1123" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-1124"><a href="#cb17-1124" aria-hidden="true" tabindex="-1"></a><span class="fu">## ED Fig. 9</span></span>
<span id="cb17-1125"><a href="#cb17-1125" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-1126"><a href="#cb17-1126" aria-hidden="true" tabindex="-1"></a><span class="in">```{r ed-fig9}</span></span>
<span id="cb17-1127"><a href="#cb17-1127" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-1128"><a href="#cb17-1128" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-1129"><a href="#cb17-1129" aria-hidden="true" tabindex="-1"></a>ED_fig9 <span class="ot">&lt;-</span></span>
<span id="cb17-1130"><a href="#cb17-1130" aria-hidden="true" tabindex="-1"></a>  ED_fig9_data <span class="sc">%&gt;%</span> </span>
<span id="cb17-1131"><a href="#cb17-1131" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> <span class="fu">as.factor</span>(mincount), <span class="at">y =</span> cv_50, <span class="at">col =</span> mod)) <span class="sc">+</span></span>
<span id="cb17-1132"><a href="#cb17-1132" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_violin</span>() <span class="sc">+</span></span>
<span id="cb17-1133"><a href="#cb17-1133" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(datatype<span class="sc">~</span>., <span class="at">scales =</span> <span class="st">"free_x"</span>) <span class="sc">+</span></span>
<span id="cb17-1134"><a href="#cb17-1134" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">limits =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">1</span>))<span class="sc">+</span></span>
<span id="cb17-1135"><a href="#cb17-1135" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text</span>(<span class="fu">aes</span>(<span class="at">label =</span> <span class="fu">paste</span>(<span class="st">"n ="</span>, max_n)), <span class="at">y =</span> <span class="fl">0.0</span>, <span class="at">show.legend =</span> <span class="cn">FALSE</span>, <span class="at">col =</span> <span class="st">"black"</span>, </span>
<span id="cb17-1136"><a href="#cb17-1136" aria-hidden="true" tabindex="-1"></a>            <span class="at">data =</span> </span>
<span id="cb17-1137"><a href="#cb17-1137" aria-hidden="true" tabindex="-1"></a>              ED_fig9_data <span class="sc">%&gt;%</span> </span>
<span id="cb17-1138"><a href="#cb17-1138" aria-hidden="true" tabindex="-1"></a>              <span class="fu">count</span>(datatype, mod, mincount) <span class="sc">%&gt;%</span> </span>
<span id="cb17-1139"><a href="#cb17-1139" aria-hidden="true" tabindex="-1"></a>              <span class="fu">summarise</span>(<span class="at">max_n =</span> <span class="fu">max</span>(n), </span>
<span id="cb17-1140"><a href="#cb17-1140" aria-hidden="true" tabindex="-1"></a>                        <span class="at">.by =</span> <span class="fu">c</span>(datatype, mincount))) <span class="sc">+</span></span>
<span id="cb17-1141"><a href="#cb17-1141" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">"normal"</span> <span class="ot">=</span> <span class="fu">rgb</span>(<span class="dv">181</span>, <span class="dv">144</span>, <span class="dv">19</span>, <span class="at">maxColorValue=</span><span class="dv">255</span>),</span>
<span id="cb17-1142"><a href="#cb17-1142" aria-hidden="true" tabindex="-1"></a>                                <span class="st">"lognormal"</span> <span class="ot">=</span> <span class="fu">rgb</span>(<span class="dv">29</span>, <span class="dv">84</span>, <span class="dv">128</span>, <span class="at">maxColorValue=</span><span class="dv">255</span>)), </span>
<span id="cb17-1143"><a href="#cb17-1143" aria-hidden="true" tabindex="-1"></a>                     <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"normal"</span> <span class="ot">=</span> <span class="st">"Normal"</span>,</span>
<span id="cb17-1144"><a href="#cb17-1144" aria-hidden="true" tabindex="-1"></a>                                <span class="st">"lognormal"</span> <span class="ot">=</span> <span class="st">"Lognormal"</span>)) <span class="sc">+</span></span>
<span id="cb17-1145"><a href="#cb17-1145" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"Minimum population size (# individuals)"</span>, </span>
<span id="cb17-1146"><a href="#cb17-1146" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">"Median CV estimate"</span>) <span class="sc">+</span></span>
<span id="cb17-1147"><a href="#cb17-1147" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_cowplot</span>(<span class="dv">20</span>) <span class="sc">+</span></span>
<span id="cb17-1148"><a href="#cb17-1148" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">1</span>), </span>
<span id="cb17-1149"><a href="#cb17-1149" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.justification =</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="fl">1.1</span>),</span>
<span id="cb17-1150"><a href="#cb17-1150" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.title =</span> <span class="fu">element_blank</span>(), </span>
<span id="cb17-1151"><a href="#cb17-1151" aria-hidden="true" tabindex="-1"></a>        <span class="at">plot.margin =</span> <span class="fu">margin</span>(<span class="dv">10</span>, <span class="dv">50</span>, <span class="dv">10</span>, <span class="dv">10</span>), </span>
<span id="cb17-1152"><a href="#cb17-1152" aria-hidden="true" tabindex="-1"></a>        <span class="at">strip.background =</span> <span class="fu">element_rect</span>(<span class="at">fill =</span> <span class="st">"white"</span>, <span class="at">colour =</span> <span class="st">"black"</span>))</span>
<span id="cb17-1153"><a href="#cb17-1153" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-1154"><a href="#cb17-1154" aria-hidden="true" tabindex="-1"></a><span class="fu">ggsave</span>(<span class="at">filename =</span> <span class="st">"ms_figs/mincount_sensitivity.png"</span>,</span>
<span id="cb17-1155"><a href="#cb17-1155" aria-hidden="true" tabindex="-1"></a>       <span class="at">plot =</span> ED_fig9,</span>
<span id="cb17-1156"><a href="#cb17-1156" aria-hidden="true" tabindex="-1"></a>       <span class="at">height =</span> <span class="dv">15</span>,</span>
<span id="cb17-1157"><a href="#cb17-1157" aria-hidden="true" tabindex="-1"></a>       <span class="at">width =</span> <span class="dv">25</span>,</span>
<span id="cb17-1158"><a href="#cb17-1158" aria-hidden="true" tabindex="-1"></a>       <span class="at">units =</span> <span class="st">"cm"</span>)</span>
<span id="cb17-1159"><a href="#cb17-1159" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-1160"><a href="#cb17-1160" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-1161"><a href="#cb17-1161" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb17-1162"><a href="#cb17-1162" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-1163"><a href="#cb17-1163" aria-hidden="true" tabindex="-1"></a><span class="al">![Changing the minimum sample size (individuals within a population) required for distribution fitting has minimal influence of the median estimate of the coefficient of variation (CV). CV values greater than one have been excluded from this figure.](ms_figs/mincount_sensitivity.png)</span></span>
<span id="cb17-1164"><a href="#cb17-1164" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-1165"><a href="#cb17-1165" aria-hidden="true" tabindex="-1"></a><span class="fu">## ED Fig. 10</span></span>
<span id="cb17-1166"><a href="#cb17-1166" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-1167"><a href="#cb17-1167" aria-hidden="true" tabindex="-1"></a><span class="in">```{r ed-fig10}</span></span>
<span id="cb17-1168"><a href="#cb17-1168" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-1169"><a href="#cb17-1169" aria-hidden="true" tabindex="-1"></a>inc_bimodal <span class="ot">&lt;-</span> <span class="cn">TRUE</span></span>
<span id="cb17-1170"><a href="#cb17-1170" aria-hidden="true" tabindex="-1"></a>inc_fished <span class="ot">&lt;-</span> <span class="cn">TRUE</span></span>
<span id="cb17-1171"><a href="#cb17-1171" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-1172"><a href="#cb17-1172" aria-hidden="true" tabindex="-1"></a>pop_data <span class="ot">&lt;-</span> </span>
<span id="cb17-1173"><a href="#cb17-1173" aria-hidden="true" tabindex="-1"></a>  fig2_data_pop <span class="sc">%&gt;%</span></span>
<span id="cb17-1174"><a href="#cb17-1174" aria-hidden="true" tabindex="-1"></a>  {<span class="cf">if</span>(inc_fished) . <span class="cf">else</span> <span class="fu">filter</span>(., <span class="sc">!</span>fished)} <span class="sc">%&gt;%</span> </span>
<span id="cb17-1175"><a href="#cb17-1175" aria-hidden="true" tabindex="-1"></a>  {<span class="cf">if</span>(inc_bimodal) . <span class="cf">else</span> <span class="fu">filter</span>(., <span class="sc">!</span>bimodal)} </span>
<span id="cb17-1176"><a href="#cb17-1176" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-1177"><a href="#cb17-1177" aria-hidden="true" tabindex="-1"></a>spp_data <span class="ot">&lt;-</span> </span>
<span id="cb17-1178"><a href="#cb17-1178" aria-hidden="true" tabindex="-1"></a>  fig2_data_spp <span class="sc">%&gt;%</span> </span>
<span id="cb17-1179"><a href="#cb17-1179" aria-hidden="true" tabindex="-1"></a>  {<span class="cf">if</span>(inc_fished) . <span class="cf">else</span> <span class="fu">filter</span>(., <span class="sc">!</span>fished)} <span class="sc">%&gt;%</span> </span>
<span id="cb17-1180"><a href="#cb17-1180" aria-hidden="true" tabindex="-1"></a>  {<span class="cf">if</span>(inc_bimodal) . <span class="cf">else</span> <span class="fu">filter</span>(., <span class="sc">!</span>bimodal)}</span>
<span id="cb17-1181"><a href="#cb17-1181" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-1182"><a href="#cb17-1182" aria-hidden="true" tabindex="-1"></a>plot_ylim <span class="ot">&lt;-</span> </span>
<span id="cb17-1183"><a href="#cb17-1183" aria-hidden="true" tabindex="-1"></a>  <span class="fu">max</span>(<span class="fu">layer_scales</span>(</span>
<span id="cb17-1184"><a href="#cb17-1184" aria-hidden="true" tabindex="-1"></a>    <span class="fu">main_plot</span>(pop_data))<span class="sc">$</span>y<span class="sc">$</span>range<span class="sc">$</span>range,</span>
<span id="cb17-1185"><a href="#cb17-1185" aria-hidden="true" tabindex="-1"></a>    <span class="fu">layer_scales</span>(</span>
<span id="cb17-1186"><a href="#cb17-1186" aria-hidden="true" tabindex="-1"></a>      <span class="fu">main_plot</span>(spp_data))<span class="sc">$</span>y<span class="sc">$</span>range<span class="sc">$</span>range)</span>
<span id="cb17-1187"><a href="#cb17-1187" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-1188"><a href="#cb17-1188" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-1189"><a href="#cb17-1189" aria-hidden="true" tabindex="-1"></a>ED_fig10_main <span class="ot">&lt;-</span> </span>
<span id="cb17-1190"><a href="#cb17-1190" aria-hidden="true" tabindex="-1"></a>  <span class="fu">main_plot</span>(pop_data) <span class="sc">+</span> </span>
<span id="cb17-1191"><a href="#cb17-1191" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.title.x =</span> <span class="fu">element_blank</span>()) <span class="sc">+</span></span>
<span id="cb17-1192"><a href="#cb17-1192" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylim</span>(<span class="dv">0</span>, plot_ylim) <span class="sc">+</span></span>
<span id="cb17-1193"><a href="#cb17-1193" aria-hidden="true" tabindex="-1"></a>  <span class="fu">annotate</span>(<span class="st">"text"</span>,</span>
<span id="cb17-1194"><a href="#cb17-1194" aria-hidden="true" tabindex="-1"></a>           <span class="at">x =</span> <span class="dv">1</span>, </span>
<span id="cb17-1195"><a href="#cb17-1195" aria-hidden="true" tabindex="-1"></a>           <span class="at">hjust =</span> <span class="dv">0</span>, </span>
<span id="cb17-1196"><a href="#cb17-1196" aria-hidden="true" tabindex="-1"></a>           <span class="at">y =</span> plot_ylim<span class="sc">*</span><span class="fl">0.95</span>,</span>
<span id="cb17-1197"><a href="#cb17-1197" aria-hidden="true" tabindex="-1"></a>           <span class="at">label =</span> <span class="st">"Population-level"</span>,</span>
<span id="cb17-1198"><a href="#cb17-1198" aria-hidden="true" tabindex="-1"></a>           <span class="at">size =</span> <span class="dv">10</span>) <span class="sc">+</span></span>
<span id="cb17-1199"><a href="#cb17-1199" aria-hidden="true" tabindex="-1"></a>  <span class="fu">side_plot</span>(pop_data <span class="sc">%&gt;%</span> </span>
<span id="cb17-1200"><a href="#cb17-1200" aria-hidden="true" tabindex="-1"></a>              <span class="fu">filter</span>(col <span class="sc">!=</span> <span class="st">"cbf_lnorm"</span>), </span>
<span id="cb17-1201"><a href="#cb17-1201" aria-hidden="true" tabindex="-1"></a>            plot_ylim) <span class="sc">+</span> </span>
<span id="cb17-1202"><a href="#cb17-1202" aria-hidden="true" tabindex="-1"></a>  <span class="fu">main_plot</span>(spp_data) <span class="sc">+</span> <span class="fu">ylim</span>(<span class="dv">0</span>, plot_ylim) <span class="sc">+</span></span>
<span id="cb17-1203"><a href="#cb17-1203" aria-hidden="true" tabindex="-1"></a>  <span class="fu">annotate</span>(<span class="st">"text"</span>, </span>
<span id="cb17-1204"><a href="#cb17-1204" aria-hidden="true" tabindex="-1"></a>           <span class="at">x =</span> <span class="dv">1</span>, </span>
<span id="cb17-1205"><a href="#cb17-1205" aria-hidden="true" tabindex="-1"></a>           <span class="at">hjust =</span> <span class="dv">0</span>, </span>
<span id="cb17-1206"><a href="#cb17-1206" aria-hidden="true" tabindex="-1"></a>           <span class="at">y =</span> plot_ylim<span class="sc">*</span><span class="fl">0.95</span>,</span>
<span id="cb17-1207"><a href="#cb17-1207" aria-hidden="true" tabindex="-1"></a>           <span class="at">label =</span> <span class="st">"Species-level"</span>,</span>
<span id="cb17-1208"><a href="#cb17-1208" aria-hidden="true" tabindex="-1"></a>           <span class="at">size =</span> <span class="dv">10</span>) <span class="sc">+</span></span>
<span id="cb17-1209"><a href="#cb17-1209" aria-hidden="true" tabindex="-1"></a>  <span class="fu">side_plot</span>(spp_data <span class="sc">%&gt;%</span> <span class="fu">filter</span>(col <span class="sc">!=</span> <span class="st">"cbf_lnorm"</span>), </span>
<span id="cb17-1210"><a href="#cb17-1210" aria-hidden="true" tabindex="-1"></a>            plot_ylim)  <span class="sc">+</span></span>
<span id="cb17-1211"><a href="#cb17-1211" aria-hidden="true" tabindex="-1"></a>  <span class="fu">plot_layout</span>(<span class="at">design =</span> {<span class="st">"</span></span>
<span id="cb17-1212"><a href="#cb17-1212" aria-hidden="true" tabindex="-1"></a><span class="st">      AAAAAAB</span></span>
<span id="cb17-1213"><a href="#cb17-1213" aria-hidden="true" tabindex="-1"></a><span class="st">      AAAAAAB</span></span>
<span id="cb17-1214"><a href="#cb17-1214" aria-hidden="true" tabindex="-1"></a><span class="st">      CCCCCCD</span></span>
<span id="cb17-1215"><a href="#cb17-1215" aria-hidden="true" tabindex="-1"></a><span class="st">      CCCCCCD"</span></span>
<span id="cb17-1216"><a href="#cb17-1216" aria-hidden="true" tabindex="-1"></a>  })</span>
<span id="cb17-1217"><a href="#cb17-1217" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-1218"><a href="#cb17-1218" aria-hidden="true" tabindex="-1"></a>ED_fig10_legend <span class="ot">&lt;-</span></span>
<span id="cb17-1219"><a href="#cb17-1219" aria-hidden="true" tabindex="-1"></a>  ggpubr<span class="sc">::</span><span class="fu">as_ggplot</span>(</span>
<span id="cb17-1220"><a href="#cb17-1220" aria-hidden="true" tabindex="-1"></a>    ggpubr<span class="sc">::</span><span class="fu">get_legend</span>(</span>
<span id="cb17-1221"><a href="#cb17-1221" aria-hidden="true" tabindex="-1"></a>      <span class="fu">main_plot</span>(pop_data) <span class="sc">+</span></span>
<span id="cb17-1222"><a href="#cb17-1222" aria-hidden="true" tabindex="-1"></a>        <span class="fu">theme</span>(<span class="at">axis.title =</span> <span class="fu">element_text</span>(), </span>
<span id="cb17-1223"><a href="#cb17-1223" aria-hidden="true" tabindex="-1"></a>              <span class="at">axis.text =</span> <span class="fu">element_text</span>()) <span class="sc">+</span></span>
<span id="cb17-1224"><a href="#cb17-1224" aria-hidden="true" tabindex="-1"></a>        <span class="fu">guides</span>(<span class="at">colour =</span> <span class="fu">guide_legend</span>(<span class="at">override.aes =</span> <span class="fu">list</span>(<span class="at">size=</span><span class="dv">5</span>, <span class="at">stroke =</span> <span class="dv">2</span>),</span>
<span id="cb17-1225"><a href="#cb17-1225" aria-hidden="true" tabindex="-1"></a>                                     <span class="at">nrow =</span> <span class="dv">2</span>,</span>
<span id="cb17-1226"><a href="#cb17-1226" aria-hidden="true" tabindex="-1"></a>                                     <span class="at">byrow =</span> <span class="cn">TRUE</span>,</span>
<span id="cb17-1227"><a href="#cb17-1227" aria-hidden="true" tabindex="-1"></a>                                     <span class="at">title =</span> <span class="fu">element_blank</span>()), </span>
<span id="cb17-1228"><a href="#cb17-1228" aria-hidden="true" tabindex="-1"></a>               <span class="at">pch =</span> <span class="fu">guide_legend</span>(<span class="at">nrow =</span> <span class="dv">2</span>,</span>
<span id="cb17-1229"><a href="#cb17-1229" aria-hidden="true" tabindex="-1"></a>                                  <span class="at">byrow =</span> <span class="cn">TRUE</span>,</span>
<span id="cb17-1230"><a href="#cb17-1230" aria-hidden="true" tabindex="-1"></a>                                  <span class="at">title =</span> <span class="fu">element_blank</span>())) <span class="sc">+</span></span>
<span id="cb17-1231"><a href="#cb17-1231" aria-hidden="true" tabindex="-1"></a>        <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"bottom"</span>, </span>
<span id="cb17-1232"><a href="#cb17-1232" aria-hidden="true" tabindex="-1"></a>              <span class="at">legend.box =</span> <span class="st">"vertical"</span>,</span>
<span id="cb17-1233"><a href="#cb17-1233" aria-hidden="true" tabindex="-1"></a>              <span class="at">legend.justification =</span> <span class="fu">c</span>(<span class="fl">0.5</span>,<span class="fl">0.5</span>),</span>
<span id="cb17-1234"><a href="#cb17-1234" aria-hidden="true" tabindex="-1"></a>              <span class="at">legend.background =</span> <span class="fu">element_rect</span>(<span class="at">color =</span> <span class="st">"black"</span>),</span>
<span id="cb17-1235"><a href="#cb17-1235" aria-hidden="true" tabindex="-1"></a>              <span class="at">legend.margin=</span><span class="fu">margin</span>(<span class="dv">5</span>,<span class="dv">5</span>,<span class="dv">5</span>,<span class="dv">6</span>),</span>
<span id="cb17-1236"><a href="#cb17-1236" aria-hidden="true" tabindex="-1"></a>              <span class="at">legend.title =</span> <span class="fu">element_text</span>()), </span>
<span id="cb17-1237"><a href="#cb17-1237" aria-hidden="true" tabindex="-1"></a>      </span>
<span id="cb17-1238"><a href="#cb17-1238" aria-hidden="true" tabindex="-1"></a>    )) </span>
<span id="cb17-1239"><a href="#cb17-1239" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-1240"><a href="#cb17-1240" aria-hidden="true" tabindex="-1"></a>ED_fig10_yaxis <span class="ot">&lt;-</span> </span>
<span id="cb17-1241"><a href="#cb17-1241" aria-hidden="true" tabindex="-1"></a>  <span class="fu">wrap_elements</span>(ED_fig10_main) <span class="sc">+</span></span>
<span id="cb17-1242"><a href="#cb17-1242" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">tag =</span> <span class="st">"Coeffient of variation in body size"</span>) <span class="sc">+</span></span>
<span id="cb17-1243"><a href="#cb17-1243" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(</span>
<span id="cb17-1244"><a href="#cb17-1244" aria-hidden="true" tabindex="-1"></a>    <span class="at">plot.tag =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">20</span>, <span class="at">angle =</span> <span class="dv">90</span>),</span>
<span id="cb17-1245"><a href="#cb17-1245" aria-hidden="true" tabindex="-1"></a>    <span class="at">plot.tag.position =</span> <span class="st">"left"</span></span>
<span id="cb17-1246"><a href="#cb17-1246" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb17-1247"><a href="#cb17-1247" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-1248"><a href="#cb17-1248" aria-hidden="true" tabindex="-1"></a>ED_fig10 <span class="ot">&lt;-</span> </span>
<span id="cb17-1249"><a href="#cb17-1249" aria-hidden="true" tabindex="-1"></a>  ED_fig10_yaxis <span class="sc">+</span> </span>
<span id="cb17-1250"><a href="#cb17-1250" aria-hidden="true" tabindex="-1"></a>  ED_fig10_legend <span class="sc">+</span></span>
<span id="cb17-1251"><a href="#cb17-1251" aria-hidden="true" tabindex="-1"></a>  <span class="fu">plot_layout</span>(<span class="at">design =</span> {<span class="st">"</span></span>
<span id="cb17-1252"><a href="#cb17-1252" aria-hidden="true" tabindex="-1"></a><span class="st">      AAAAAAA</span></span>
<span id="cb17-1253"><a href="#cb17-1253" aria-hidden="true" tabindex="-1"></a><span class="st">      AAAAAAA</span></span>
<span id="cb17-1254"><a href="#cb17-1254" aria-hidden="true" tabindex="-1"></a><span class="st">      AAAAAAA</span></span>
<span id="cb17-1255"><a href="#cb17-1255" aria-hidden="true" tabindex="-1"></a><span class="st">      AAAAAAA</span></span>
<span id="cb17-1256"><a href="#cb17-1256" aria-hidden="true" tabindex="-1"></a><span class="st">            #BBBBB#"</span></span>
<span id="cb17-1257"><a href="#cb17-1257" aria-hidden="true" tabindex="-1"></a>  })</span>
<span id="cb17-1258"><a href="#cb17-1258" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-1259"><a href="#cb17-1259" aria-hidden="true" tabindex="-1"></a><span class="fu">ggsave</span>(<span class="at">filename =</span> <span class="st">"ms_figs/cv_meansize_incbimod.png"</span>,</span>
<span id="cb17-1260"><a href="#cb17-1260" aria-hidden="true" tabindex="-1"></a>       <span class="at">plot =</span> ED_fig10,</span>
<span id="cb17-1261"><a href="#cb17-1261" aria-hidden="true" tabindex="-1"></a>       <span class="at">height =</span> <span class="dv">20</span>,</span>
<span id="cb17-1262"><a href="#cb17-1262" aria-hidden="true" tabindex="-1"></a>       <span class="at">width =</span> <span class="dv">20</span><span class="sc">*</span><span class="fl">1.618</span>,</span>
<span id="cb17-1263"><a href="#cb17-1263" aria-hidden="true" tabindex="-1"></a>       <span class="at">units =</span> <span class="st">"cm"</span>, </span>
<span id="cb17-1264"><a href="#cb17-1264" aria-hidden="true" tabindex="-1"></a>       <span class="at">create.dir =</span> <span class="cn">TRUE</span>)</span>
<span id="cb17-1265"><a href="#cb17-1265" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-1266"><a href="#cb17-1266" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-1267"><a href="#cb17-1267" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb17-1268"><a href="#cb17-1268" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-1269"><a href="#cb17-1269" aria-hidden="true" tabindex="-1"></a><span class="al">![Distributions deemed to be bimodal (red crosses, 2% of total populations) were excluded in Fig. 2 in the main text. Including these distributions has minor influence on the estimate of CV. At the population level the median CV value is 0.34, 80% of CV values fall in the range of 0.22 to 0.51 and 95% of the CV values fall in the range of 0.19 and 0.56. At the species-level the median CV value is 0.36, 80% of CV values fall in the range of 0.22 to 0.51 and 95% of the CV values fall in the range of 0.17 and 0.57.](ms_figs/cv_meansize_incbimod.png)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div></div></div></div></div>
</div> <!-- /content -->




</body></html>